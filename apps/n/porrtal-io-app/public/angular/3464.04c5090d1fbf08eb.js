/*
Copyright 2022 Comcast Cable Communications Management, LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[3464],{14259:(re,H,p)=>{p.d(H,{q:()=>E});var S,Z,V={exports:{}};S=V,void 0!==(Z=function(){function D(s,n,o,f,x){for(;f>o;){if(f-o>600){var y=f-o+1,_=n-o+1,O=Math.log(y),h=.5*Math.exp(2*O/3),C=.5*Math.sqrt(O*h*(y-h)/y)*(_-y/2<0?-1:1);D(s,n,Math.max(o,Math.floor(n-_*h/y+C)),Math.min(f,Math.floor(n+(y-_)*h/y+C)),x)}var G=s[n],A=o,j=f;for(I(s,o,n),x(s[f],G)>0&&I(s,o,f);A<j;){for(I(s,A,j),A++,j--;x(s[A],G)<0;)A++;for(;x(s[j],G)>0;)j--}0===x(s[o],G)?I(s,o,j):I(s,++j,f),j<=n&&(o=j+1),n<=j&&(f=j-1)}}function I(s,n,o){var f=s[n];s[n]=s[o],s[o]=f}function P(s,n){return s<n?-1:s>n?1:0}return function F(s,n,o,f,x){D(s,n,o||0,f||s.length-1,x||P)}}())&&(S.exports=Z);const E=V.exports},77044:(re,H,p)=>{p.d(H,{Y:()=>Z});var S=p(62208);function z(s,n){return s?n?4:3:n?3:2}function Z(s,n,o,f,x){if((0,S.Wi)(n)||!n.lengths.length)return null;const y="upperLeft"===x?.originPosition?-1:1;s.lengths.length&&(s.lengths.length=0),s.coords.length&&(s.coords.length=0);const _=s.coords,O=[],h=o?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:C,coords:G}=n,A=z(o,f);let j=0;for(const T of C){const W=V(h,G,j,T,o,f,y);W&&O.push(W),j+=T*A}if(O.sort((T,W)=>{let L=y*T[2]-y*W[2];return 0===L&&o&&(L=T[4]-W[4]),L}),O.length){let T=6*O[0][2];_[0]=O[0][0]/T,_[1]=O[0][1]/T,o&&(T=6*O[0][4],_[2]=0!==T?O[0][3]/T:0),(_[0]<h[0]||_[0]>h[1]||_[1]<h[2]||_[1]>h[3]||o&&(_[2]<h[4]||_[2]>h[5]))&&(_.length=0)}if(!_.length){const T=n.lengths[0]?function E(s,n,o,f,x){const y=z(f,x);let _=n,O=n+y,h=0,C=0,G=0,A=0;for(let j=0,T=o-1;j<T;j++,_+=y,O+=y){const W=s[_],L=s[_+1],w=s[_+2],ee=s[O],u=s[O+1],c=s[O+2],g=f?D(W,L,w,ee,u,c):F(W,L,ee,u);if(g)if(h+=g,f){const v=P(W,L,w,ee,u,c);C+=g*v[0],G+=g*v[1],A+=g*v[2]}else{const v=I(W,L,ee,u);C+=g*v[0],G+=g*v[1]}}return h>0?f?[C/h,G/h,A/h]:[C/h,G/h]:o>0?f?[s[n],s[n+1],s[n+2]]:[s[n],s[n+1]]:null}(G,0,C[0],o,f):null;if(!T)return null;_[0]=T[0],_[1]=T[1],o&&T.length>2&&(_[2]=T[2])}return s}function V(s,n,o,f,x,y,_=1){const O=z(x,y);let h=o,C=o+O,G=0,A=0,j=0,T=0,W=0;for(let w=0,ee=f-1;w<ee;w++,h+=O,C+=O){const u=n[h],c=n[h+1],g=n[h+2],v=n[C],M=n[C+1],N=n[C+2];let Q=u*M-v*c;T+=Q,G+=(u+v)*Q,A+=(c+M)*Q,x&&(Q=u*N-v*g,j+=(g+N)*Q,W+=Q),u<s[0]&&(s[0]=u),u>s[1]&&(s[1]=u),c<s[2]&&(s[2]=c),c>s[3]&&(s[3]=c),x&&(g<s[4]&&(s[4]=g),g>s[5]&&(s[5]=g))}if(T*_>0&&(T*=-1),W*_>0&&(W*=-1),!T)return null;const L=[G,A,.5*T];return x&&(L[3]=j,L[4]=.5*W),L}function F(s,n,o,f){const x=o-s,y=f-n;return Math.sqrt(x*x+y*y)}function D(s,n,o,f,x,y){const _=f-s,O=x-n,h=y-o;return Math.sqrt(_*_+O*O+h*h)}function I(s,n,o,f){return[s+.5*(o-s),n+.5*(f-n)]}function P(s,n,o,f,x,y){return[s+.5*(f-s),n+.5*(x-n),o+.5*(y-o)]}},58175:(re,H,p)=>{p.d(H,{q:()=>g});var S=p(15861),z=p(85931),Z=p(26584),V=p(58817),E=p(62208),F=p(1036),D=p(16730),I=p(5548),P=p(65401),s=p(32442),n=p(91179),o=p(93555),f=p(37053),x=p(82054),y=p(50736),_=p(82959),O=p(87757),h=p(83308),C=p(53023),G=p(76530),A=p(6185),j=p(60466),T=p(46679),W=p(87091);const w="feature-store:unsupported-query",u=new F.WJ(2e6);let c=0;class g{constructor(e){this.capabilities={query:O.g},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new F.Xq(c+++"$$",u)),this.fieldsIndex=new j.Z(e.fields),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=(0,E.hw)(this._frameTask),this.clearCache(),(0,E.SC)(this._geometryQueryCache),this._changeHandle=(0,E.hw)(this._changeHandle),(0,E.SC)(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return(0,E.Wi)(e)?null:{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:(0,A.S2)(this.spatialReference)}}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=(0,G.R)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache?.clear(),this._allItems=null,this._timeExtent=null}executeQuery(e,i){var t=this;return(0,S.Z)(function*(){try{return(yield t._executeQuery(e,{},i)).createQueryResponse()}catch(r){if(r!==A.vF)throw r;return new h.y([],e,t).createQueryResponse()}})()}executeQueryForCount(e={},i){var t=this;return(0,S.Z)(function*(){try{return(yield t._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},i)).createQueryResponseForCount()}catch(r){if(r!==A.vF)throw r;return 0}})()}executeQueryForExtent(e,i){var t=this;return(0,S.Z)(function*(){const r=e.outSR;try{const a=yield t._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},i),d=a.size;if(!d)return{count:0,extent:null};(0,I.t8)(M,I.Gv),t.featureStore.forEachBounds(a.items,R=>(0,I.TC)(M,R),v);const m={xmin:M[0],ymin:M[1],xmax:M[3],ymax:M[4],spatialReference:(0,A.S2)(t.spatialReference)};t.hasZ&&isFinite(M[2])&&isFinite(M[5])&&(m.zmin=M[2],m.zmax=M[5]);const l=(0,_.iV)(m,a.spatialReference,r);if(l.spatialReference=(0,A.S2)(r||t.spatialReference),l.xmax-l.xmin==0){const R=(0,D.c9)(l.spatialReference);l.xmin-=R,l.xmax+=R}if(l.ymax-l.ymin==0){const R=(0,D.c9)(l.spatialReference);l.ymin-=R,l.ymax+=R}if(t.hasZ&&null!=l.zmin&&null!=l.zmax&&l.zmax-l.zmin==0){const R=(0,D.c9)(l.spatialReference);l.zmin-=R,l.zmax+=R}return{count:d,extent:l}}catch(a){if(a===A.vF)return{count:0,extent:null};throw a}})()}executeQueryForIds(e,i){var t=this;return(0,S.Z)(function*(){return t.executeQueryForIdSet(e,i).then(r=>Array.from(r))})()}executeQueryForIdSet(e,i){var t=this;return(0,S.Z)(function*(){try{const r=yield t._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},i),a=r.items,d=new Set;return yield t._reschedule(()=>{for(const m of a)d.add(r.featureAdapter.getObjectId(m))},i),d}catch(r){if(r===A.vF)return new Set;throw r}})()}executeQueryForSnapping(e,i){var t=this;return(0,S.Z)(function*(){const{point:r,distance:a,types:d}=e;if(d===h.r.NONE)return{candidates:[]};const m=yield t._reschedule(()=>t._checkQuerySupport(e.query),i),l=!(0,f.fS)(r.spatialReference,t.spatialReference);l&&(yield(0,_._W)(r.spatialReference,t.spatialReference));const R="number"==typeof a?a:a.x,U="number"==typeof a?a:a.y,B={xmin:r.x-R,xmax:r.x+R,ymin:r.y-U,ymax:r.y+U,spatialReference:r.spatialReference},K=l?(0,_.iV)(B,t.spatialReference):B;if(!K)return{candidates:[]};const X=(yield(0,o.aX)((0,n.im)(r),null,{signal:i}))[0],$=(yield(0,o.aX)((0,n.im)(K),null,{signal:i}))[0];if((0,E.Wi)(X)||(0,E.Wi)($))return{candidates:[]};const te=new h.y(t._searchFeatures(t._getQueryBBoxes($.toJSON())),m,t);yield t._reschedule(()=>t._executeObjectIdsQuery(te),i),yield t._reschedule(()=>t._executeTimeQuery(te),i),yield t._reschedule(()=>t._executeAttributesQuery(te),i);const b=X.toJSON(),k=l?(0,_.iV)(b,t.spatialReference):b,q=l?Math.max(K.xmax-K.xmin,K.ymax-K.ymin)/2:a;return te.createSnappingResponse({...e,point:k,distance:q},r.spatialReference)})()}executeQueryForLatestObservations(e,i){var t=this;return(0,S.Z)(function*(){if(!t.timeInfo||!t.timeInfo.trackIdField)throw new Z.Z(w,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:t.timeInfo});try{const r=yield t._executeQuery(e,{},i);return yield t._reschedule(()=>t._filterLatest(r),i),r.createQueryResponse()}catch(r){if(r!==A.vF)throw r;return new h.y([],e,t).createQueryResponse()}})()}executeQueryForSummaryStatistics(e={},i,t){var r=this;return(0,S.Z)(function*(){const{field:a,normalizationField:d,valueExpression:m}=i;return(yield r._getQueryEngineResultForStats(e,{field:a,normalizationField:d,valueExpression:m},t)).createSummaryStatisticsResponse(i)})()}executeQueryForUniqueValues(e={},i,t){var r=this;return(0,S.Z)(function*(){const{field:a,field2:d,field3:m,valueExpression:l}=i;return(yield r._getQueryEngineResultForStats(e,{field:a,field2:d,field3:m,valueExpression:l},t)).createUniqueValuesResponse(i)})()}executeQueryForClassBreaks(e={},i,t){var r=this;return(0,S.Z)(function*(){const{field:a,normalizationField:d,valueExpression:m}=i;return(yield r._getQueryEngineResultForStats(e,{field:a,normalizationField:d,valueExpression:m},t)).createClassBreaksResponse(i)})()}executeQueryForHistogram(e={},i,t){var r=this;return(0,S.Z)(function*(){const{field:a,normalizationField:d,valueExpression:m}=i;return(yield r._getQueryEngineResultForStats(e,{field:a,normalizationField:d,valueExpression:m},t)).createHistogramResponse(i)})()}_schedule(e,i){var t=this;return(0,S.Z)(function*(){return(0,E.pC)(t._frameTask)?t._frameTask.schedule(e,i):e(W.G5)})()}_reschedule(e,i){var t=this;return(0,S.Z)(function*(){return(0,E.pC)(t._frameTask)?t._frameTask.reschedule(e,i):e(W.G5)})()}_getAll(e){return(0,E.Wi)(this._allItems)&&(this._allItems=this.featureStore.toArray()),new h.y(this._allItems,e,this)}_executeQuery(e,i,t){var r=this;return(0,S.Z)(function*(){e=(0,V.d9)(e),e=yield r._schedule(()=>(0,A.Up)(e,r.definitionExpression,r.spatialReference),t),e=yield r._reschedule(()=>r._checkQuerySupport(e),t),e={...e,...i};const a=yield r._reschedule(()=>r._executeSceneFilterQuery(e,t),t),d=yield r._reschedule(()=>r._executeGeometryQuery(e,a,t),t);return yield r._reschedule(()=>r._executeAggregateIdsQuery(d),t),yield r._reschedule(()=>r._executeObjectIdsQuery(d),t),yield r._reschedule(()=>r._executeTimeQuery(d),t),yield r._reschedule(()=>r._executeAttributesQuery(d),t),d})()}_executeSceneFilterQuery(e,i){var t=this;return(0,S.Z)(function*(){if((0,E.Wi)(e.sceneFilter))return null;const{outSR:r,returnGeometry:a,returnCentroid:d}=e,m=t.featureStore.featureSpatialReference,l=e.sceneFilter.geometry,R=(0,E.Wi)(m)||(0,f.fS)(m,l.spatialReference)?l:(0,_.iV)(l,m);if(!R)return null;const U=a||d,B=(0,f.JY)(r)&&!(0,f.fS)(t.spatialReference,r)&&U?function(){var b=(0,S.Z)(function*(k){return t._project(k,r)});return function(k){return b.apply(this,arguments)}}():b=>b,K=t.featureAdapter,X=t._searchFeatures(t._getQueryBBoxes(R));if("disjoint"===e.sceneFilter.spatialRelationship){if(!X.length)return null;const b=new Set;for(const ie of X)b.add(K.getObjectId(ie));const k=yield t._reschedule(()=>t.featureStore.toArray(),i);return B(yield t._reschedule((0,S.Z)(function*(){const ie=yield(0,C.cW)("esriSpatialRelDisjoint",R,t.geometryType,t.hasZ,t.hasM),Y=yield t._runSpatialFilter(k,J=>!b.has(K.getObjectId(J))||ie(K.getGeometry(J)),i);return new h.y(Y,e,t)}),i))}if(!X.length)return new h.y([],e,t);if(t._canExecuteSinglePass(R,e))return B(new h.y(X,e,t));const $=yield(0,C.cW)("esriSpatialRelContains",R,t.geometryType,t.hasZ,t.hasM),te=yield t._runSpatialFilter(X,b=>$(K.getGeometry(b)),i);return B(new h.y(te,e,t))})()}_executeGeometryQuery(e,i,t){var r=this;return(0,S.Z)(function*(){if((0,E.pC)(i)&&0===i.items.length)return i;e=(0,E.pC)(i)?i.query:e;const{geometry:a,outSR:d,spatialRel:m,returnGeometry:l,returnCentroid:R}=e,U=r.featureStore.featureSpatialReference,B=!a||(0,E.Wi)(U)||(0,f.fS)(U,a.spatialReference)?a:(0,_.iV)(a,U),K=l||R,X=(0,f.JY)(d)&&!(0,f.fS)(r.spatialReference,d),$=r._geometryQueryCache&&(0,E.Wi)(i)?X&&K?JSON.stringify({originalFilterGeometry:a,spatialRelationship:m,outSpatialReference:d}):JSON.stringify({originalFilterGeometry:a,spatialRelationship:m}):null,te=$?r._geometryQueryCache.get($):null;if((0,E.pC)(te))return new h.y(te,e,r);const b=function(){var Y=(0,S.Z)(function*(J){return X&&K&&(yield r._project(J,d)),$&&r._geometryQueryCache.put($,J.items,J.items.length+1),J});return function(oe){return Y.apply(this,arguments)}}();if(!B)return b((0,E.pC)(i)?i:r._getAll(e));const k=r.featureAdapter;let q=r._searchFeatures(r._getQueryBBoxes(a));if("esriSpatialRelDisjoint"===m){if(!q.length)return b((0,E.pC)(i)?i:r._getAll(e));const Y=new Set;for(const ne of q)Y.add(k.getObjectId(ne));const J=(0,E.pC)(i)?i.items:yield r._reschedule(()=>r.featureStore.toArray(),t);return b(yield r._reschedule((0,S.Z)(function*(){const ne=yield(0,C.cW)(m,B,r.geometryType,r.hasZ,r.hasM),le=yield r._runSpatialFilter(J,ae=>!Y.has(k.getObjectId(ae))||ne(k.getGeometry(ae)),t);return new h.y(le,e,r)}),t))}if((0,E.pC)(i)){const Y=new z.SO;q=q.filter(J=>(0,z.cq)(i.items,J,i.items.length,Y)>=0)}if(!q.length){const Y=new h.y([],e,r);return $&&r._geometryQueryCache.put($,Y.items,1),Y}if(r._canExecuteSinglePass(B,e))return b(new h.y(q,e,r));const ie=yield(0,C.cW)(m,B,r.geometryType,r.hasZ,r.hasM),se=yield r._runSpatialFilter(q,Y=>ie(k.getGeometry(Y)),t);return b(new h.y(se,e,r))})()}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds||!e.query.aggregateIds.length||(0,E.Wi)(this.aggregateAdapter))return;const i=new Set;for(const r of e.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach(a=>i.add(a));const t=this.featureAdapter.getObjectId;e.items=e.items.filter(r=>i.has(t(r)))}_executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds||!e.query.objectIds.length)return;const i=new Set(e.query.objectIds),t=this.featureAdapter.getObjectId;e.items=e.items.filter(r=>i.has(t(r)))}_executeTimeQuery(e){if(0===e.items.length)return;const i=(0,G.y)(this.timeInfo,e.query.timeExtent,this.featureAdapter);(0,E.Wi)(i)||(e.items=e.items.filter(i))}_executeAttributesQuery(e){if(0===e.items.length)return;const i=(0,y.Jc)(e.query.where,this.fieldsIndex);if(i){if(!i.isStandardized)throw new TypeError("Where clause is not standardized");e.items=e.items.filter(t=>i.testFeature(t,this.featureAdapter))}}_runSpatialFilter(e,i,t){var r=this;return(0,S.Z)(function*(){if(!i)return e;if((0,E.Wi)(r._frameTask))return e.filter(l=>i(l));let a=0;const d=new Array,m=function(){var l=(0,S.Z)(function*(R){for(;a<e.length;){const U=e[a++];i(U)&&(d.push(U),R.madeProgress()),R.done&&(yield r._reschedule(B=>m(B),t))}});return function(U){return l.apply(this,arguments)}}();return r._reschedule(l=>m(l),t).then(()=>d)})()}_filterLatest(e){const{trackIdField:i,startTimeField:t,endTimeField:r}=this.timeInfo,a=r||t,d=new Map,m=this.featureAdapter.getAttribute;for(const l of e.items){const R=m(l,i),U=m(l,a),B=d.get(R);(!B||U>m(B,a))&&d.set(R,l)}e.items=Array.from(d.values())}_canExecuteSinglePass(e,i){const{spatialRel:t}=i;return(0,C.hN)(e)&&("esriSpatialRelEnvelopeIntersects"===t||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t||"esriSpatialRelWithin"===t))}_project(e,i){var t=this;return(0,S.Z)(function*(){if(!i||(0,f.fS)(t.spatialReference,i))return e;const r=t.featureAdapter,a=yield(0,_.oj)(e.items.map(d=>(0,A.Op)(t.geometryType,t.hasZ,t.hasM,r.getGeometry(d))),t.spatialReference,i);return e.items=a.map((d,m)=>r.cloneWithGeometry(e.items[m],(0,x.GH)(d,t.hasZ,t.hasM))),e})()}_getQueryBBoxes(e){if((0,C.hN)(e)){if((0,n.YX)(e))return[(0,P.al)(e.xmin,e.ymin,e.xmax,e.ymax)];if((0,n.oU)(e))return e.rings.map(i=>(0,P.al)(Math.min(i[0][0],i[2][0]),Math.min(i[0][1],i[2][1]),Math.max(i[0][0],i[2][0]),Math.max(i[0][1],i[2][1])))}return[(0,s.$P)((0,P.Ue)(),e)]}_searchFeatures(e){for(const t of e)this.featureStore.forEachInBounds(t,r=>N.add(r));const i=Array.from(N.values());return N.clear(),i}_checkStatisticsSupport(e,i){var t=this;return(0,S.Z)(function*(){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text||e.outStatistics||e.groupByFieldsForStatistics||e.having||e.orderByFields)throw new Z.Z(w,"Unsupported query options",{query:e});return t._checkAttributesQuerySupport(e),Promise.all([t._checkStatisticsParamsSupport(i),(0,C.P0)(e,t.geometryType,t.spatialReference),(0,_._W)(t.spatialReference,e.outSR)]).then(()=>e)})()}_checkStatisticsParamsSupport(e){var i=this;return(0,S.Z)(function*(){let t=[];if(e.valueExpression){const{arcadeUtils:r}=yield(0,T.LC)();t=r.extractFieldNames(e.valueExpression)}if(e.field&&t.push(e.field),e.field2&&t.push(e.field2),e.field3&&t.push(e.field3),e.normalizationField&&t.push(e.normalizationField),!t.length)throw new Z.Z(w,"params should have at least a field or valueExpression",{params:e});(0,y.Of)(i.fieldsIndex,t,"params contains missing fields")})()}_checkQuerySupport(e){var i=this;return(0,S.Z)(function*(){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new Z.Z(w,"Unsupported query options",{query:e});return i._checkAttributesQuerySupport(e),i._checkStatisticsQuerySupport(e),Promise.all([(0,C.P0)(e,i.geometryType,i.spatialReference),(0,_._W)(i.spatialReference,e.outSR)]).then(()=>e)})()}_checkAttributesQuerySupport(e){const{outFields:i,orderByFields:t,returnDistinctValues:r,outStatistics:a}=e,d=a?a.map(m=>m.outStatisticFieldName&&m.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(t&&t.length>0){const m=" asc",l=" desc",R=t.map(U=>{const B=U.toLowerCase();return B.includes(m)?B.split(m)[0]:B.includes(l)?B.split(l)[0]:U}).filter(U=>!d.includes(U));(0,y.Of)(this.fieldsIndex,R,"orderByFields contains missing fields")}if(i&&i.length>0)(0,y.Of)(this.fieldsIndex,i,"outFields contains missing fields");else if(r)throw new Z.Z(w,"outFields should be specified for returnDistinctValues",{query:e});(0,y.hO)(this.fieldsIndex,e.where)}_checkStatisticsQuerySupport(e){const{outStatistics:i,groupByFieldsForStatistics:t,having:r}=e,a=t&&t.length,d=i&&i.length;if(r){if(!a||!d)throw new Z.Z(w,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});(0,y.z4)(this.fieldsIndex,r,i)}if(d){if(!function L(Q){return Q.every(e=>"exceedslimit"!==e.statisticType)}(i))return;const m=i.map(l=>l.onStatisticField).filter(Boolean);(0,y.Of)(this.fieldsIndex,m,"onStatisticFields contains missing fields"),a&&(0,y.Of)(this.fieldsIndex,t,"groupByFieldsForStatistics contains missing fields");for(const l of i){const{onStatisticField:R,statisticType:U}=l;if("percentile_disc"!==U&&"percentile_cont"!==U||!("statisticParameters"in l)){if("count"!==U&&R&&(0,y.G3)(R,this.fieldsIndex))throw new Z.Z(w,"outStatistics contains non-numeric fields",{definition:l,query:e})}else{const{statisticParameters:B}=l;if(!B)throw new Z.Z(w,"statisticParamters should be set for percentile type",{definition:l,query:e})}}}}_getQueryEngineResultForStats(e,i,t){var r=this;return(0,S.Z)(function*(){e=(0,V.d9)(e);try{e=yield r._schedule(()=>(0,A.Up)(e,r.definitionExpression,r.spatialReference),t),e=yield r._reschedule(()=>r._checkStatisticsSupport(e,i),t);const a=yield r._reschedule(()=>r._executeSceneFilterQuery(e,t),t),d=yield r._reschedule(()=>r._executeGeometryQuery(e,a,t),t);return yield r._reschedule(()=>r._executeAggregateIdsQuery(d),t),yield r._reschedule(()=>r._executeObjectIdsQuery(d),t),yield r._reschedule(()=>r._executeTimeQuery(d),t),yield r._reschedule(()=>r._executeAttributesQuery(d),t),d}catch(a){if(a!==A.vF)throw a;return new h.y([],e,r)}})()}}const v=(0,I.Ue)(),M=(0,I.Ue)(),N=new Set},87757:(re,H,p)=>{p.d(H,{g:()=>S});const S={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},53023:(re,H,p)=>{p.d(H,{hN:()=>ee,P0:()=>L,cW:()=>W});var S=p(15861),z=p(26584),Z=p(33190),V=p(11519),F=p(91179),D=p(37053);function I(u,c){return u?c?4:3:c?3:2}function n(u,c,g,v,M){if(!u)return!1;const N=I(c,g),{coords:Q,lengths:e}=u;let i=!1,t=0;for(const r of e)i=o(i,Q,N,t,r,v,M),t+=r*N;return i}function o(u,c,g,v,M,N,Q){let e=u,i=v;for(let t=v,r=v+M*g;t<r;t+=g){i=t+g,i===r&&(i=v);const a=c[t],d=c[t+1],m=c[i],l=c[i+1];(d<Q&&l>=Q||l<Q&&d>=Q)&&a+(Q-d)/(l-d)*(m-a)<N&&(e=!e)}return e}var f=p(82054),x=p(88071),y=p(82959),_=p(6185);const O="feature-store:unsupported-query",h={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},C_spatialRelationship={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},C_queryGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},C_layerGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function G(u){return null!=u&&!0===C_spatialRelationship[u]}function A(u){return null!=u&&!0===C_queryGeometry[(0,F.Ji)(u)]}function j(u){return null!=u&&!0===C_layerGeometry[u]}function W(u,c,g,v,M){if((0,F.oU)(c)&&"esriGeometryPoint"===g&&("esriSpatialRelIntersects"===u||"esriSpatialRelContains"===u)){const N=(0,f.Uy)(new x.Z,c,!1,!1);return Promise.resolve(Q=>function P(u,c,g,v){return n(u,c,g,v.coords[0],v.coords[1])}(N,!1,!1,Q))}if((0,F.oU)(c)&&"esriGeometryMultipoint"===g){const N=(0,f.Uy)(new x.Z,c,!1,!1);if("esriSpatialRelContains"===u)return Promise.resolve(Q=>function s(u,c,g,v,M,N){const Q=I(M,N),{coords:e,lengths:i}=v;if(!i)return!1;for(let t=0,r=0;t<i.length;t++,r+=Q)if(!n(u,c,g,e[r],e[r+1]))return!1;return!0}(N,!1,!1,Q,v,M))}if((0,F.YX)(c)&&"esriGeometryPoint"===g&&("esriSpatialRelIntersects"===u||"esriSpatialRelContains"===u))return Promise.resolve(N=>(0,Z.aV)(c,(0,_.Op)(g,v,M,N)));if((0,F.YX)(c)&&"esriGeometryMultipoint"===g&&"esriSpatialRelContains"===u)return Promise.resolve(N=>(0,Z.lQ)(c,(0,_.Op)(g,v,M,N)));if((0,F.YX)(c)&&"esriSpatialRelIntersects"===u){const N=function E(u){return"mesh"===u?V.h_:(0,V.IY)(u)}(g);return Promise.resolve(Q=>N(c,(0,_.Op)(g,v,M,Q)))}return function T(){return Promise.all([p.e(4918),p.e(8592)]).then(p.bind(p,32825))}().then(N=>{const Q=N[h[u]].bind(null,c.spatialReference,c);return e=>Q((0,_.Op)(g,v,M,e))})}function L(u,c,g){return w.apply(this,arguments)}function w(){return(w=(0,S.Z)(function*(u,c,g){const{spatialRel:v,geometry:M}=u;if(M){if(!G(v))throw new z.Z(O,"Unsupported query spatial relationship",{query:u});if((0,D.JY)(M.spatialReference)&&(0,D.JY)(g)){if(!A(M))throw new z.Z(O,"Unsupported query geometry type",{query:u});if(!j(c))throw new z.Z(O,"Unsupported layer geometry type",{query:u});if(u.outSR)return(0,y._W)(u.geometry&&u.geometry.spatialReference,u.outSR)}}})).apply(this,arguments)}function ee(u){if((0,F.YX)(u))return!0;if((0,F.oU)(u)){for(const c of u.rings)if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1;return!0}return!1}},76530:(re,H,p)=>{function S(F,D){if(!F)return null;const I=D.featureAdapter,{startTimeField:P,endTimeField:s}=F;let n=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(P&&s)D.forEach(f=>{const x=I.getAttribute(f,P),y=I.getAttribute(f,s);null==x||isNaN(x)||(n=Math.min(n,x)),null==y||isNaN(y)||(o=Math.max(o,y))});else{const f=P||s;D.forEach(x=>{const y=I.getAttribute(x,f);null==y||isNaN(y)||(n=Math.min(n,y),o=Math.max(o,y))})}return{start:n,end:o}}function z(F,D,I){if(!D||!F)return null;const{startTimeField:P,endTimeField:s}=F;if(!P&&!s)return null;const{start:n,end:o}=D;return null===n&&null===o?null:void 0===n&&void 0===o?()=>!1:P&&s?function Z(F,D,I,P,s){return null!=P&&null!=s?n=>{const o=F.getAttribute(n,D),f=F.getAttribute(n,I);return(null==o||o<=s)&&(null==f||f>=P)}:null!=P?n=>{const o=F.getAttribute(n,I);return null==o||o>=P}:null!=s?n=>{const o=F.getAttribute(n,D);return null==o||o<=s}:void 0}(I,P,s,n,o):function V(F,D,I,P){return null!=I&&null!=P&&I===P?s=>F.getAttribute(s,D)===I:null!=I&&null!=P?s=>{const n=F.getAttribute(s,D);return n>=I&&n<=P}:null!=I?s=>F.getAttribute(s,D)>=I:null!=P?s=>F.getAttribute(s,D)<=P:void 0}(I,P||s,n,o)}p.d(H,{R:()=>S,y:()=>z})}}]);