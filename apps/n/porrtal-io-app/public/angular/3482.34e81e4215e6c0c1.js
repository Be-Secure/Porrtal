"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[3482],{3482:(V,B,F)=>{F.d(B,{Z:()=>y});var h=F(15861),R=F(62074),f=F(47982),P=F(49086),O=F(91510),v=F(77132),b=F(87215);class y extends P.Z{constructor(d){super(d),this._relation="",this._relationGeom=null,this._relationString="",this.declaredClass="esri.arcade.featureset.actions.SpatialFilter",this._relationString=d.relationString,this._parent=d.parentfeatureset,this._maxProcessing=40,this._relation=d.relation,this._relationGeom=d.relationGeom}_getSet(d){var S=this;return(0,h.Z)(function*(){if(null===S._wset){yield S._ensureLoaded();const U=yield S._parent._getFilteredSet("esriSpatialRelRelation"!==S._relation?S._relation:S._relation+":"+S._relationString,S._relationGeom,null,null,d);return S._checkCancelled(d),S._wset=new O.Z(U._candidates.slice(0),U._known.slice(0),U._ordered,S._clonePageDefinition(U.pagesDefinition)),S._wset}return S._wset})()}_isInFeatureSet(d){let S=this._parent._isInFeatureSet(d);return S===v.dj.NotInFeatureSet?S:(S=this._idstates[d],void 0===S?v.dj.Unknown:S)}_getFeature(d,S,U){return this._parent._getFeature(d,S,U)}_getFeatures(d,S,U,I){return this._parent._getFeatures(d,S,U,I)}_featureFromCache(d){return this._parent._featureFromCache(d)}executeSpatialRelationTest(d){var S=this;return(0,h.Z)(function*(){if(null===d.geometry)return!1;switch(S._relation){case"esriSpatialRelEnvelopeIntersects":{const U=(0,v.SV)(S._relationGeom),I=(0,v.SV)(d.geometry);return(0,b.kK)(U,I)}case"esriSpatialRelIntersects":return(0,b.kK)(S._relationGeom,d.geometry);case"esriSpatialRelContains":return(0,b.r3)(S._relationGeom,d.geometry);case"esriSpatialRelOverlaps":return(0,b.Nm)(S._relationGeom,d.geometry);case"esriSpatialRelWithin":return(0,b.uh)(S._relationGeom,d.geometry);case"esriSpatialRelTouches":return(0,b.W4)(S._relationGeom,d.geometry);case"esriSpatialRelCrosses":return(0,b.jU)(S._relationGeom,d.geometry);case"esriSpatialRelRelation":return(0,b.LV)(S._relationGeom,d.geometry,S._relationString??"")}})()}_fetchAndRefineFeatures(d,S,U){var I=this;return(0,h.Z)(function*(){const C=new O.Z([],d,!1,null),T=Math.min(S,d.length);yield I._parent?._getFeatures(C,-1,T,U),I._checkCancelled(U);const g=[];for(let e=0;e<T;e++){const s=I._parent._featureFromCache(d[e]);g.push(yield I.executeSpatialRelationTest(s))}for(let e=0;e<S;e++)I._idstates[d[e]]=!0===g[e]?v.dj.InFeatureSet:v.dj.NotInFeatureSet;return"success"})()}_getFilteredSet(d,S,U,I,C){var T=this;return(0,h.Z)(function*(){yield T._ensureLoaded();const g=yield T._parent._getFilteredSet("esriSpatialRelRelation"!==T._relation?T._relation:T._relation+":"+T._relationString,T._relationGeom,U,I,C);let e;return T._checkCancelled(C),e=null!==S?new O.Z(g._candidates.slice(0).concat(g._known.slice(0)),[],g._ordered,T._clonePageDefinition(g.pagesDefinition)):new O.Z(g._candidates.slice(0),g._known.slice(0),g._ordered,T._clonePageDefinition(g.pagesDefinition)),e})()}_stat(d,S,U,I,C,T,g){var e=this;return(0,h.Z)(function*(){if(""!==U)return{calculated:!1};const s=yield e._parent._stat(d,S,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,C,T,g);return!1===s.calculated?null===C&&""===U&&null===I?e._manualStat(d,S,T,g):{calculated:!1}:s})()}_canDoAggregates(d,S,U,I,C){var T=this;return(0,h.Z)(function*(){return""===U&&null===I&&null!==T._parent&&T._parent._canDoAggregates(d,S,"esriSpatialRelRelation"!==T._relation?T._relation:T._relation+":"+T._relationString,T._relationGeom,C)})()}_getAggregatePagesDataSourceDefinition(d,S,U,I,C,T,g){var e=this;return(0,h.Z)(function*(){if(null===e._parent)throw new f.EN(f.H9.NeverReach);return e._parent._getAggregatePagesDataSourceDefinition(d,S,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,C,T,g)})()}static registerAction(){P.Z._featuresetFunctions.intersects=function(d){return null==d?new R.Z({parentfeatureset:this}):new y({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:d})},P.Z._featuresetFunctions.envelopeIntersects=function(d){return null==d?new R.Z({parentfeatureset:this}):new y({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:d})},P.Z._featuresetFunctions.contains=function(d){return null==d?new R.Z({parentfeatureset:this}):new y({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:d})},P.Z._featuresetFunctions.overlaps=function(d){return null==d?new R.Z({parentfeatureset:this}):new y({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:d})},P.Z._featuresetFunctions.within=function(d){return null==d?new R.Z({parentfeatureset:this}):new y({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:d})},P.Z._featuresetFunctions.touches=function(d){return null==d?new R.Z({parentfeatureset:this}):new y({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:d})},P.Z._featuresetFunctions.crosses=function(d){return null==d?new R.Z({parentfeatureset:this}):new y({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:d})},P.Z._featuresetFunctions.relate=function(d,S){return null==d?new R.Z({parentfeatureset:this}):new y({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:d,relationString:S})}}}},62074:(V,B,F)=>{F.d(B,{Z:()=>v});var h=F(15861),R=F(47982),f=F(49086),P=F(91510),O=F(77132);class v extends f.Z{constructor(y){super(y),this.declaredClass="esri.layers.featureset.sources.Empty",this._maxProcessing=1e3,this._wset=new P.Z([],[],!1,null),this._parent=y.parentfeatureset,this._databaseType=O.Bj.Standardised}_getSet(){var y=this;return(0,h.Z)(function*(){return y._wset})()}optimisePagingFeatureQueries(){}_isInFeatureSet(){return O.dj.NotInFeatureSet}_getFeature(){return(0,h.Z)(function*(){throw new R.EN(R.H9.NeverReach)})()}queryAttachments(){return(0,h.Z)(function*(){return[]})()}_getFeatures(){return(0,h.Z)(function*(){return"success"})()}_featureFromCache(){return null}_fetchAndRefineFeatures(){return(0,h.Z)(function*(){throw new R.EN(R.H9.NeverReach)})()}_getFilteredSet(){return(0,h.Z)(function*(){return new P.Z([],[],!1,null)})()}_stat(y,w,d,S,U,I,C){return this._manualStat(y,w,I,C)}_canDoAggregates(){return(0,h.Z)(function*(){return!1})()}}},49086:(V,B,F)=>{F.d(B,{Z:()=>C});var h=F(15861),R=F(53791),f=F(47982),P=F(62208);class O{constructor(g,e){this._lastId=-1,this._progress=e,this._parent=g}reset(){this._lastId=-1}nextBatch(g){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(i=>this.nextBatch(g),i=>this.nextBatch(g));const e={returnpromise:null,hasset:!1},s=[];return e.returnpromise=new Promise((i,a)=>{this._parent._getSet(this._progress).then(l=>{const n=(0,P.s3)(l._known,"known");let r=n.length-1;if("GETPAGES"===n[n.length-1]&&(r-=1),this._lastId+g>r&&n.length>0&&"GETPAGES"===n[n.length-1])return void this._parent._expandPagedSet(l,this._parent._maxQueryRate(),0,0,this._progress).then(c=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(g).then(i,a)},c=>{e.hasset=!0,this._parent._mainSetInUse=null,a(c)});const o=(0,P.s3)(l._candidates,"candidates");if(r>=this._lastId+g||0===o.length){for(let c=0;c<g;c++){const m=c+this._lastId+1;if(m>=n.length)break;s[c]=n[m]}return this._lastId+=s.length,0===s.length&&(e.hasset=!0,this._parent._mainSetInUse=null,i([])),void this._parent._getFeatureBatch(s,this._progress).then(c=>{e.hasset=!0,this._parent._mainSetInUse=null,i(c)},c=>{e.hasset=!0,this._parent._mainSetInUse=null,a(c)})}this._parent._refineSetBlock(l,this._parent._maxProcessingRate(),this._progress).then(()=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(g).then(i,a)},c=>{e.hasset=!0,this._parent._mainSetInUse=null,a(c)})},l=>{e.hasset=!0,this._parent._mainSetInUse=null,a(l)})}),!1===e.hasset&&(this._parent._mainSetInUse=e.returnpromise,e.hasset=!0),e.returnpromise}next(){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(e=>this.next(),e=>this.next());const g={returnpromise:null,hasset:!1};return g.returnpromise=new Promise((e,s)=>{this._parent._getSet(this._progress).then(i=>{const a=(0,P.s3)(i._known,"known");this._lastId<a.length-1?"GETPAGES"===a[this._lastId+1]?this._parent._expandPagedSet(i,this._parent._maxQueryRate(),0,0,this._progress).then(l=>(g.hasset=!0,this._parent._mainSetInUse=null,this.next())).then(e,s):(this._lastId+=1,this._parent._getFeature(i,a[this._lastId],this._progress).then(l=>{g.hasset=!0,this._parent._mainSetInUse=null,e(l)},l=>{g.hasset=!0,this._parent._mainSetInUse=null,s(l)})):(0,P.s3)(i._candidates,"candidates").length>0?this._parent._refineSetBlock(i,this._parent._maxProcessingRate(),this._progress).then(()=>{g.hasset=!0,this._parent._mainSetInUse=null,this.next().then(e,s)},l=>{g.hasset=!0,this._parent._mainSetInUse=null,s(l)}):(g.hasset=!0,this._parent._mainSetInUse=null,e(null))},i=>{g.hasset=!0,this._parent._mainSetInUse=null,s(i)})}),!1===g.hasset&&(this._parent._mainSetInUse=g.returnpromise,g.hasset=!0),g.returnpromise}count(){var g=this;return(0,h.Z)(function*(){if(-1!==g._parent._totalCount)return g._parent._totalCount;const e=yield g._parent._getSet(g._progress),s=yield g._refineAllSets(e);return g._parent._totalCount=s._known.length,g._parent._totalCount})()}_refineAllSets(g){var e=this;return(0,h.Z)(function*(){if(g._known.length>0&&"GETPAGES"===g._known[g._known.length-1])return yield e._parent._expandPagedSet(g,e._parent._maxQueryRate(),0,1,e._progress),e._refineAllSets(g);if(g._candidates.length>0){if("GETPAGES"===g._known[g._candidates.length-1])return yield e._parent._expandPagedSet(g,e._parent._maxQueryRate(),0,2,e._progress),e._refineAllSets(g);const s=yield e._parent._refineSetBlock(g,e._parent._maxProcessingRate(),e._progress);return s._candidates.length>0?e._refineAllSets(s):s}return g})()}}var v=F(91510),b=F(77132),y=F(45333),w=F(10699),d=F(10410),S=F(87215),U=F(65234),I=F(60466);let C=(()=>{class T{constructor(e){this.recentlyUsedQueries=null,this.featureSetQueryInterceptor=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=b.Bj.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=[],this.typeIdField=null,this.types=null,this.fields=null,this.geometryType="",this.objectIdField="",this.globalIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,e&&e.lrucache&&(this.recentlyUsedQueries=e.lrucache),e&&e.interceptor&&(this.featureSetQueryInterceptor=e.interceptor)}optimisePagingFeatureQueries(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)}_hasMemorySource(){return!0}prop(e,s){return void 0===s?this[e]:(void 0!==this[e]&&(this[e]=s),this)}end(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent}_ensureLoaded(){return this.load()}load(){return null===this._loadPromise&&(this._loadPromise=this.loadImpl()),this._loadPromise}loadImpl(){var e=this;return(0,h.Z)(function*(){return!0===e._parent?.loaded?(e._initialiseFeatureSet(),e):(yield e._parent?.load(),e._initialiseFeatureSet(),e)})()}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new U.Z({wkid:4326}),this.geometryType=b.Qk.point)}getField(e,s){let i;return(s=s||this.fields)&&(e=e.toLowerCase(),s.some(a=>(a&&a.name.toLowerCase()===e&&(i=a),!!i))),i}getFieldsIndex(){return null===this._fieldsIndex&&(this._fieldsIndex=new I.Z(this.fields)),this._fieldsIndex}_maxProcessingRate(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())}_maxQueryRate(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery}_checkCancelled(e){if(null!=e&&e.aborted)throw new f.EN(f.H9.Cancelled)}nativeCapabilities(){return this._parent.nativeCapabilities()}_canDoAggregates(e,s,i,a,l){var n=this;return(0,h.Z)(function*(){return null!==n._parent&&n._parent._canDoAggregates(e,s,i,a,l)})()}_getAggregatePagesDataSourceDefinition(e,s,i,a,l,n,r){var o=this;return(0,h.Z)(function*(){if(null===o._parent)throw new f.EN(f.H9.NeverReach);return o._parent._getAggregatePagesDataSourceDefinition(e,s,i,a,l,n,r)})()}_getAgregagtePhysicalPage(e,s,i){var a=this;return(0,h.Z)(function*(){if(null===a._parent)throw new f.EN(f.H9.NeverReach);return a._parent._getAgregagtePhysicalPage(e,s,i)})()}databaseType(){var e=this;return(0,h.Z)(function*(){if(e._databaseType===b.Bj.NotEvaluated){if(null!==R.Z.applicationCache){const s=R.Z.applicationCache.getDatabaseType(e._cacheableFeatureSetSourceKey());if(null!==s)return s}if(null!==e._databaseTypeProbed)return e._databaseTypeProbed;try{e._databaseTypeProbed=e._getDatabaseTypeImpl(),null!==R.Z.applicationCache&&R.Z.applicationCache.setDatabaseType(e._cacheableFeatureSetSourceKey(),e._databaseTypeProbed)}catch(s){throw null!==R.Z.applicationCache&&R.Z.applicationCache.clearDatabaseType(e._cacheableFeatureSetSourceKey()),s}return e._databaseTypeProbed}return e._databaseType})()}_getDatabaseTypeImpl(){var e=this;return(0,h.Z)(function*(){const s=[{thetype:b.Bj.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:b.Bj.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:b.Bj.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}];for(const i of s)if(!0===(yield e._runDatabaseProbe(i.testwhere)))return i.thetype;return b.Bj.StandardisedNoInterval})()}_cacheableFeatureSetSourceKey(){return"MUSTBESET"}_runDatabaseProbe(e){var s=this;return(0,h.Z)(function*(){if(null!==s._parent)return s._parent._runDatabaseProbe(e);throw new f.EN(f.H9.NotImplemented)})()}isTable(){return this._parent?.isTable()??!1}_featureFromCache(e){if(void 0!==this._featureCache[e])return this._featureCache[e]}_isInFeatureSet(e){return b.dj.Unknown}_getSet(e){throw new f.EN(f.H9.NotImplemented)}_getFeature(e,s,i){var a=this;return(0,h.Z)(function*(){if(a._checkCancelled(i),void 0!==a._featureFromCache(s)||(yield a._getFeatures(e,s,a._maxProcessingRate(),i),a._checkCancelled(i),void 0!==a._featureFromCache(s)))return a._featureFromCache(s);throw new f.EN(f.H9.MissingFeatures)})()}_getFeatureBatch(e,s){var i=this;return(0,h.Z)(function*(){i._checkCancelled(s);const a=new v.Z([],e,!1,null),l=[];yield i._getFeatures(a,-1,e.length,s),i._checkCancelled(s);for(const n of e)void 0!==i._featureFromCache(n)&&l.push(i._featureFromCache(n));return l})()}_getFeatures(e,s,i,a){return(0,h.Z)(function*(){return"success"})()}_getFilteredSet(e,s,i,a,l){throw new f.EN(f.H9.NotImplemented)}_refineSetBlock(e,s,i){var a=this;return(0,h.Z)(function*(){if(!0===a._checkIfNeedToExpandCandidatePage(e,a._maxQueryRate()))return yield a._expandPagedSet(e,a._maxQueryRate(),0,0,i),a._refineSetBlock(e,s,i);a._checkCancelled(i);const l=e._candidates.length;a._refineKnowns(e,s);let n=l-e._candidates.length;if(0===e._candidates.length||n>=s)return e;if(yield a._refineIfParentKnown(e,s-n,i),a._checkCancelled(i),a._refineKnowns(e,s-n),n=l-e._candidates.length,n<s&&e._candidates.length>0){const r=s-n,o=a._prepareFetchAndRefineSet(e._candidates);return yield a._fetchAndRefineFeatures(o,o.length>r?r:e._candidates.length,i),a._checkCancelled(i),a._refineKnowns(e,s-n),e}return e})()}_fetchAndRefineFeatures(e,s,i){return null}_prepareFetchAndRefineSet(e){const s=[];for(let i=0;i<e.length;i++)this._isPhysicalFeature(e[i])&&s.push(e[i]);return s}_isPhysicalFeature(e){return null===this._parent||this._parent._isPhysicalFeature(e)}_refineKnowns(e,s){let i=0,a=null;const l=[];s=this._maxQueryRate();for(let n=0;n<e._candidates.length&&"GETPAGES"!==e._candidates[n];n++){let r=!1;const o=this._candidateIdTransform(e._candidates[n]);o!==e._candidates[n]&&(r=!0);const c=this._isInFeatureSet(o);if(c===b.dj.InFeatureSet)!0===r?e._known.includes(o)||(e._known.push(o),i+=1):(e._known.push(e._candidates[n]),i+=1),null===a?a={start:n,end:n}:a.end===n-1?a.end=n:(l.push(a),a={start:n,end:n});else if(c===b.dj.NotInFeatureSet)null===a?a={start:n,end:n}:a.end===n-1?a.end=n:(l.push(a),a={start:n,end:n}),i+=1;else if(c===b.dj.Unknown&&(i+=1,!0===e._ordered))break;if(i>=s)break}null!==a&&l.push(a);for(let n=l.length-1;n>=0;n--)e._candidates.splice(l[n].start,l[n].end-l[n].start+1)}_refineIfParentKnown(e,s,i){const a=new v.Z([],[],e._ordered,null);return a._candidates=e._candidates.slice(0),this._parent._refineSetBlock(a,s,i)}_candidateIdTransform(e){return this._parent._candidateIdTransform(e)}_checkIfNeedToExpandKnownPage(e,s){if(null===e.pagesDefinition)return!1;let i=0;for(let a=e._lastFetchedIndex;a<e._known.length;a++){if("GETPAGES"===e._known[a])return!0;if(void 0===this._featureCache[e._known[a]]&&(i+=1,i>=s))break}return!1}_checkIfNeedToExpandCandidatePage(e,s){if(null===e.pagesDefinition)return!1;let i=0;for(let a=0;a<e._candidates.length;a++){if("GETPAGES"===e._candidates[a])return!0;if(i+=1,i>=s)break}return!1}_expandPagedSet(e,s,i,a,l){var n=this;return(0,h.Z)(function*(){if(null===n._parent)throw new f.EN(f.H9.NotImplemented);return n._parent._expandPagedSet(e,s,i,a,l)})()}_expandPagedSetFeatureSet(e,s,i,a,l){var n=this;return(0,h.Z)(function*(){if(e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(a=1),0===a&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(a=2),0===a)return"finished";const r=yield n._getPage(e,a,l);return i+r<s?n._expandPagedSet(e,s,i+r,0,l):"success"})()}_getPage(e,s,i){var a=this;return(0,h.Z)(function*(){const l=1===s?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){l.length=l.length-1;let n=0;for(let o=0;o<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+o>=e.pagesDefinition.internal.set.length);o++)l[l.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+o],n++;e.pagesDefinition.resultOffset+=n;let r=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(r=!0),!1===r&&l.push("GETPAGES"),n}return yield a._getPhysicalPage(e,s,i),a._getPage(e,s,i)})()}_getPhysicalPage(e,s,i){return null}_clonePageDefinition(e){return null===this._parent?null:this._parent._clonePageDefinition(e)}_first(e){return this.iterator(e).next()}first(e){return this._first(e)}calculateStatistic(e,s,i,a){var l=this;return(0,h.Z)(function*(){yield l._ensureLoaded();let n=yield l._stat(e,s,"",null,null,i,a);return!1===n.calculated&&(n=yield l._manualStat(e,s,i,a)),n.result})()}_manualStat(e,s,i,a){var l=this;return(0,h.Z)(function*(){let n=null;switch(e.toLowerCase()){case"count":return n=yield(0,y.QX)(l,a),{calculated:!0,result:n};case"distinct":return n=yield(0,y.EB)(l,s,i,a),{calculated:!0,result:n};case"avg":case"mean":return n=yield(0,y.J6)(l,s,a),{calculated:!0,result:n};case"stdev":return n=yield(0,y.m)(l,s,a),{calculated:!0,result:n};case"variance":return n=yield(0,y.CA)(l,s,a),{calculated:!0,result:n};case"sum":return n=yield(0,y.Sm)(l,s,a),{calculated:!0,result:n};case"min":return n=yield(0,y.VV)(l,s,a),{calculated:!0,result:n};case"max":return n=yield(0,y.Fp)(l,s,a),{calculated:!0,result:n};default:return{calculated:!0,result:0}}})()}_stat(e,s,i,a,l,n,r){var o=this;return(0,h.Z)(function*(){const c=yield o._parent._stat(e,s,i,a,l,n,r);return!1===c.calculated?null===l&&""===i&&null===a?o._manualStat(e,s,n,r):{calculated:!1}:c})()}_unionAllGeomSelf(e){const s=this.iterator(this._defaultTracker(e)),i=[];return new Promise((a,l)=>{this._unionShapeInBatches(i,s,a,l)})}_unionAllGeom(e){return new Promise((s,i)=>{const a=this.iterator(this._defaultTracker(e));this._unionShapeInBatches([],a,s,i)})}_unionShapeInBatches(e,s,i,a){s.next().then(l=>{try{null!==l&&null!==l.geometry&&e.push(l.geometry),e.length>30||null===l&&e.length>1?(0,S.G0)(e).then(n=>{try{null===l?i(n):this._unionShapeInBatches(e=[n],s,i,a)}catch(r){a(r)}},a):null===l?i(1===e.length?e[0]:null):this._unionShapeInBatches(e,s,i,a)}catch(n){a(n)}},a)}iterator(e){return new O(this,e)}intersection(e,s=!1){return T._featuresetFunctions.intersection.bind(this)(e,s)}difference(e,s=!1,i=!0){return T._featuresetFunctions.difference.bind(this)(e,s,i)}symmetricDifference(e,s=!1,i=!0){return T._featuresetFunctions.symmetricDifference.bind(this)(e,s,i)}morphShape(e,s,i="unknown",a=null){return T._featuresetFunctions.morphShape.bind(this)(e,s,i,a)}morphShapeAndAttributes(e,s,i="unknown"){return T._featuresetFunctions.morphShapeAndAttributes.bind(this)(e,s,i)}union(e,s=!1){return T._featuresetFunctions.union.bind(this)(e,s)}intersects(e){return T._featuresetFunctions.intersects.bind(this)(e)}envelopeIntersects(e){return T._featuresetFunctions.envelopeIntersects.bind(this)(e)}contains(e){return T._featuresetFunctions.contains.bind(this)(e)}overlaps(e){return T._featuresetFunctions.overlaps.bind(this)(e)}relate(e,s){return T._featuresetFunctions.relate.bind(this)(e,s)}within(e){return T._featuresetFunctions.within.bind(this)(e)}touches(e){return T._featuresetFunctions.touches.bind(this)(e)}top(e){return T._featuresetFunctions.top.bind(this)(e)}crosses(e){return T._featuresetFunctions.crosses.bind(this)(e)}buffer(e,s,i,a=!0){return T._featuresetFunctions.buffer.bind(this)(e,s,i,a)}filter(e,s=null){return T._featuresetFunctions.filter.bind(this)(e,s)}orderBy(e){return T._featuresetFunctions.orderBy.bind(this)(e)}dissolve(e,s){return T._featuresetFunctions.dissolve.bind(this)(e,s)}groupby(e,s){return T._featuresetFunctions.groupby.bind(this)(e,s)}reduce(e,s=null,i){return new Promise((a,l)=>{this._reduceImpl(this.iterator(this._defaultTracker(i)),e,s,0,a,l,0)})}_reduceImpl(e,s,i,a,l,n,r){try{if(++r>1e3)return void setTimeout(()=>{this._reduceImpl(e,s,i,a,l,n,r=0)});e.next().then(o=>{try{if(null===o)l(i);else{const c=s(i,o,a,this);(0,w.y8)(c)?c.then(m=>{this._reduceImpl(e,s,m,a+1,l,n,r)},n):this._reduceImpl(e,s,c,a+1,l,n,r)}}catch(c){n(c)}},n)}catch(o){n(o)}}removeField(e){return T._featuresetFunctions.removeField.bind(this)(e)}addField(e,s,i=null){return T._featuresetFunctions.addField.bind(this)(e,s,i)}sumArea(e,s=!1,i){const a=(0,b.EI)(e);return this.reduce((l,n)=>null===n.geometry?0:s?(0,S.Y4)(n.geometry,a).then(r=>l+r):(0,S.CJ)(n.geometry,a).then(r=>l+r),0,i)}sumLength(e,s=!1,i){const a=(0,b.Lz)(e);return this.reduce((l,n)=>null===n.geometry?0:s?(0,S.kQ)(n.geometry,a).then(r=>l+r):(0,S.sz)(n.geometry,a).then(r=>l+r),0,i)}_substituteVars(e,s){if(null!==s){const i={};for(const a in s)i[a.toLowerCase()]=s[a];e.parameters=i}}distinct(e,s=1e3,i=null,a){var l=this;return(0,h.Z)(function*(){yield l.load();const n=d.WhereClause.create(e,l.getFieldsIndex());return l._substituteVars(n,i),l.calculateStatistic("distinct",n,s,l._defaultTracker(a))})()}min(e,s=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=d.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,s),a.calculateStatistic("min",l,-1,a._defaultTracker(i))})()}max(e,s=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=d.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,s),a.calculateStatistic("max",l,-1,a._defaultTracker(i))})()}avg(e,s=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=d.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,s),a.calculateStatistic("avg",l,-1,a._defaultTracker(i))})()}sum(e,s=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=d.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,s),a.calculateStatistic("sum",l,-1,a._defaultTracker(i))})()}stdev(e,s=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=d.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,s),a.calculateStatistic("stdev",l,-1,a._defaultTracker(i))})()}variance(e,s=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=d.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,s),a.calculateStatistic("variance",l,-1,a._defaultTracker(i))})()}count(e){var s=this;return(0,h.Z)(function*(){return yield s.load(),s.calculateStatistic("count",d.WhereClause.create("1",s.getFieldsIndex()),-1,s._defaultTracker(e))})()}_defaultTracker(e){return e||{aborted:!1}}forEach(e,s){return new Promise((i,a)=>{this._forEachImpl(this.iterator(this._defaultTracker(s)),e,this,i,a,0)})}_forEachImpl(e,s,i,a,l,n){try{if(++n>1e3)return void setTimeout(()=>{this._forEachImpl(e,s,i,a,l,n=0)},0);e.next().then(r=>{try{if(null===r)a(i);else{const o=s(r);null==o?this._forEachImpl(e,s,i,a,l,n):(0,w.y8)(o)?o.then(()=>{try{this._forEachImpl(e,s,i,a,l,n)}catch(c){l(c)}},l):this._forEachImpl(e,s,i,a,l,n)}}catch(o){l(o)}},l)}catch(r){l(r)}}convertToJSON(e){const s={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}};for(let i=0;i<this.fields.length;i++)s.layerDefinition.fields.push((0,b.Sh)(this.fields[i]));return this.reduce((i,a)=>{const l={geometry:a.geometry&&a.geometry.toJSON(),attributes:{}};for(const n in a.attributes)l.attributes[n]=a.attributes[n];return s.featureSet.features.push(l),1},0,e).then(()=>s)}castToText(e=!1){return"object, FeatureSet"}queryAttachments(e,s,i,a,l){return this._parent.queryAttachments(e,s,i,a,l)}serviceUrl(){return this._parent.serviceUrl()}subtypes(){return this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map(e=>({name:e.name,code:e.id})):[]}:null}relationshipMetaData(){return this._parent.relationshipMetaData()}get gdbVersion(){return this._parent?this._parent.gdbVersion:""}schema(){const e=[];for(const s of this.fields)e.push((0,b.Sh)(s));return{objectIdField:this.objectIdField,globalIdField:this.globalIdField,geometryType:void 0===b.q2[this.geometryType]?"":b.q2[this.geometryType],fields:e}}convertToText(e,s){var i=this;return(0,h.Z)(function*(){if("schema"===e)return yield i._ensureLoaded(),JSON.stringify(i.schema());if("featureset"===e){yield i._ensureLoaded();const a=[];yield i.reduce((n,r)=>{const o={geometry:r.geometry?r.geometry.toJSON():null,attributes:r.attributes};return null!==o.geometry&&o.geometry.spatialReference&&delete o.geometry.spatialReference,a.push(o),1},0,s);const l=i.schema();return l.features=a,l.spatialReference=i.spatialReference.toJSON(),JSON.stringify(l)}return i.castToText()})()}getFeatureByObjectId(e,s){return this._parent.getFeatureByObjectId(e,s)}getOwningSystemUrl(){return this._parent.getOwningSystemUrl()}getIdentityUser(){return this._parent.getIdentityUser()}getRootFeatureSet(){return null!==this._parent?this._parent.getRootFeatureSet():this}getDataSourceFeatureSet(){return null!==this._parent?this._parent.getDataSourceFeatureSet():this}castAsJson(e=null){return"keeptype"===e?.featureset?this:"none"===e?.featureset?null:{type:"FeatureSet"}}castAsJsonAsync(e=null,s=null){var i=this;return(0,h.Z)(function*(){if("keeptype"===s?.featureset)return i;if("schema"===s?.featureset)return yield i._ensureLoaded(),JSON.parse(JSON.stringify(i.schema()));if("none"===s?.featureset)return null;yield i._ensureLoaded();const a=[];yield i.reduce((n,r)=>{const o={geometry:r.geometry?!0===s?.keepGeometryType?r.geometry:r.geometry.toJSON():null,attributes:r.attributes};return null!==o.geometry&&o.geometry.spatialReference&&!0!==s?.keepGeometryType&&delete o.geometry.spatialReference,a.push(o),1},0,e);const l=i.schema();return l.features=a,l.spatialReference=!0===s?.keepGeometryType?i.spatialReference:i.spatialReference?.toJSON(),l})()}}return T._featuresetFunctions={},T})()},91510:(V,B,F)=>{F.d(B,{Z:()=>h});class h{constructor(f,P,O,v){this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=f,this._known=P,this._ordered=O,this.pagesDefinition=v}}},53791:(V,B,F)=>{F.d(B,{Z:()=>h});let h=(()=>{class R{constructor(){this._databaseTypeMetaData={},this._layerInfo={}}clearDatabaseType(P){void 0===this._databaseTypeMetaData[P]&&delete this._databaseTypeMetaData[P]}getDatabaseType(P){return"MUSTBESET"===P||void 0===this._databaseTypeMetaData[P]?null:this._databaseTypeMetaData[P]}setDatabaseType(P,O){this._databaseTypeMetaData[P]=O}getLayerInfo(P){return void 0===this._layerInfo[P]?null:this._layerInfo[P]}setLayerInfo(P,O){this._layerInfo[P]=O}clearLayerInfo(P){void 0!==this._layerInfo[P]&&delete this._layerInfo[P]}}return R.applicationCache=null,R})()},47982:(V,B,F)=>{F.d(B,{EN:()=>b,H9:()=>O,eS:()=>P,f:()=>R});var R,y,h=F(25919);(y=R||(R={})).InvalidFunctionParameters="InvalidFunctionParameters",y.UnsupportedSqlFunction="UnsupportedSqlFunction",y.UnsupportedOperator="UnsupportedOperator",y.UnsupportedSyntax="UnsupportedSyntax",y.UnsupportedIsRhs="UnsupportedIsRhs",y.UnsupportedIsLhs="UnsupportedIsLhs",y.MissingStatisticParameters="MissingStatisticParameters";const f={[R.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[R.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[R.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[R.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[R.UnsupportedOperator]:"Unsupported operator - {operator}",[R.UnsupportedSyntax]:"Unsupported syntax - {node}",[R.UnsupportedSqlFunction]:"Sql function not found = {function}"};class P extends Error{constructor(w,d){super((0,h.Hy)(f[w],d)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,P)}}var O;!function(y){y.NeverReach="NeverReach",y.NotImplemented="NotImplemented",y.Cancelled="Cancelled",y.InvalidStatResponse="InvalidStatResponse",y.InvalidRequest="InvalidRequest",y.RequestFailed="RequestFailed",y.MissingFeatures="MissingFeatures",y.AggregationFieldNotFound="AggregationFieldNotFound",y.DataElementsNotFound="DataElementsNotFound"}(O||(O={}));const v={[O.Cancelled]:"Cancelled",[O.InvalidStatResponse]:"Invalid statistics response from service",[O.InvalidRequest]:"Invalid request",[O.RequestFailed]:"Request failed - {reason}",[O.MissingFeatures]:"Missing features",[O.AggregationFieldNotFound]:"Aggregation field not found",[O.DataElementsNotFound]:"Data elements not found on service",[O.NeverReach]:"Encountered unreachable logic",[O.NotImplemented]:"Not implemented"};class b extends Error{constructor(w,d){super((0,h.Hy)(v[w],d)),this.declaredRootClass="esri.arcade.featureset.support.featureseterror",Error.captureStackTrace&&Error.captureStackTrace(this,b)}}},83947:(V,B,F)=>{F.d(B,{$e:()=>y,DT:()=>I,TE:()=>l,XF:()=>v,bB:()=>b,fz:()=>d,hq:()=>e,oX:()=>S,vR:()=>U,y5:()=>s,zR:()=>O});var h=F(77132),R=F(10410),f=F(47982),P=F(21837);function O(n,r){return w(n?.parseTree,r,n?.parameters)}function v(n,r,o){return w(n,r,o)}function b(n,r,o,c){return R.WhereClause.create(w(n.parseTree,h.Bj.Standardised,n.parameters,r,o),c)}function y(n,r,o="AND"){return R.WhereClause.create("(("+O(n,h.Bj.Standardised)+")"+o+"("+O(r,h.Bj.Standardised)+"))",n.fieldsIndex)}function w(n,r,o,c=null,m=null){let N,L,G,k;switch(n.type){case"interval":return l(w(n.value,r,o,c,m),n.qualifier,n.op);case"case-expression":{let p=" CASE ";"simple"===n.format&&(p+=w(n.operand,r,o,c,m));for(let E=0;E<n.clauses.length;E++)p+=" WHEN "+w(n.clauses[E].operand,r,o,c,m)+" THEN "+w(n.clauses[E].value,r,o,c,m);return null!==n.else&&(p+=" ELSE "+w(n.else,r,o,c,m)),p+=" END ",p}case"parameter":{const p=o[n.value.toLowerCase()];if("string"==typeof p)return"'"+o[n.value.toLowerCase()].toString().replace(/'/g,"''")+"'";if(p instanceof Date)return S(p,r);if(p instanceof Array){const E=[];for(let x=0;x<p.length;x++)"string"==typeof p[x]?E.push("'"+p[x].toString().replace(/'/g,"''")+"'"):p[x]instanceof Date?E.push(S(p[x],r)):E.push(p[x].toString());return E}return p.toString()}case"expression-list":L=[];for(const p of n.value)L.push(w(p,r,o,c,m));return L;case"unary-expression":return" ( NOT "+w(n.expr,r,o,c,m)+" ) ";case"binary-expression":switch(n.operator){case"AND":return" ("+w(n.left,r,o,c,m)+" AND "+w(n.right,r,o,c,m)+") ";case"OR":return" ("+w(n.left,r,o,c,m)+" OR "+w(n.right,r,o,c,m)+") ";case"IS":if("null"!==n.right.type)throw new f.eS(f.f.UnsupportedIsRhs);return" ("+w(n.left,r,o,c,m)+" IS NULL )";case"ISNOT":if("null"!==n.right.type)throw new f.eS(f.f.UnsupportedIsRhs);return" ("+w(n.left,r,o,c,m)+" IS NOT NULL )";case"IN":return N=[],"expression-list"===n.right.type?(N=w(n.right,r,o,c,m)," ("+w(n.left,r,o,c,m)+" IN ("+N.join(",")+")) "):(k=w(n.right,r,o,c,m),k instanceof Array?" ("+w(n.left,r,o,c,m)+" IN ("+k.join(",")+")) ":" ("+w(n.left,r,o,c,m)+" IN ("+k+")) ");case"NOT IN":return N=[],"expression-list"===n.right.type?(N=w(n.right,r,o,c,m)," ("+w(n.left,r,o,c,m)+" NOT IN ("+N.join(",")+")) "):(k=w(n.right,r,o,c,m),k instanceof Array?" ("+w(n.left,r,o,c,m)+" NOT IN ("+k.join(",")+")) ":" ("+w(n.left,r,o,c,m)+" NOT IN ("+k+")) ");case"BETWEEN":return G=w(n.right,r,o,c,m)," ("+w(n.left,r,o,c,m)+" BETWEEN "+G[0]+" AND "+G[1]+" ) ";case"NOTBETWEEN":return G=w(n.right,r,o,c,m)," ("+w(n.left,r,o,c,m)+" NOT BETWEEN "+G[0]+" AND "+G[1]+" ) ";case"LIKE":return""!==n.escape?" ("+w(n.left,r,o,c,m)+" LIKE "+w(n.right,r,o,c,m)+" ESCAPE '"+n.escape+"') ":" ("+w(n.left,r,o,c,m)+" LIKE "+w(n.right,r,o,c,m)+") ";case"NOT LIKE":return""!==n.escape?" ("+w(n.left,r,o,c,m)+" NOT LIKE "+w(n.right,r,o,c,m)+" ESCAPE '"+n.escape+"') ":" ("+w(n.left,r,o,c,m)+" NOT LIKE "+w(n.right,r,o,c,m)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+w(n.left,r,o,c,m)+" "+n.operator+" "+w(n.right,r,o,c,m)+") "}throw new f.eS(f.f.UnsupportedOperator,{operator:n.operator});case"null":return"null";case"boolean":return!0===n.value?"1":"0";case"string":return"'"+n.value.toString().replace(/'/g,"''")+"'";case"timestamp":case"date":return S(n.value,r);case"number":return n.value.toString();case"current-time":return U("date"===n.mode,r);case"column-reference":return c&&c.toLowerCase()===n.column.toLowerCase()?"("+m+")":n.column;case"function":{const p=w(n.args,r,o,c,m);return d(n.name,p,r)}}throw new f.eS(f.f.UnsupportedSyntax,{node:n.type})}function d(n,r,o){switch(n.toLowerCase().trim()){case"abs":if(1!==r.length)throw new f.eS(f.f.InvalidFunctionParameters,{function:"abs"});return"abs("+r[0]+")";case"ceiling":case"ceil":if(1!==r.length)throw new f.eS(f.f.InvalidFunctionParameters,{function:"ceiling"});return"CEILING("+r[0]+")";case"floor":if(1!==r.length)throw new f.eS(f.f.InvalidFunctionParameters,{function:"floor"});return"FLOOR("+r[0]+")";case"log":if(1!==r.length)throw new f.eS(f.f.InvalidFunctionParameters,{function:"log"});return"LOG("+r[0]+")";case"log10":if(1!==r.length)throw new f.eS(f.f.InvalidFunctionParameters,{function:"log10"});return"LOG10("+r[0]+")";case"power":if(2!==r.length)throw new f.eS(f.f.InvalidFunctionParameters,{function:"power"});return"POWER("+r[0]+","+r[1]+")";case"round":if(2===r.length)return"ROUND("+r[0]+","+r[1]+")";if(1===r.length)return"ROUND("+r[0]+")";throw new f.eS(f.f.InvalidFunctionParameters,{function:"round"});case"truncate":if(r.length<1||r.length>2)throw new f.eS(f.f.InvalidFunctionParameters,{function:"truncate"});return o===h.Bj.SqlServer?"ROUND("+r[0]+(1===r.length?"0":","+r[1])+",1)":"TRUNCATE("+r[0]+(1===r.length?")":","+r[1]+")");case"char_length":case"len":if(1!==r.length)throw new f.eS(f.f.InvalidFunctionParameters,{function:"char_length"});switch(o){case h.Bj.SqlServer:return"LEN("+r[0]+")";case h.Bj.Oracle:return"LENGTH("+r[0]+")";default:return"CHAR_LENGTH("+r[0]+")"}case"concat":if(r.length<1)throw new f.eS(f.f.InvalidFunctionParameters,{function:"concat"});{let c="CONCAT(";for(let m=0;m<r.length;m++)0!==m&&(c+=","),c+=r[m];return c+=")",c}case"lower":case"lcase":if(1!==r.length)throw new f.eS(f.f.InvalidFunctionParameters,{function:"lower"});return"LOWER("+r[0]+")";case"upper":case"ucase":if(1!==r.length)throw new f.eS(f.f.InvalidFunctionParameters,{function:"upper"});return"UPPER("+r[0]+")";case"substring":{let c="";switch(o){case h.Bj.Oracle:return c="SUBSTR("+r[0]+","+r[1],3===r.length&&(c+=","+r[2]),c+=")",c;case h.Bj.SqlServer:return c=3===r.length?"SUBSTRING("+r[0]+","+r[1]+","+r[2]+")":"SUBSTRING("+r[0]+",  "+r[1]+", LEN("+r[0]+") - "+r[1]+")",c;default:return c="SUBSTRING("+r[0]+" FROM "+r[1],3===r.length&&(c+=" FOR "+r[2]),c+=")",c}}case"extract":return"EXTRACT("+r[0].replace(/\'/g,"")+" FROM "+r[1]+")"}throw new f.eS(f.f.InvalidFunctionParameters,{function:n})}function S(n,r){const o=n instanceof Date?P.ou.fromJSDate(n):P.ou.fromSQL(n),c=0===o.hour&&0===o.minute&&0===o.second&&0===o.millisecond;switch(r){case h.Bj.FILEGDB:case h.Bj.Standardised:case h.Bj.StandardisedNoInterval:return c?`date '${o.toFormat("yyyy-LL-dd")}'`:`date '${o.toFormat("yyyy-LL-dd HH:mm:ss")}'`;case h.Bj.Oracle:return c?`TO_DATE('${o.toFormat("yyyy-LL-dd")}','YYYY-MM-DD')`:`TO_DATE('${o.toFormat("yyyy-LL-dd HH:mm:ss")}','YYYY-MM-DD HH24:MI:SS')`;case h.Bj.SqlServer:return`'${o.toFormat(c?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;case h.Bj.PGDB:return`#${o.toFormat(c?"LL-dd-yyyy":"LL-dd-yyyy HH:mm:ss")}#`;case h.Bj.Postgres:return`TIMESTAMP '${o.toFormat(c?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;default:return`date '${o.toFormat("yyyy-LL-dd HH:mm:ss")}'`}}function U(n,r){switch(r){case h.Bj.FILEGDB:case h.Bj.Standardised:case h.Bj.StandardisedNoInterval:case h.Bj.Oracle:return n?"CURRENT_DATE":"CURRENT_TIMESTAMP";case h.Bj.SqlServer:return n?"CAST(GETDATE() AS DATE)":"GETDATE()";default:return n?"CURRENT_DATE":"CURRENT_TIMESTAMP"}}function I(n,r,o={}){const c={},m={},N={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",oid:"integer",long:"integer","small-integer":"integer",integer:"integer",single:"double",double:"double",date:"date",string:"string"};for(const L of r){const G=L.type?N[L.type]:void 0;c[L.name.toLowerCase()]=void 0===G?"":G}for(const L in o){const G=N[o[L]];m[L.toLowerCase()]=void 0===G?"":G}switch(C(c,n.parseTree,n.parameters,m)){case"double":return"double";case"integer":return"integer";case"date":return"date";case"string":return"string"}return""}function C(n,r,o,c){let m;switch(r.type){case"interval":return"integer";case"case-expression":{const N=[];if("simple"===r.format){for(let L=0;L<r.clauses.length;L++)N.push(C(n,r.clauses[L].value,o,c));null!==r.else&&N.push(C(n,r.else,o,c))}else{for(let L=0;L<r.clauses.length;L++)N.push(C(n,r.else,o,c));null!==r.else&&N.push(C(n,r.else,o,c))}return g(N)}case"parameter":{const N=c[r.value.toLowerCase()];if(void 0===N&&o){const L=o[r.value.toLowerCase()];if(null==L)return"";if("string"==typeof L||L instanceof String)return"string";if("boolean"==typeof L)return"boolean";if(L instanceof Date)return"date";if("number"==typeof L)return L%1==0?"integer":"double"}return void 0===N?"":N}case"expression-list":{const N=[];for(const L of r.value)N.push(C(n,L,o,c));return N}case"unary-expression":return"boolean";case"binary-expression":switch(r.operator){case"AND":case"OR":case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"IS":case"ISNOT":if("null"!==r.right.type)throw new f.eS(f.f.UnsupportedIsRhs);return"boolean";case"*":case"-":case"+":case"/":return g([C(n,r.left,o,c),C(n,r.right,o,c)]);default:throw new f.eS(f.f.UnsupportedOperator,{operator:r.operator})}case"null":return"";case"boolean":return"boolean";case"string":return"string";case"number":return null===r.value?"":r.value%1==0?"integer":"double";case"date":case"timestamp":case"current-time":return"date";case"column-reference":{const N=n[r.column.toLowerCase()];return void 0===N?"":N}case"function":switch(r.name.toLowerCase()){case"position":case"extract":case"char_length":return"integer";case"round":return m=C(n,r.args,o,c),m instanceof Array?m.length>0?m[0]:"":m;case"sign":return m=C(n,r.args,o,c),m instanceof Array&&(m=g(m)),"integer"===m||"double"===m?m:"double";case"ceiling":case"floor":case"abs":{const N=C(n,r.args,o,c);return N instanceof Array?g(N):N}case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"power":case"truncate":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string"}return""}throw new f.eS(f.f.UnsupportedSyntax,{node:r.type})}const T={boolean:1,string:2,integer:3,double:4,date:5};function g(n){if(n){let r="";for(const o of n)""!==o&&(r=""===r||T[r]<T[o]?o:r);return r}return""}function e(n,r){return i(n.parseTree,r)}function s(n){return"column-reference"===n?.parseTree.type}function i(n,r){if(null==n)return!1;switch(n.type){case"when-clause":return i(n.operand,r)||i(n.value,r);case"case-expression":for(const o of n.clauses)if(i(o,r))return!0;return!("simple"!==n.format||!i(n.operand,r))||!(null===n.else||!i(n.else,r));case"parameter":case"null":case"boolean":case"date":case"timestamp":case"string":case"number":return!1;case"expression-list":for(const o of n.value)if(i(o,r))return!0;return!1;case"unary-expression":return i(n.expr,r);case"binary-expression":return i(n.left,r)||i(n.right,r);case"column-reference":return r.toLowerCase()===n.column.toLowerCase();case"function":return i(n.args,r)}return!1}function a(n){let r="";return r+=n.period.toUpperCase(),r}function l(n,r,o){let c="";return c="interval-period"===r.type?a(r):a(r.start)+" TO "+a(r.end),"INTERVAL "+o+" "+n+" "+c}},45333:(V,B,F)=>{F.d(B,{CA:()=>i,EB:()=>G,Fp:()=>T,J6:()=>e,QX:()=>c,Sm:()=>r,VV:()=>I,g3:()=>S,m:()=>l,tj:()=>U});var h=F(15861),R=F(47982),f=F(77132),P=F(83947);function O(p){return p=+p,isFinite(p)?p-p%1||(p<0?-0:0===p?p:0):p}function v(p){let E=0;for(let x=0;x<p.length;x++)E+=p[x];return E/p.length}function b(p){const E=v(p);let x=0;for(let A=0;A<p.length;A++)x+=(E-p[A])**2;return x/p.length}function y(p){const E=v(p);let x=0;for(let A=0;A<p.length;A++)x+=(E-p[A])**2;return x/(p.length-1)}function w(p){let E=0;for(let x=0;x<p.length;x++)E+=p[x];return E}function S(p){switch(p.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""}function U(p,E,x=1e3){switch(p.toLowerCase()){case"distinct":return function d(p,E){const x=[],A={},W=[];for(let M=0;M<p.length;M++){if(null!=p[M]){const j=p[M];if((0,f.hj)(j)||(0,f.HD)(j))void 0===A[j]&&(x.push(j),A[j]=1);else{let K=!1;for(let H=0;H<W.length;H++)!0===(0,f.tt)(W[H],j)&&(K=!0);!1===K&&(W.push(j),x.push(j))}}if(x.length>=E&&-1!==E)return x}return x}(E,x);case"avg":case"mean":return v(E);case"min":return Math.min.apply(Math,E);case"sum":return w(E);case"max":return Math.max.apply(Math,E);case"stdev":case"stddev":return Math.sqrt(b(E));case"var":case"variance":return b(E);case"count":return E.length}return 0}function I(p,E,x){return C.apply(this,arguments)}function C(){return(C=(0,h.Z)(function*(p,E,x){const A=yield N(p,E,x,!0);return 0===A.length?null:Math.min.apply(Math,A)})).apply(this,arguments)}function T(p,E,x){return g.apply(this,arguments)}function g(){return(g=(0,h.Z)(function*(p,E,x){const A=yield N(p,E,x,!0);return 0===A.length?null:Math.max.apply(Math,A)})).apply(this,arguments)}function e(p,E,x){return s.apply(this,arguments)}function s(){return(s=(0,h.Z)(function*(p,E,x){let A="";E&&!(0,P.y5)(E)&&(A=(0,P.DT)(E,p.fields));const W=yield N(p,E,x,!0);if(0===W.length)return null;const M=v(W);return null===M?M:"integer"===A?O(M):M})).apply(this,arguments)}function i(p,E,x){return a.apply(this,arguments)}function a(){return(a=(0,h.Z)(function*(p,E,x){const A=yield N(p,E,x,!0);return 0===A.length?null:y(A)})).apply(this,arguments)}function l(p,E,x){return n.apply(this,arguments)}function n(){return(n=(0,h.Z)(function*(p,E,x){const A=yield N(p,E,x,!0);return 0===A.length?null:Math.sqrt(y(A))})).apply(this,arguments)}function r(p,E,x){return o.apply(this,arguments)}function o(){return(o=(0,h.Z)(function*(p,E,x){const A=yield N(p,E,x,!0);return 0===A.length?null:w(A)})).apply(this,arguments)}function c(p,E){return m.apply(this,arguments)}function m(){return(m=(0,h.Z)(function*(p,E){return p.iterator(E).count()})).apply(this,arguments)}function N(p,E,x){return L.apply(this,arguments)}function L(){return(L=(0,h.Z)(function*(p,E,x,A=!1){const W=p.iterator(x),M=[],j={ticker:0};let K=yield W.next();for(;null!==K;){if(j.ticker++,x.aborted)throw new R.EN(R.H9.Cancelled);j.ticker%100==0&&(j.ticker=0,yield new Promise(Q=>{setTimeout(Q,0)}));const H=E?.calculateValue(K);null===H?!1===A&&(M[M.length]=H):M[M.length]=H,K=yield W.next()}return M})).apply(this,arguments)}function G(p,E){return k.apply(this,arguments)}function k(){return(k=(0,h.Z)(function*(p,E,x=1e3,A=null){const W=p.iterator(A),M=[],j={},K={ticker:0};let H=yield W.next();for(;null!==H;){if(K.ticker++,A&&A.aborted)throw new R.EN(R.H9.Cancelled);K.ticker%100==0&&(K.ticker=0,yield new Promise($=>{setTimeout($,0)}));const Q=E?.calculateValue(H);if(null!=Q&&void 0===j[Q]&&(M.push(Q),j[Q]=1),M.length>=x&&-1!==x)return M;H=yield W.next()}return M})).apply(this,arguments)}},87215:(V,B,F)=>{F.d(B,{CJ:()=>xe,Cz:()=>Te,D$:()=>Ee,ED:()=>G,G0:()=>ge,Gg:()=>E,JI:()=>W,LV:()=>p,Nm:()=>k,Sp:()=>H,TE:()=>o,U1:()=>Ie,W4:()=>N,Y4:()=>we,cv:()=>me,e5:()=>j,f3:()=>ye,fS:()=>c,j2:()=>ve,jU:()=>r,kK:()=>m,kQ:()=>De,og:()=>x,oq:()=>s,r3:()=>n,rd:()=>Se,sz:()=>Fe,uh:()=>L,wf:()=>$,z7:()=>a});var h=F(15861),f=(F(29132),F(59289)),O=(F(72642),F(91179));function v(u){return Array.isArray(u)?u[0]?.spatialReference:u?.spatialReference}function b(u){return u&&(Array.isArray(u)?u.map(b):u.toJSON?u.toJSON():u)}function y(u){return Array.isArray(u)?u.map(_=>(0,O.im)(_)):(0,O.im)(u)}function w(u,_){let D;return Array.isArray(u)?D=u:(D=[],D.push(u),null!=_&&D.push(_)),D}let d;function S(){return U.apply(this,arguments)}function U(){return(U=(0,h.Z)(function*(){return d||(d=(0,f.bA)("geometryEngineWorker",{strategy:"distributed"})),d})).apply(this,arguments)}function I(u,_){return C.apply(this,arguments)}function C(){return(C=(0,h.Z)(function*(u,_){return(yield S()).invoke("executeGEOperation",{operation:u,parameters:b(_)})})).apply(this,arguments)}function s(u,_){return i.apply(this,arguments)}function i(){return(i=(0,h.Z)(function*(u,_){return y(yield I("clip",[v(u),u,_]))})).apply(this,arguments)}function a(u,_){return l.apply(this,arguments)}function l(){return(l=(0,h.Z)(function*(u,_){return y(yield I("cut",[v(u),u,_]))})).apply(this,arguments)}function n(u,_){return I("contains",[v(u),u,_])}function r(u,_){return I("crosses",[v(u),u,_])}function o(u,_,D){return I("distance",[v(u),u,_,D])}function c(u,_){return I("equals",[v(u),u,_])}function m(u,_){return I("intersects",[v(u),u,_])}function N(u,_){return I("touches",[v(u),u,_])}function L(u,_){return I("within",[v(u),u,_])}function G(u,_){return I("disjoint",[v(u),u,_])}function k(u,_){return I("overlaps",[v(u),u,_])}function p(u,_,D){return I("relate",[v(u),u,_,D])}function E(u){return I("isSimple",[v(u),u])}function x(u){return A.apply(this,arguments)}function A(){return(A=(0,h.Z)(function*(u){return y(yield I("simplify",[v(u),u]))})).apply(this,arguments)}function W(u){return M.apply(this,arguments)}function M(){return(M=(0,h.Z)(function*(u,_=!1){return y(yield I("convexHull",[v(u),u,_]))})).apply(this,arguments)}function j(u,_){return K.apply(this,arguments)}function K(){return(K=(0,h.Z)(function*(u,_){return y(yield I("difference",[v(u),u,_]))})).apply(this,arguments)}function H(u,_){return Q.apply(this,arguments)}function Q(){return(Q=(0,h.Z)(function*(u,_){return y(yield I("symmetricDifference",[v(u),u,_]))})).apply(this,arguments)}function $(u,_){return X.apply(this,arguments)}function X(){return(X=(0,h.Z)(function*(u,_){return y(yield I("intersect",[v(u),u,_]))})).apply(this,arguments)}function ge(u){return q.apply(this,arguments)}function q(){return(q=(0,h.Z)(function*(u,_=null){const D=w(u,_);return y(yield I("union",[v(D),D]))})).apply(this,arguments)}function me(u,_,D,Z,J,z){return ee.apply(this,arguments)}function ee(){return(ee=(0,h.Z)(function*(u,_,D,Z,J,z){return y(yield I("offset",[v(u),u,_,D,Z,J,z]))})).apply(this,arguments)}function ye(u,_,D){return te.apply(this,arguments)}function te(){return(te=(0,h.Z)(function*(u,_,D,Z=!1){const J=[v(u),u,_,D,Z];return y(yield I("buffer",J))})).apply(this,arguments)}function Se(u,_,D,Z,J,z){return ne.apply(this,arguments)}function ne(){return(ne=(0,h.Z)(function*(u,_,D,Z,J,z){const Pe=[v(u),u,_,D,Z,J,z];return y(yield I("geodesicBuffer",Pe))})).apply(this,arguments)}function ie(u){return"xmin"in u?u.center:"x"in u?u:u.extent?.center}function Ie(u,_,D){return ue.apply(this,arguments)}function ue(){return(ue=(0,h.Z)(function*(u,_,D){if(null==u)throw new Y;const Z=u.spatialReference;if(null==(D=D??ie(u)))throw new Y;const J=u.constructor.fromJSON(yield I("rotate",[Z,u,_,D]));return J.spatialReference=Z,J})).apply(this,arguments)}function Ee(u,_,D,Z){return ce.apply(this,arguments)}function ce(){return(ce=(0,h.Z)(function*(u,_,D,Z){return y(yield I("generalize",[v(u),u,_,D,Z]))})).apply(this,arguments)}function Te(u,_,D){return he.apply(this,arguments)}function he(){return(he=(0,h.Z)(function*(u,_,D){return y(yield I("densify",[v(u),u,_,D]))})).apply(this,arguments)}function ve(u,_,D){return _e.apply(this,arguments)}function _e(){return(_e=(0,h.Z)(function*(u,_,D,Z=0){return y(yield I("geodesicDensify",[v(u),u,_,D,Z]))})).apply(this,arguments)}function xe(u,_){return I("planarArea",[v(u),u,_])}function Fe(u,_){return I("planarLength",[v(u),u,_])}function we(u,_,D){return I("geodesicArea",[v(u),u,_,D])}function De(u,_,D){return I("geodesicLength",[v(u),u,_,D])}class Y extends Error{constructor(){super("Illegal Argument Exception")}}}}]);