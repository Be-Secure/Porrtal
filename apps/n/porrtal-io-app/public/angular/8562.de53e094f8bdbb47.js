"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[8562],{19702:(R,v,e)=>{e.d(v,{A:()=>y});var r=e(15861),l=e(17626),c=e(54024),p=e(10699),n=e(32917),O=e(77712),o=(e(85931),e(90912),e(76898)),g=e(36947);const y=P=>{let t=class extends P{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(a){super.postscript(a),(0,g.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var a=this;return(0,r.Z)(function*(){const s=new AbortController,u=s.signal;a.handles.add((0,c.kB)(()=>s.abort())),yield(0,n.N1)(()=>a.view.defaultsFromMap?.heightModelInfoReady,u),(0,p.k_)(u);const M=(0,g.Wt)(a.layer,a.view.heightModelInfo,a.supportsHeightUnitConversion);if(M)throw M})()}canResume(){const a=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!a||!a.minScale||!a.maxScale||a.minScale>=a.maxScale)}getSuspendInfo(){const a=super.getSuspendInfo(),s=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return s&&s.minScale&&s.maxScale&&s.minScale<s.maxScale&&(a.outsideScaleRange=!0),a}};return(0,l._)([(0,O.Cb)()],t.prototype,"view",void 0),(0,l._)([(0,O.Cb)()],t.prototype,"slicePlaneEnabled",void 0),t=(0,l._)([(0,o.j)("esri.views.3d.layers.LayerView3D")],t),t}},8562:(R,v,e)=>{e.r(v),e.d(v,{default:()=>j});var r=e(15861),l=e(17626),c=e(26584),p=e(62208),n=e(77712),f=(e(85931),e(90912),e(76898)),o=e(55915),g=e(19702),y=e(50916),P=e(45611),t=e(94421),a=e(10699),s=e(22264);const u=i=>{let _=class extends i{fetchPopupFeatures(m,U){var L=this;return(0,r.Z)(function*(){const{layer:I}=L;if(!m)throw new c.Z("tilelayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:I});if("tile"!==I.type)throw new c.Z("tilelayerview:fetchPopupFeatures","Layer type should be 'tile'",{type:I.type});const T=L.get("view.scale"),S=I.allSublayers.toArray().filter(d=>d.popupTemplate&&d.popupEnabled&&d.visible&&(0===d.minScale||T<=d.minScale)&&(0===d.maxScale||T>=d.maxScale));return(0,a.as)(S.map(function(){var d=(0,r.Z)(function*(h){const C=h.createQuery(),W=(0,p.pC)(U)?U.event:null,A=(0,s.k)({renderer:h.renderer,event:W});return C.geometry=L.createFetchPopupFeaturesQueryGeometry(m,A),C.outFields=yield h.popupTemplate.getRequiredFields(),(yield h.queryFeatures(C)).features});return function(h){return d.apply(this,arguments)}}())).then(d=>[].concat(...d.map(h=>h.value).filter(Boolean)))})()}};return(0,l._)([(0,n.Cb)()],_.prototype,"layer",void 0),_=(0,l._)([(0,f.j)("esri.layers.mixins.TileLayerView")],_),_};var M=e(94672);let E=class extends((0,t.Z)((0,y.r)(u((0,g.A)(P.Z))))){constructor(){super(...arguments),this.type="tile-3d"}get imageFormatIsOpaque(){return"jpg"===this.layer.tileInfo.format}get hasMixedImageFormats(){return"mixed"===this.layer.tileInfo.format}get tileInfo(){return this.layer?.tileInfo}get dataLevelRange(){if(this.tileInfo){const i=this.tileInfo.lods;return this.levelRangeFromScaleRange(i[0].scale,i[i.length-1].scale)}return{minLevel:0,maxLevel:0}}initialize(){if("web-tile"===this.layer.type){const i=this.layer.get("fullExtent.spatialReference"),_=this.layer.get("tileInfo.spatialReference");if((0,p.Wi)(i)||(0,p.Wi)(_)||!(0,o.Up)(i,_)){const m="defaults"===this.layer.originOf("fullExtent")||(0,p.Wi)(this.layer.fullExtent)?"SceneView requires fullExtent to be specified by the user on WebTileLayer":"SceneView requires fullExtent to be specified in the same spatial reference as tileInfo on WebTileLayer";this.addResolvingPromise(Promise.reject(new c.Z("layerview:incompatible-fullextent",m)))}}this._addTilingSchemeMatchPromise()}createFetchPopupFeaturesQueryGeometry(i,_){return(0,M.K)(i,_,this.view)}doRefresh(){var i=this;return(0,r.Z)(function*(){i.suspended||i.emit("data-changed")})()}};(0,l._)([(0,n.Cb)()],E.prototype,"imageFormatIsOpaque",null),(0,l._)([(0,n.Cb)()],E.prototype,"hasMixedImageFormats",null),(0,l._)([(0,n.Cb)()],E.prototype,"layer",void 0),(0,l._)([(0,n.Cb)()],E.prototype,"tileInfo",null),(0,l._)([(0,n.Cb)()],E.prototype,"dataLevelRange",null),E=(0,l._)([(0,f.j)("esri.views.3d.layers.TileLayerView3D")],E);const j=E},45611:(R,v,e)=>{e.d(v,{Z:()=>a});var r=e(17626),l=e(14517),c=e(61885),p=e(80542),n=e(61996),O=e(63290),D=e(62208),f=e(60330),o=e(77712),P=(e(85931),e(90912),e(76898));let t=class extends((0,p.p)((0,n.IG)((0,f.v)(c.Z.EventedMixin(l.Z))))){constructor(s){super(s),this.layer=null,this.parent=null}initialize(){this.when().catch(s=>{if("layerview:create-error"!==s.name){const u=this.layer&&this.layer.id||"no id",M=this.layer&&this.layer.title||"no title";O.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${M}', id: '${u}')`,s)}})}get fullOpacity(){return(0,D.Pt)(this.get("layer.opacity"),1)*(0,D.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this.updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(s){this._overrideIfSome("visible",s)}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const s=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(s.viewNotReady=!0),this.layer&&this.layer.loaded||(s.layerNotLoaded=!0),this.visible||(s.layerInvisible=!0),s}isUpdating(){return!1}};(0,r._)([(0,o.Cb)()],t.prototype,"fullOpacity",null),(0,r._)([(0,o.Cb)()],t.prototype,"layer",void 0),(0,r._)([(0,o.Cb)()],t.prototype,"parent",void 0),(0,r._)([(0,o.Cb)({readOnly:!0})],t.prototype,"suspended",null),(0,r._)([(0,o.Cb)({readOnly:!0})],t.prototype,"suspendInfo",null),(0,r._)([(0,o.Cb)({readOnly:!0})],t.prototype,"legendEnabled",null),(0,r._)([(0,o.Cb)({type:Boolean,readOnly:!0})],t.prototype,"updating",null),(0,r._)([(0,o.Cb)({readOnly:!0})],t.prototype,"updatingProgress",null),(0,r._)([(0,o.Cb)()],t.prototype,"visible",null),(0,r._)([(0,o.Cb)()],t.prototype,"view",void 0),t=(0,r._)([(0,P.j)("esri.views.layers.LayerView")],t);const a=t},94421:(R,v,e)=>{e.d(v,{Z:()=>o});var r=e(17626),l=e(63290),c=e(10699),p=e(32917),n=e(77712),f=(e(85931),e(90912),e(76898));const o=g=>{let y=class extends g{initialize(){this.handles.add((0,p.on)(()=>this.layer,"refresh",P=>{this.doRefresh(P.dataChanged).catch(t=>{(0,c.D_)(t)||l.Z.getLogger(this.declaredClass).error(t)})}),"RefreshableLayerView")}};return(0,r._)([(0,n.Cb)()],y.prototype,"layer",void 0),y=(0,r._)([(0,f.j)("esri.layers.mixins.RefreshableLayerView")],y),y}}}]);