/*
Copyright 2022 Comcast Cable Communications Management, LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[4940],{52489:(Pe,te,n)=>{n.d(te,{D:()=>t});var M=n(22558);function t(re){re&&re.writtenProperties&&re.writtenProperties.forEach(({target:se,propName:F,newOrigin:Q})=>{(0,M.l)(se)&&Q&&se.originOf(F)!==Q&&se.updateOrigin(F,Q)})}},22558:(Pe,te,n)=>{function M(t){return t&&"getAtOrigin"in t&&"originOf"in t}n.d(te,{l:()=>M})},84940:(Pe,te,n)=>{n.r(te),n.d(te,{default:()=>Sr});var M=n(15861),t=n(17626),re=n(59318),se=n(29132),F=n(88879),Q=n(73281),I=(n(4832),n(49067),n(96794),n(69747),n(40425),n(69357),n(40342),n(73640),n(33474)),P=n(46160),W=n(26584),bt=n(80542),ke=n(63290),a=n(62208),St=n(99959),Qe=n(94113),wt=n(10699),Ct=n(32917),Bt=n(16730),Se=n(21726),i=n(77712),Tt=(n(85931),n(90912)),L=n(68653),j=n(76898),X=n(99433),Nt=n(52489),Xe=n(2004),He=n(55915),Ye=n(37053),Rt=n(44917),Zt=n(552),Pt=n(49286),Lt=n(6647),At=n(99555),It=n(38305),G=n(20383),U=n(86810),oe=n(57213);let H=class extends U.wq{constructor(e){super(e),this.break=new oe.Z({color:[255,255,255],size:12,outline:{color:[0,122,194],width:3}}),this.first=new oe.Z({color:[0,255,0],size:20,outline:{color:[255,255,255],width:4}}),this.unlocated=new oe.Z({color:[255,0,0],size:12,outline:{color:[255,255,255],width:3}}),this.last=new oe.Z({color:[255,0,0],size:20,outline:{color:[255,255,255],width:4}}),this.middle=new oe.Z({color:[51,51,51],size:12,outline:{color:[0,122,194],width:3}}),this.waypoint=new oe.Z({color:[255,255,255],size:12,outline:{color:[0,122,194],width:3}})}};(0,t._)([(0,i.Cb)({types:G.LB})],H.prototype,"break",void 0),(0,t._)([(0,i.Cb)({types:G.LB})],H.prototype,"first",void 0),(0,t._)([(0,i.Cb)({types:G.LB})],H.prototype,"unlocated",void 0),(0,t._)([(0,i.Cb)({types:G.LB})],H.prototype,"last",void 0),(0,t._)([(0,i.Cb)({types:G.LB})],H.prototype,"middle",void 0),(0,t._)([(0,i.Cb)({types:G.LB})],H.prototype,"waypoint",void 0),H=(0,t._)([(0,j.j)("esri.layers.support.RouteStopSymbols")],H);const qe=H;var Ae=n(52068),jt=n(88493);let V=class extends U.wq{constructor(e){super(e),this.directionLines=new Ae.Z({color:[0,122,194],width:6}),this.directionPoints=new oe.Z({color:[255,255,255],size:6,outline:{color:[0,122,194],width:2}}),this.pointBarriers=new oe.Z({style:"x",size:10,outline:{color:[255,0,0],width:3}}),this.polygonBarriers=new jt.Z({color:[255,170,0,.6],outline:{width:7.5,color:[255,0,0,.6]}}),this.polylineBarriers=new Ae.Z({width:7.5,color:[255,85,0,.7]}),this.routeInfo=new Ae.Z({width:8,color:[20,89,127]}),this.stops=new qe}};(0,t._)([(0,i.Cb)({types:G.LB})],V.prototype,"directionLines",void 0),(0,t._)([(0,i.Cb)({types:G.LB})],V.prototype,"directionPoints",void 0),(0,t._)([(0,i.Cb)({types:G.LB})],V.prototype,"pointBarriers",void 0),(0,t._)([(0,i.Cb)({types:G.LB})],V.prototype,"polygonBarriers",void 0),(0,t._)([(0,i.Cb)({types:G.LB})],V.prototype,"polylineBarriers",void 0),(0,t._)([(0,i.Cb)({types:G.LB})],V.prototype,"routeInfo",void 0),(0,t._)([(0,i.Cb)({type:qe})],V.prototype,"stops",void 0),V=(0,t._)([(0,j.j)("esri.layers.support.RouteSymbols")],V);const et=V;var Dt=n(84687),Ot=n(55463),Mt=n(37281),le=n(84792),ae=n(2618),O=n(55342),R=n(51494);let K=class extends U.wq{constructor(e){super(e),this.dataType=null,this.name=null,this.parameterNames=null,this.restrictionUsageParameterName=null,this.timeNeutralAttributeName=null,this.trafficSupport=null,this.units=null,this.usageType=null}};(0,t._)([(0,i.Cb)({type:String})],K.prototype,"dataType",void 0),(0,t._)([(0,O.J)(R.Ul,{ignoreUnknown:!1})],K.prototype,"name",void 0),(0,t._)([(0,i.Cb)({type:[String]})],K.prototype,"parameterNames",void 0),(0,t._)([(0,i.Cb)({type:String})],K.prototype,"restrictionUsageParameterName",void 0),(0,t._)([(0,O.J)(R.ZI,{ignoreUnknown:!1})],K.prototype,"timeNeutralAttributeName",void 0),(0,t._)([(0,i.Cb)({type:String})],K.prototype,"trafficSupport",void 0),(0,t._)([(0,i.Cb)({type:String})],K.prototype,"units",void 0),(0,t._)([(0,O.J)(R.E2)],K.prototype,"usageType",void 0),K=(0,t._)([(0,j.j)("esri.rest.support.NetworkAttribute")],K);const Jt=K;let ie=class extends U.wq{constructor(e){super(e),this.buildTime=null,this.name=null,this.networkAttributes=null,this.networkSources=null,this.state=null}};(0,t._)([(0,i.Cb)({type:Number})],ie.prototype,"buildTime",void 0),(0,t._)([(0,i.Cb)({type:String})],ie.prototype,"name",void 0),(0,t._)([(0,i.Cb)({type:[Jt]})],ie.prototype,"networkAttributes",void 0),(0,t._)([(0,i.Cb)()],ie.prototype,"networkSources",void 0),(0,t._)([(0,i.Cb)({type:String})],ie.prototype,"state",void 0),ie=(0,t._)([(0,j.j)("esri.rest.support.NetworkDataset")],ie);const Et=ie;var tt=n(67854);let E=class extends U.wq{constructor(e){super(e),this.accumulateAttributeNames=null,this.currentVersion=null,this.defaultTravelMode=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsSupportedLanguages=null,this.directionsTimeAttribute=null,this.hasZ=null,this.impedance=null,this.networkDataset=null,this.supportedTravelModes=null}readAccumulateAttributes(e){return(0,a.Wi)(e)?null:e.map(r=>R.Ul.fromJSON(r))}writeAccumulateAttributes(e,r,o){!(0,a.Wi)(e)&&e.length&&(r[o]=e.map(s=>R.Ul.toJSON(s)))}};(0,t._)([(0,i.Cb)()],E.prototype,"accumulateAttributeNames",void 0),(0,t._)([(0,L.r)("accumulateAttributeNames")],E.prototype,"readAccumulateAttributes",null),(0,t._)([(0,X.c)("accumulateAttributeNames")],E.prototype,"writeAccumulateAttributes",null),(0,t._)([(0,i.Cb)()],E.prototype,"currentVersion",void 0),(0,t._)([(0,i.Cb)()],E.prototype,"defaultTravelMode",void 0),(0,t._)([(0,i.Cb)()],E.prototype,"directionsLanguage",void 0),(0,t._)([(0,O.J)(R.GX)],E.prototype,"directionsLengthUnits",void 0),(0,t._)([(0,i.Cb)()],E.prototype,"directionsSupportedLanguages",void 0),(0,t._)([(0,O.J)(R.ZI,{ignoreUnknown:!1})],E.prototype,"directionsTimeAttribute",void 0),(0,t._)([(0,i.Cb)()],E.prototype,"hasZ",void 0),(0,t._)([(0,O.J)(R.Ul,{ignoreUnknown:!1})],E.prototype,"impedance",void 0),(0,t._)([(0,i.Cb)({type:Et})],E.prototype,"networkDataset",void 0),(0,t._)([(0,i.Cb)({type:[tt.Z]})],E.prototype,"supportedTravelModes",void 0),E=(0,t._)([(0,j.j)("esri.rest.support.NetworkServiceDescription")],E);const xt=E,Ut=ke.Z.getLogger("esri.rest.networkService");function we(e,r,o,s){s[o]=[r.length,r.length+e.length],e.forEach(l=>{r.push(l.geometry)})}function Ft(e,r){for(let o=0;o<r.length;o++){const s=e[r[o]];if(s&&s.length)for(const l of s)l.z=void 0}Ut.warnOnce("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")}function Wt(e,r){for(let o=0;o<r.length;o++){const s=e[r[o]];if(s&&s.length)for(const l of s)if((0,a.pC)(l)&&l.hasZ)return!0}return!1}function rt(e,r,o){return Ie.apply(this,arguments)}function Ie(){return(Ie=(0,M.Z)(function*(e,r,o){if(!e)throw new W.Z("network-service:missing-url","Url to Network service is missing");const s=(0,ae.lA)({f:"json",token:r},o),{data:l}=yield(0,le.default)(e,s);l.supportedTravelModes||(l.supportedTravelModes=[]);for(let h=0;h<l.supportedTravelModes.length;h++)l.supportedTravelModes[h].id||(l.supportedTravelModes[h].id=l.supportedTravelModes[h].itemId);const y=l.currentVersion>=10.4?_t(e,r,o):Gt(e,o),{defaultTravelMode:d,supportedTravelModes:m}=yield y;return l.defaultTravelMode=d,l.supportedTravelModes=m,xt.fromJSON(l)})).apply(this,arguments)}function Gt(e,r){return je.apply(this,arguments)}function je(){return(je=(0,M.Z)(function*(e,r){const o=(0,ae.lA)({f:"json"},r),{data:s}=yield(0,le.default)(e.replace(/\/rest\/.*$/i,"/info"),o);if(!s||!s.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};const{owningSystemUrl:l}=s,y=(0,Se.Qj)(l)+"/sharing/rest/portals/self",{data:d}=yield(0,le.default)(y,o),m=(0,Qe.hS)("helperServices.routingUtilities.url",d);if(!m)return{supportedTravelModes:[],defaultTravelMode:null};const h=(0,ae.en)(l),b=/\/solve$/i.test(h.path)?"Route":/\/solveclosestfacility$/i.test(h.path)?"ClosestFacility":"ServiceAreas",c=(0,ae.lA)({f:"json",serviceName:b},r),T=(0,Se.Qj)(m)+"/GetTravelModes/execute",Z=yield(0,le.default)(T,c),C=[];let g=null;if(Z?.data?.results?.length){const S=Z.data.results;for(const N of S)if("supportedTravelModes"===N.paramName){if(N.value?.features)for(const{attributes:p}of N.value.features)if(p){const v=JSON.parse(p.TravelMode);C.push(v)}}else"defaultTravelMode"===N.paramName&&(g=N.value)}return{supportedTravelModes:C,defaultTravelMode:g}})).apply(this,arguments)}function _t(e,r,o){return De.apply(this,arguments)}function De(){return(De=(0,M.Z)(function*(e,r,o){try{const s=(0,ae.lA)({f:"json",token:r},o),l=(0,Se.Qj)(e)+"/retrieveTravelModes",{data:{supportedTravelModes:y,defaultTravelMode:d}}=yield(0,le.default)(l,s);return{supportedTravelModes:y,defaultTravelMode:d}}catch(s){throw new W.Z("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:s})}})).apply(this,arguments)}var Kt=n(93555),ot=n(68171),$=n(17253),it=n(2076);const st=new it.X({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let me=class extends U.wq{constructor(e){super(e),this.description=null,this.type=null}};(0,t._)([(0,i.Cb)({type:String,json:{write:!0}})],me.prototype,"description",void 0),(0,t._)([(0,i.Cb)({type:String,json:{read:st.read,write:st.write}})],me.prototype,"type",void 0),me=(0,t._)([(0,j.j)("esri.rest.support.GPMessage")],me);const zt=me,nt=new it.X({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});let Ce=class extends zt{constructor(e){super(e),this.type=null}};(0,t._)([(0,i.Cb)({type:String,json:{read:nt.read,write:nt.write}})],Ce.prototype,"type",void 0),Ce=(0,t._)([(0,j.j)("esri.rest.support.NAMessage")],Ce);const Vt=Ce;let fe=class extends U.wq{constructor(e){super(e)}};(0,t._)([(0,i.Cb)({json:{read:{source:"string"}}})],fe.prototype,"text",void 0),(0,t._)([(0,O.J)(R.Ks,{name:"stringType"})],fe.prototype,"type",void 0),fe=(0,t._)([(0,j.j)("esri.rest.support.DirectionsString")],fe);const lt=fe;var at=n(72642);let Y=class extends U.wq{constructor(e){super(e),this.arriveTime=null,this.arriveTimeOffset=null,this.geometry=null,this.strings=null}readArriveTimeOffset(e,r){return(0,ot.pQ)(r.ETA,r.arriveTimeUTC)}readGeometry(e,r){return at.Z.fromJSON(r.point)}};(0,t._)([(0,i.Cb)({type:Date,json:{read:{source:"arriveTimeUTC"}}})],Y.prototype,"arriveTime",void 0),(0,t._)([(0,i.Cb)()],Y.prototype,"arriveTimeOffset",void 0),(0,t._)([(0,L.r)("arriveTimeOffset",["arriveTimeUTC","ETA"])],Y.prototype,"readArriveTimeOffset",null),(0,t._)([(0,i.Cb)({type:at.Z})],Y.prototype,"geometry",void 0),(0,t._)([(0,L.r)("geometry",["point"])],Y.prototype,"readGeometry",null),(0,t._)([(0,i.Cb)({type:[lt]})],Y.prototype,"strings",void 0),Y=(0,t._)([(0,j.j)("esri.rest.support.DirectionsEvent")],Y);const $t=Y;var Oe=n(55214);let pe=class extends F.Z{constructor(e){super(e),this.events=null,this.strings=null}readGeometry(e,r){const o=function kt(e){if((0,a.Wi)(e)||""===e)return null;let r=0,o=0,s=0,l=0;const y=[];let d,m,h,b,c,T,Z,C,g=0,S=0,N=0;if(c=e.match(/((\+|\-)[^\+\-\|]+|\|)/g),c||(c=[]),0===parseInt(c[g],32)){g=2;const p=parseInt(c[g],32);g++,T=parseInt(c[g],32),g++,1&p&&(S=c.indexOf("|")+1,Z=parseInt(c[S],32),S++),2&p&&(N=c.indexOf("|",S)+1,C=parseInt(c[N],32),N++)}else T=parseInt(c[g],32),g++;for(;g<c.length&&"|"!==c[g];){d=parseInt(c[g],32)+r,g++,r=d,m=parseInt(c[g],32)+o,g++,o=m;const p=[d/T,m/T];S&&(b=parseInt(c[S],32)+s,S++,s=b,p.push(b/Z)),N&&(h=parseInt(c[N],32)+l,N++,l=h,p.push(h/C)),y.push(p)}return{paths:[y],hasZ:S>0,hasM:N>0}}(r.compressedGeometry);return(0,a.pC)(o)?Oe.Z.fromJSON(o):null}};(0,t._)([(0,i.Cb)({type:[$t]})],pe.prototype,"events",void 0),(0,t._)([(0,L.r)("geometry",["compressedGeometry"])],pe.prototype,"readGeometry",null),(0,t._)([(0,i.Cb)({type:[lt]})],pe.prototype,"strings",void 0),pe=(0,t._)([(0,j.j)("esri.rest.support.DirectionsFeature")],pe);const Qt=pe;var q=n(65234);let x=class extends $.default{constructor(e){super(e),this.extent=null,this.features=null,this.geometryType="polyline",this.routeId=null,this.routeName=null,this.totalDriveTime=null,this.totalLength=null,this.totalTime=null}readFeatures(e,r){if(!e)return[];const o=r.summary.envelope.spatialReference??r.spatialReference,s=o&&q.Z.fromJSON(o);return e.map(l=>{const y=Qt.fromJSON(l);if((0,a.pC)(y.geometry)&&(y.geometry.spatialReference=s),(0,a.pC)(y.events))for(const d of y.events)(0,a.pC)(d.geometry)&&(d.geometry.spatialReference=s);return y})}get mergedGeometry(){return this.features?function Xt(e,r){if(0===e.length)return new Oe.Z({spatialReference:r});const o=[];for(const d of e)for(const m of d.paths)o.push(...m);const s=[];o.forEach((d,m)=>{0!==m&&d[0]===o[m-1][0]&&d[1]===o[m-1][1]||s.push(d)});const{hasM:l,hasZ:y}=e[0];return new Oe.Z({hasM:l,hasZ:y,paths:[s],spatialReference:r})}(this.features.map(({geometry:e})=>(0,a.Wg)(e)),this.extent.spatialReference):null}get strings(){return this.features.map(({strings:e})=>e).flat().filter(a.pC)}};(0,t._)([(0,i.Cb)({type:Xe.Z,json:{read:{source:"summary.envelope"}}})],x.prototype,"extent",void 0),(0,t._)([(0,i.Cb)()],x.prototype,"features",void 0),(0,t._)([(0,L.r)("features")],x.prototype,"readFeatures",null),(0,t._)([(0,i.Cb)()],x.prototype,"geometryType",void 0),(0,t._)([(0,i.Cb)({readOnly:!0})],x.prototype,"mergedGeometry",null),(0,t._)([(0,i.Cb)()],x.prototype,"routeId",void 0),(0,t._)([(0,i.Cb)()],x.prototype,"routeName",void 0),(0,t._)([(0,i.Cb)({value:null,readOnly:!0})],x.prototype,"strings",null),(0,t._)([(0,i.Cb)({json:{read:{source:"summary.totalDriveTime"}}})],x.prototype,"totalDriveTime",void 0),(0,t._)([(0,i.Cb)({json:{read:{source:"summary.totalLength"}}})],x.prototype,"totalLength",void 0),(0,t._)([(0,i.Cb)({json:{read:{source:"summary.totalTime"}}})],x.prototype,"totalTime",void 0),x=(0,t._)([(0,j.j)("esri.rest.support.DirectionsFeatureSet")],x);const Ht=x;let _=class extends U.wq{constructor(e){super(e),this.directionLines=null,this.directionPoints=null,this.directions=null,this.route=null,this.routeName=null,this.stops=null,this.traversedEdges=null,this.traversedJunctions=null,this.traversedTurns=null}};(0,t._)([(0,i.Cb)({type:$.default,json:{write:!0}})],_.prototype,"directionLines",void 0),(0,t._)([(0,i.Cb)({type:$.default,json:{write:!0}})],_.prototype,"directionPoints",void 0),(0,t._)([(0,i.Cb)({type:Ht,json:{write:!0}})],_.prototype,"directions",void 0),(0,t._)([(0,i.Cb)({type:F.Z,json:{write:!0}})],_.prototype,"route",void 0),(0,t._)([(0,i.Cb)({type:String,json:{write:!0}})],_.prototype,"routeName",void 0),(0,t._)([(0,i.Cb)({type:[F.Z],json:{write:!0}})],_.prototype,"stops",void 0),(0,t._)([(0,i.Cb)({type:$.default,json:{write:!0}})],_.prototype,"traversedEdges",void 0),(0,t._)([(0,i.Cb)({type:$.default,json:{write:!0}})],_.prototype,"traversedJunctions",void 0),(0,t._)([(0,i.Cb)({type:$.default,json:{write:!0}})],_.prototype,"traversedTurns",void 0),_=(0,t._)([(0,j.j)("esri.rest.support.RouteResult")],_);const Yt=_;function Me(e){return e&&$.default.fromJSON(e).features.map(r=>r)}let z=class extends U.wq{constructor(e){super(e),this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routeResults=null}readPointBarriers(e,r){return Me(r.barriers)}readPolylineBarriers(e){return Me(e)}readPolygonBarriers(e){return Me(e)}};(0,t._)([(0,i.Cb)({type:[Vt]})],z.prototype,"messages",void 0),(0,t._)([(0,i.Cb)({type:[F.Z]})],z.prototype,"pointBarriers",void 0),(0,t._)([(0,L.r)("pointBarriers",["barriers"])],z.prototype,"readPointBarriers",null),(0,t._)([(0,i.Cb)({type:[F.Z]})],z.prototype,"polylineBarriers",void 0),(0,t._)([(0,L.r)("polylineBarriers")],z.prototype,"readPolylineBarriers",null),(0,t._)([(0,i.Cb)({type:[F.Z]})],z.prototype,"polygonBarriers",void 0),(0,t._)([(0,L.r)("polygonBarriers")],z.prototype,"readPolygonBarriers",null),(0,t._)([(0,i.Cb)({type:[Yt]})],z.prototype,"routeResults",void 0),z=(0,t._)([(0,j.j)("esri.rest.support.RouteSolveResult")],z);const qt=z;function Be(e){return e instanceof $.default}function Je(){return(Je=(0,M.Z)(function*(e,r,o){const s=[],l=[],y={},d={},m=(0,ae.en)(e),{path:h}=m;Be(r.stops)&&we(r.stops.features,l,"stops.features",y),Be(r.pointBarriers)&&we(r.pointBarriers.features,l,"pointBarriers.features",y),Be(r.polylineBarriers)&&we(r.polylineBarriers.features,l,"polylineBarriers.features",y),Be(r.polygonBarriers)&&we(r.polygonBarriers.features,l,"polygonBarriers.features",y);const b=yield(0,Kt.aX)(l);for(const C in y){const g=y[C];s.push(C),d[C]=b.slice(g[0],g[1])}if(Wt(d,s)){let C=null;try{C=yield rt(h,r.apiKey,o)}catch{}C&&!C.hasZ&&Ft(d,s)}for(const C in d)d[C].forEach((g,S)=>{r.get(C)[S].geometry=g});const c={...o,query:{...m.query,...(0,ot.Yc)(r),f:"json"}},T=h.endsWith("/solve")?h:`${h}/solve`,{data:Z}=yield(0,le.default)(T,c);return tr(Z)})).apply(this,arguments)}function tr(e){const{barriers:r,directionLines:o,directionPoints:s,directions:l,messages:y,polygonBarriers:d,polylineBarriers:m,routes:h,stops:b,traversedEdges:c,traversedJunctions:T,traversedTurns:Z}=e,C=p=>{const v=S.find(A=>A.routeName===p);if((0,a.pC)(v))return v;const B={routeId:S.length+1,routeName:p};return S.push(B),B},g=p=>{const v=S.find(A=>A.routeId===p);if((0,a.pC)(v))return v;const B={routeId:p,routeName:null};return S.push(B),B},S=[];h?.features.forEach((p,v)=>{p.geometry.spatialReference=h.spatialReference,S.push({routeId:v+1,routeName:p.attributes.Name,route:p})}),l?.forEach(p=>{const{routeName:v}=p;C(v).directions=p});const N=b?.features.every(p=>(0,a.Wi)(p.attributes.RouteName))&&S.length>0?S[0].routeName:null;return b?.features.forEach(p=>{var v;p.geometry&&((v=p.geometry).spatialReference??(v.spatialReference=b.spatialReference));const A=C(N??p.attributes.RouteName);A.stops??(A.stops=[]),A.stops.push(p)}),o?.features.forEach(p=>{const B=g(p.attributes.RouteID),{geometryType:A,spatialReference:ee}=o;B.directionLines??(B.directionLines={features:[],geometryType:A,spatialReference:ee}),B.directionLines.features.push(p)}),s?.features.forEach(p=>{const B=g(p.attributes.RouteID),{geometryType:A,spatialReference:ee}=s;B.directionPoints??(B.directionPoints={features:[],geometryType:A,spatialReference:ee}),B.directionPoints.features.push(p)}),c?.features.forEach(p=>{const B=g(p.attributes.RouteID),{geometryType:A,spatialReference:ee}=c;B.traversedEdges??(B.traversedEdges={features:[],geometryType:A,spatialReference:ee}),B.traversedEdges.features.push(p)}),T?.features.forEach(p=>{const B=g(p.attributes.RouteID),{geometryType:A,spatialReference:ee}=T;B.traversedJunctions??(B.traversedJunctions={features:[],geometryType:A,spatialReference:ee}),B.traversedJunctions.features.push(p)}),Z?.features.forEach(p=>{const B=g(p.attributes.RouteID);B.traversedTurns??(B.traversedTurns={features:[]}),B.traversedTurns.features.push(p)}),qt.fromJSON({routeResults:S,barriers:r,polygonBarriers:d,polylineBarriers:m,messages:y})}var he=n(99683),ve=n(58924),ue=n(53753),ye=n(719),ce=n(17718),Te=n(29739),Ee=n(79608);const rr={type:String,json:{read:{source:"token"},write:{target:"token"}}};var or=n(91179);let k=class extends((0,Ee.J)(U.wq)){constructor(e){super(e),this.doNotLocateOnRestrictedElements=null,this.geometry=null,this.geometryType=null,this.name=null,this.spatialRelationship=null,this.type="layer",this.where=null}};(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],k.prototype,"doNotLocateOnRestrictedElements",void 0),(0,t._)([(0,i.Cb)({types:se.qM,json:{read:or.im,write:!0}})],k.prototype,"geometry",void 0),(0,t._)([(0,O.J)(R.KA)],k.prototype,"geometryType",void 0),(0,t._)([(0,i.Cb)({type:String,json:{name:"layerName",write:!0}})],k.prototype,"name",void 0),(0,t._)([(0,O.J)(R.S7,{name:"spatialRel"})],k.prototype,"spatialRelationship",void 0),(0,t._)([(0,i.Cb)({type:String,json:{write:!0}})],k.prototype,"type",void 0),(0,t._)([(0,i.Cb)({type:String,json:{write:!0}})],k.prototype,"where",void 0),k=(0,t._)([(0,j.j)("esri.rest.support.DataLayer")],k);const ir=k;var xe;let Ne=xe=class extends $.default{constructor(e){super(e),this.doNotLocateOnRestrictedElements=null}clone(){return new xe({doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements,...this.cloneProperties()})}};(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],Ne.prototype,"doNotLocateOnRestrictedElements",void 0),Ne=xe=(0,t._)([(0,j.j)("esri.rest.support.NetworkFeatureSet")],Ne);const sr=Ne;let ge=class extends((0,Ee.J)(U.wq)){constructor(e){super(e),this.doNotLocateOnRestrictedElements=null,this.url=null}};(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],ge.prototype,"doNotLocateOnRestrictedElements",void 0),(0,t._)([(0,i.Cb)({type:String,json:{write:!0}})],ge.prototype,"url",void 0),ge=(0,t._)([(0,j.j)("esri.rest.support.NetworkUrl")],ge);const nr=ge;var Ue;function Re(e,r,o){(0,a.pC)(e)&&(r[o]=P.Z.isCollection(e)?{features:e.toArray().map(s=>s.toJSON())}:e.toJSON())}let u=Ue=class extends((0,Ee.J)(U.wq)){constructor(e){super(e),this.accumulateAttributes=null,this.apiKey=null,this.attributeParameterValues=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsOutputType=null,this.directionsStyleName=null,this.directionsTimeAttribute=null,this.findBestSequence=null,this.geometryPrecision=null,this.geometryPrecisionM=null,this.geometryPrecisionZ=null,this.ignoreInvalidLocations=null,this.impedanceAttribute=null,this.outputGeometryPrecision=null,this.outputGeometryPrecisionUnits=null,this.outputLines="true-shape",this.outSpatialReference=null,this.overrides=null,this.pointBarriers=null,this.polygonBarriers=null,this.polylineBarriers=null,this.preserveFirstStop=null,this.preserveLastStop=null,this.preserveObjectID=null,this.restrictionAttributes=null,this.restrictUTurns=null,this.returnBarriers=!1,this.returnDirections=!1,this.returnPolygonBarriers=!1,this.returnPolylineBarriers=!1,this.returnRoutes=!0,this.returnStops=!1,this.returnTraversedEdges=null,this.returnTraversedJunctions=null,this.returnTraversedTurns=null,this.returnZ=!0,this.startTime=null,this.startTimeIsUTC=!0,this.stops=null,this.timeWindowsAreUTC=null,this.travelMode=null,this.useHierarchy=null,this.useTimeWindows=null}static from(e){return(0,Tt.TJ)(Ue,e)}readAccumulateAttributes(e){return(0,a.Wi)(e)?null:e.map(r=>R.Ul.fromJSON(r))}writeAccumulateAttributes(e,r,o){!(0,a.Wi)(e)&&e.length&&(r[o]=e.map(s=>R.Ul.toJSON(s)))}writePointBarriers(e,r,o){Re(e,r,o)}writePolygonBarrier(e,r,o){Re(e,r,o)}writePolylineBarrier(e,r,o){Re(e,r,o)}readRestrictionAttributes(e){return(0,a.Wi)(e)?null:e.map(r=>R.kL.fromJSON(r))}writeRestrictionAttributes(e,r,o){!(0,a.Wi)(e)&&e.length&&(r[o]=e.map(s=>R.kL.toJSON(s)))}readStartTime(e,r){const{startTime:o}=r;return(0,a.Wi)(o)?null:"now"===o?"now":new Date(o)}writeStartTime(e,r){(0,a.Wi)(e)||(r.startTime="now"===e?"now":e.getTime())}readStops(e,r){return function yr(e){return function lr(e){return e&&"type"in e}(e)?ir.fromJSON(e):function pr(e){return e&&"url"in e}(e)?nr.fromJSON(e):function ar(e){return e&&"features"in e&&"doNotLocateOnRestrictedElements"in e}(e)?sr.fromJSON(e):function ur(e){return e&&"features"in e}(e)?$.default.fromJSON(e):null}(r.stops)}writeStops(e,r,o){Re(e,r,o)}};(0,t._)([(0,i.Cb)({type:[String],json:{name:"accumulateAttributeNames",write:!0}})],u.prototype,"accumulateAttributes",void 0),(0,t._)([(0,L.r)("accumulateAttributes")],u.prototype,"readAccumulateAttributes",null),(0,t._)([(0,X.c)("accumulateAttributes")],u.prototype,"writeAccumulateAttributes",null),(0,t._)([(0,i.Cb)(rr)],u.prototype,"apiKey",void 0),(0,t._)([(0,i.Cb)({json:{write:!0}})],u.prototype,"attributeParameterValues",void 0),(0,t._)([(0,i.Cb)({type:String,json:{write:!0}})],u.prototype,"directionsLanguage",void 0),(0,t._)([(0,O.J)(R.GX)],u.prototype,"directionsLengthUnits",void 0),(0,t._)([(0,O.J)(R.$7)],u.prototype,"directionsOutputType",void 0),(0,t._)([(0,O.J)(R.WP)],u.prototype,"directionsStyleName",void 0),(0,t._)([(0,O.J)(R.ZI,{name:"directionsTimeAttributeName",ignoreUnknown:!1})],u.prototype,"directionsTimeAttribute",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"findBestSequence",void 0),(0,t._)([(0,i.Cb)({type:Number,json:{write:!0}})],u.prototype,"geometryPrecision",void 0),(0,t._)([(0,i.Cb)({type:Number,json:{write:!0}})],u.prototype,"geometryPrecisionM",void 0),(0,t._)([(0,i.Cb)({type:Number,json:{write:!0}})],u.prototype,"geometryPrecisionZ",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"ignoreInvalidLocations",void 0),(0,t._)([(0,O.J)(R.Ul,{name:"impedanceAttributeName",ignoreUnknown:!1})],u.prototype,"impedanceAttribute",void 0),(0,t._)([(0,i.Cb)({type:Number,json:{write:!0}})],u.prototype,"outputGeometryPrecision",void 0),(0,t._)([(0,O.J)(R.q$)],u.prototype,"outputGeometryPrecisionUnits",void 0),(0,t._)([(0,O.J)(R.no)],u.prototype,"outputLines",void 0),(0,t._)([(0,i.Cb)({type:q.Z,json:{name:"outSR",write:!0}})],u.prototype,"outSpatialReference",void 0),(0,t._)([(0,i.Cb)({json:{write:!0}})],u.prototype,"overrides",void 0),(0,t._)([(0,i.Cb)({json:{name:"barriers",write:!0}})],u.prototype,"pointBarriers",void 0),(0,t._)([(0,X.c)("pointBarriers")],u.prototype,"writePointBarriers",null),(0,t._)([(0,i.Cb)({json:{write:!0}})],u.prototype,"polygonBarriers",void 0),(0,t._)([(0,X.c)("polygonBarriers")],u.prototype,"writePolygonBarrier",null),(0,t._)([(0,i.Cb)({json:{write:!0}})],u.prototype,"polylineBarriers",void 0),(0,t._)([(0,X.c)("polylineBarriers")],u.prototype,"writePolylineBarrier",null),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"preserveFirstStop",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"preserveLastStop",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"preserveObjectID",void 0),(0,t._)([(0,i.Cb)({type:[String],json:{name:"restrictionAttributeNames",write:!0}})],u.prototype,"restrictionAttributes",void 0),(0,t._)([(0,L.r)("restrictionAttributes")],u.prototype,"readRestrictionAttributes",null),(0,t._)([(0,X.c)("restrictionAttributes")],u.prototype,"writeRestrictionAttributes",null),(0,t._)([(0,O.J)(R.ip)],u.prototype,"restrictUTurns",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"returnBarriers",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"returnDirections",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"returnPolygonBarriers",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"returnPolylineBarriers",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"returnRoutes",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"returnStops",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"returnTraversedEdges",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"returnTraversedJunctions",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"returnTraversedTurns",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"returnZ",void 0),(0,t._)([(0,i.Cb)({type:Date,json:{type:Number,write:!0}})],u.prototype,"startTime",void 0),(0,t._)([(0,L.r)("startTime")],u.prototype,"readStartTime",null),(0,t._)([(0,X.c)("startTime")],u.prototype,"writeStartTime",null),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"startTimeIsUTC",void 0),(0,t._)([(0,i.Cb)({json:{write:!0}})],u.prototype,"stops",void 0),(0,t._)([(0,L.r)("stops")],u.prototype,"readStops",null),(0,t._)([(0,X.c)("stops")],u.prototype,"writeStops",null),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"timeWindowsAreUTC",void 0),(0,t._)([(0,i.Cb)({type:tt.Z,json:{write:!0}})],u.prototype,"travelMode",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"useHierarchy",void 0),(0,t._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],u.prototype,"useTimeWindows",void 0),u=Ue=(0,t._)([(0,j.j)("esri.rest.support.RouteParameters")],u);const pt=u;var cr=n(47521),de=n(69583),dr=n(72854);function Fe(e){return e.length?e:null}function ut(e){const{defaultTravelMode:r,supportedTravelModes:o}=e;return o?.find(({id:s})=>s===r)}function We(e){switch(e){case"esriGeometryPoint":return{type:"esriSMS",style:"esriSMSCircle",size:12,color:[0,0,0,0],outline:We("esriGeometryPolyline")};case"esriGeometryPolyline":return{type:"esriSLS",style:"esriSLSSolid",width:1,color:[0,0,0,0]};case"esriGeometryPolygon":return{type:"esriSFS",style:"esriSFSNull",outline:We("esriGeometryPolyline")}}}function Ze(e){return"layers"in e}function yt(e){return Ge.apply(this,arguments)}function Ge(){return(Ge=(0,M.Z)(function*(e){const r=q.Z.WGS84;return yield(0,He.iQ)(e.spatialReference,r),(0,He.iV)(e,r)})).apply(this,arguments)}function ne(e,r){switch(r){case"seconds":return e/60;case"hours":return 60*e;case"days":return 60*e*24;default:return e}}function _e(e,r){return"decimal-degrees"===r||"points"===r||"unknown"===r?e:(0,Bt.En)(e,r,"meters")}const gr=P.Z.ofType(he.Z),br=P.Z.ofType(ve.Z),ct=P.Z.ofType(ue.Z),dt=P.Z.ofType(ye.Z),mt=P.Z.ofType(ce.Z),ft=P.Z.ofType(de.Z),ht="esri.layers.RouteLayer",vt=ke.Z.getLogger(ht);let w=class extends((0,Zt.h)((0,At.M)((0,Pt.q)((0,Lt.I)((0,St.R)((0,bt.p)(Rt.Z))))))){constructor(e){super(e),this._cachedServiceDescription=null,this._featureCollection=null,this._type="Feature Collection",this.defaultSymbols=new et,this.directionLines=null,this.directionPoints=null,this.featureCollectionType="route",this.legendEnabled=!1,this.maxScale=0,this.minScale=0,this.pointBarriers=new ct,this.polygonBarriers=new dt,this.polylineBarriers=new mt,this.routeInfo=null,this.spatialReference=q.Z.WGS84,this.stops=new ft,this.type="route";const r=()=>{this._setStopSymbol(this.stops)};this.addHandles((0,Ct.on)(()=>this.stops,"change",r,{sync:!0,onListenerAdd:r}))}writeFeatureCollectionWebmap(e,r,o,s){const l=[this._writePolygonBarriers(),this._writePolylineBarriers(),this._writePointBarriers(),this._writeRouteInfo(),this._writeDirectionLines(),this._writeDirectionPoints(),this._writeStops()].filter(m=>!!m),y=l.map((m,h)=>h);(0,Qe.RB)("web-map"===s.origin?"featureCollection.layers":"layers",l,r),r.opacity=this.opacity,r.visibility=this.visible,r.visibleLayers=y}readDirectionLines(e,r){return this._getNetworkFeatures(r,"DirectionLines",o=>he.Z.fromGraphic(o))}readDirectionPoints(e,r){return this._getNetworkFeatures(r,"DirectionPoints",o=>ve.Z.fromGraphic(o))}get fullExtent(){const e=new Xe.Z({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:q.Z.WGS84});if((0,a.pC)(this.routeInfo)&&(0,a.pC)(this.routeInfo.geometry))return this.routeInfo.geometry.extent??e;if((0,a.Wi)(this.stops))return e;const r=this.stops.filter(l=>(0,a.pC)(l.geometry));if(r.length<2)return e;const{spatialReference:o}=r.getItemAt(0).geometry;if((0,a.Wi)(o))return e;const s=r.toArray().map(l=>{const y=l.geometry;return[y.x,y.y]});return new dr.Z({points:s,spatialReference:o}).extent}readMaxScale(e,r){return(Ze(r)?r.layers:r.featureCollection.layers).find(o=>(0,a.pC)(o.layerDefinition.maxScale))?.layerDefinition.maxScale??0}readMinScale(e,r){return(Ze(r)?r.layers:r.featureCollection.layers).find(o=>(0,a.pC)(o.layerDefinition.minScale))?.layerDefinition.minScale??0}readPointBarriers(e,r){return this._getNetworkFeatures(r,"Barriers",o=>ue.Z.fromGraphic(o))}readPolygonBarriers(e,r){return this._getNetworkFeatures(r,"PolygonBarriers",o=>ye.Z.fromGraphic(o))}readPolylineBarriers(e,r){return this._getNetworkFeatures(r,"PolylineBarriers",o=>ce.Z.fromGraphic(o))}readRouteInfo(e,r){const o=this._getNetworkFeatures(r,"RouteInfo",s=>Te.Z.fromGraphic(s));return o.length>0?o.getItemAt(0):null}readSpatialReference(e,r){const o=Ze(r)?r.layers:r.featureCollection.layers;if(!o.length)return q.Z.WGS84;const{layerDefinition:s,featureSet:l}=o[0],d=(0,a.Wg)(l.features[0]?.geometry)?.spatialReference??l.spatialReference??s.spatialReference??s.extent.spatialReference??Ye.Zn;return q.Z.fromJSON(d)}readStops(e,r){return this._getNetworkFeatures(r,"Stops",o=>de.Z.fromGraphic(o),o=>this._setStopSymbol(o))}get title(){return(0,a.pC)(this.routeInfo)&&(0,a.pC)(this.routeInfo.name)?this.routeInfo.name:"Route"}set title(e){this._overrideIfSome("title",e)}get url(){return re.Z.routeServiceUrl}set url(e){this._set("url",null!=e?(0,It.Nm)(e,vt):re.Z.routeServiceUrl)}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},e)),Promise.resolve(this)}removeAll(){this.removeResult(),this.pointBarriers.removeAll(),this.polygonBarriers.removeAll(),this.polylineBarriers.removeAll(),this.stops.removeAll()}removeResult(){(0,a.pC)(this.directionLines)&&(this.directionLines.removeAll(),this._set("directionLines",null)),(0,a.pC)(this.directionPoints)&&(this.directionPoints.removeAll(),this._set("directionPoints",null)),(0,a.pC)(this.routeInfo)&&this._set("routeInfo",null)}save(){var e=this;return(0,M.Z)(function*(){yield e.load();const{fullExtent:r,portalItem:o}=e;if(!o)throw new W.Z("routelayer:portal-item-not-set","save() requires to the layer to have a portal item");if(!o.id)throw new W.Z("routelayer:portal-item-not-saved","Please use saveAs() first to save the routelayer");if("Feature Collection"!==o.type)throw new W.Z("routelayer:portal-item-wrong-type",'Portal item needs to have type "Feature Collection"');if((0,a.Wi)(e.routeInfo))throw new W.Z("routelayer:route-unsolved","save() requires a solved route");const{portal:s}=o;yield s._signIn(),s.user||(yield o.reload());const{itemUrl:l,itemControl:y}=o;if("admin"!==y&&"update"!==y)throw new W.Z("routelayer:insufficient-permissions","To save this layer, you need to be the owner or an administrator of your organization");const d={messages:[],origin:"portal-item",portal:s,url:l&&(0,Se.mN)(l),writtenProperties:[]},m=e.write(null,d);return o.extent=yield yt(r),o.title=e.title,yield o.update({data:m}),o})()}saveAs(e,r={}){var o=this;return(0,M.Z)(function*(){if(yield o.load(),(0,a.Wi)(o.routeInfo))throw new W.Z("routelayer:route-unsolved","saveAs() requires a solved route");const s=Ot.default.from(e).clone();s.extent??(s.extent=yield yt(o.fullExtent)),s.id=null,s.portal??(s.portal=Dt.Z.getDefault()),s.title??(s.title=o.title),s.type="Feature Collection",s.typeKeywords=["Data","Feature Collection",Mt.Kz.MULTI_LAYER,"Route Layer"];const{portal:l}=s,y={messages:[],origin:"portal-item",portal:l,url:null,writtenProperties:[]};yield l._signIn();const d=r?.folder,m=o.write(null,y);return yield l.user.addItem({item:s,folder:d,data:m}),o.portalItem=s,(0,Nt.D)(y),y.portalItem=s,s})()}solve(e,r){var o=this;return(0,M.Z)(function*(){const s=e?.stops??o.stops,l=e?.pointBarriers??Fe(o.pointBarriers),y=e?.polylineBarriers??Fe(o.polylineBarriers),d=e?.polygonBarriers??Fe(o.polygonBarriers);if((0,a.Wi)(s))throw new W.Z("routelayer:undefined-stops","the route layer must have stops defined in the route parameters.");if((function mr(e){return"esri.rest.support.FeatureSet"===e.declaredClass}(s)||function fr(e){return"esri.rest.support.NetworkFeatureSet"===e.declaredClass}(s))&&s.features.length<2||P.Z.isCollection(s)&&s.length<2)throw new W.Z("routelayer:insufficent-stops","the route layer must have two or more stops to solve a route.");if(P.Z.isCollection(s))for(const v of s)v.routeName=null;const m=e?.apiKey,h=o.url,b=yield o._getServiceDescription(h,m,r),c=ut(b),T=e?.travelMode??c,Z=(0,a.yl)(e?.accumulateAttributes,[]);(0,a.pC)(T)&&(Z.push(T.distanceAttributeName),T.timeAttributeName&&Z.push(T.timeAttributeName));const C={startTime:new Date},g={accumulateAttributes:Z,directionsOutputType:"featuresets",ignoreInvalidLocations:!0,pointBarriers:l,polylineBarriers:y,polygonBarriers:d,preserveFirstStop:!0,preserveLastStop:!0,returnBarriers:!!l,returnDirections:!0,returnPolygonBarriers:!!d,returnPolylineBarriers:!!y,returnRoutes:!0,returnStops:!0,stops:s},S=e?pt.from(e):new pt;for(const v in C)null==S[v]&&(S[v]=C[v]);let N;S.set(g);try{N=yield function er(e,r,o){return Je.apply(this,arguments)}(h,S,r)}catch(v){throw(0,wt.D_)(v)?v:new W.Z("routelayer:failed-route-request","the routing request failed",{error:v})}const p=o._toRouteLayerSolution(N);return o._isOverridden("title")||(o.title=(0,a.yl)(p.routeInfo.name,"Route")),function hr(e,r,o){const s=r.networkDataset?.networkAttributes,l=s?.filter(f=>"cost"===f.usageType)??[],y=ut(r),d=o.travelMode??y;if((0,a.Wi)(d))return void vt.warn("route-layer:missing-travel-mode","The routing service must have a default travel mode or one must be specified in the route parameter.");const{timeAttributeName:m,distanceAttributeName:h}=d,b=l.find(f=>f.name===m),c=l.find(f=>f.name===h),T=(0,a.Wg)(o.travelMode)?.impedanceAttributeName??(0,a.Wg)(o.impedanceAttribute)??r.impedance,Z=R.hB.fromJSON(b?.units),C=R.GX.fromJSON(c?.units);if(!Z||!C)throw new W.Z("routelayer:unknown-impedance-units","the units of either the distance or time impedance are unknown");const g=o.directionsLanguage??r.directionsLanguage,S=(0,a.Wg)(o.accumulateAttributes)??r.accumulateAttributeNames??[],N=new Set(l.filter(({name:f})=>f===m||f===h||f===T||null!=f&&S.includes(f)).map(({name:f})=>f)),p=f=>{for(const gt in f)N.has(gt)||delete f[gt]};for(const f of e.pointBarriers)(0,a.pC)(f.costs)&&(f.addedCost=f.costs[T]??0,p(f.costs));for(const f of e.polygonBarriers)(0,a.pC)(f.costs)&&(f.scaleFactor=f.costs[T]??1,p(f.costs));for(const f of e.polylineBarriers)(0,a.pC)(f.costs)&&(f.scaleFactor=f.costs[T]??1,p(f.costs));const{routeInfo:v}=e,{findBestSequence:B,preserveFirstStop:A,preserveLastStop:ee,startTimeIsUTC:wr,timeWindowsAreUTC:Cr}=o;v.analysisSettings=new cr.Z({accumulateAttributes:S,directionsLanguage:g,findBestSequence:B,preserveFirstStop:A,preserveLastStop:ee,startTimeIsUTC:wr,timeWindowsAreUTC:Cr,travelMode:d}),v.totalDuration=ne(v.totalCosts[m]??0,Z),v.totalDistance=_e(v.totalCosts[h]??0,C),v.totalLateDuration=ne(v.totalViolations[m]??0,Z),v.totalWaitDuration=ne(v.totalWait[m]??0,Z),(0,a.pC)(v.totalCosts)&&p(v.totalCosts),(0,a.pC)(v.totalViolations)&&p(v.totalViolations),(0,a.pC)(v.totalWait)&&p(v.totalWait);for(const f of e.stops)(0,a.pC)(f.serviceCosts)&&(f.serviceDuration=ne(f.serviceCosts[m]??0,Z),f.serviceDistance=_e(f.serviceCosts[h]??0,C),p(f.serviceCosts)),(0,a.pC)(f.cumulativeCosts)&&(f.cumulativeDuration=ne(f.cumulativeCosts[m]??0,Z),f.cumulativeDistance=_e(f.cumulativeCosts[h]??0,C),p(f.cumulativeCosts)),(0,a.pC)(f.violations)&&(f.lateDuration=ne(f.violations[m]??0,Z),p(f.violations)),(0,a.pC)(f.wait)&&(f.waitDuration=ne(f.wait[m]??0,Z),p(f.wait))}(p,b,S),p})()}update(e){const{stops:r,directionLines:o,directionPoints:s,pointBarriers:l,polylineBarriers:y,polygonBarriers:d,routeInfo:m}=e;this.set({stops:r,pointBarriers:l,polylineBarriers:y,polygonBarriers:d}),this._set("directionLines",o),this._set("directionPoints",s),this._set("routeInfo",m),(0,a.pC)(m.geometry)&&(this.spatialReference=m.geometry.spatialReference)}_getNetworkFeatures(e,r,o,s){const l=(Ze(e)?e.layers:e.featureCollection.layers).find(g=>g.layerDefinition.name===r);if((0,a.Wi)(l))return new P.Z;const{layerDefinition:y,popupInfo:d,featureSet:m}=l,h=y.drawingInfo.renderer,{features:b}=m,c=m.spatialReference??y.spatialReference??y.extent.spatialReference??Ye.Zn,T=h&&(0,I.a)(h),Z=q.Z.fromJSON(c),C=b.map(g=>{const S=F.Z.fromJSON(g);(0,a.pC)(S.geometry)&&(0,a.pC)(g.geometry)&&(0,a.Wi)(g.geometry.spatialReference)&&(S.geometry.spatialReference=Z);const N=o(S);return N.symbol??(N.symbol=T?.getSymbol(S)??this._getNetworkSymbol(r)),N.popupTemplate??(N.popupTemplate=d&&Q.Z.fromJSON(d)),N});return s&&C.some(g=>!g.symbol)&&s(C),new P.Z(C)}_getNetworkSymbol(e){switch(e){case"Barriers":return this.defaultSymbols.pointBarriers;case"DirectionPoints":return this.defaultSymbols.directionPoints;case"DirectionLines":return this.defaultSymbols.directionLines;case"PolylineBarriers":return this.defaultSymbols.polylineBarriers;case"PolygonBarriers":return this.defaultSymbols.polygonBarriers;case"RouteInfo":return this.defaultSymbols.routeInfo;case"Stops":return null}}_getServiceDescription(e,r,o){var s=this;return(0,M.Z)(function*(){if((0,a.pC)(s._cachedServiceDescription)&&s._cachedServiceDescription.url===e)return s._cachedServiceDescription.serviceDescription;const l=yield rt(e,r,o);return s._cachedServiceDescription={serviceDescription:l,url:e},l})()}_setStopSymbol(e){if(!e||0===e.length||(0,a.Wi)(this.defaultSymbols.stops)||e.every(c=>(0,a.pC)(c.symbol)))return;const{first:r,last:o,middle:s,unlocated:l,waypoint:y,break:d}=this.defaultSymbols.stops;if((0,a.Wi)(this.routeInfo)||1===e.length)return void e.forEach((c,T)=>{switch(T){case 0:c.symbol=r;break;case e.length-1:c.symbol=o;break;default:c.symbol=s}});const m=e.map(c=>c.sequence).filter(c=>(0,a.pC)(c)),h=Math.min(...m),b=Math.max(...m);for(const c of e)c.symbol=c.sequence!==h?c.sequence!==b?"ok"===c.status||"not-located-on-closest"===c.status?"waypoint"!==c.locationType?"break"!==c.locationType?s:d:y:l:o:r}_toRouteLayerSolution(e){const r=e.routeResults[0].stops.map(h=>de.Z.fromJSON(h.toJSON()));this._setStopSymbol(r);const o=new ft(r),s=new dt(e.polygonBarriers?.map(h=>{const b=ye.Z.fromJSON(h.toJSON());return b.symbol=this.defaultSymbols.polygonBarriers,b})),l=new mt(e.polylineBarriers?.map(h=>{const b=ce.Z.fromJSON(h.toJSON());return b.symbol=this.defaultSymbols.polylineBarriers,b})),y=new ct(e.pointBarriers?.map(h=>{const b=ue.Z.fromJSON(h.toJSON());return b.symbol=this.defaultSymbols.pointBarriers,b})),d=Te.Z.fromJSON(e.routeResults[0].route.toJSON());d.symbol=this.defaultSymbols.routeInfo;const m=new br(e.routeResults[0].directionPoints?.features.map(h=>{const b=ve.Z.fromJSON(h.toJSON());return b.symbol=this.defaultSymbols.directionPoints,b}));return{directionLines:new gr(e.routeResults[0].directionLines?.features.map(h=>{const b=he.Z.fromJSON(h.toJSON());return b.symbol=this.defaultSymbols.directionLines,b})),directionPoints:m,pointBarriers:y,polygonBarriers:s,polylineBarriers:l,routeInfo:d,stops:o}}_writeDirectionLines(){return this._writeNetworkFeatures(this.directionLines,this.defaultSymbols.directionLines,"esriGeometryPolyline",he.Z.fields,he.Z.popupInfo,"DirectionLines","Direction Lines")}_writeDirectionPoints(){return this._writeNetworkFeatures(this.directionPoints,this.defaultSymbols.directionPoints,"esriGeometryPoint",ve.Z.fields,ve.Z.popupInfo,"DirectionPoints","Direction Points")}_writeNetworkFeatures(e,r,o,s,l,y,d){if((0,a.Wi)(e)||!e.length)return null;const m=this.spatialReference.toJSON(),{fullExtent:h,maxScale:b,minScale:c}=this;return{featureSet:{features:e.toArray().map(T=>function vr(e){const{attributes:r,geometry:o,popupTemplate:s,symbol:l}=e.toGraphic().toJSON();return{attributes:r,geometry:o,popupInfo:s,symbol:l}}(T)),geometryType:o,spatialReference:m},layerDefinition:{capabilities:"Query,Update,Editing",drawingInfo:{renderer:{type:"simple",symbol:(0,a.pC)(r)?r.toJSON():We(o)}},extent:h.toJSON(),fields:s,geometryType:o,hasM:!1,hasZ:!1,maxScale:b,minScale:c,name:y,objectIdField:"ObjectID",spatialReference:m,title:d,type:"Feature Layer",typeIdField:""},popupInfo:l}}_writePointBarriers(){return this._writeNetworkFeatures(this.pointBarriers,this.defaultSymbols.pointBarriers,"esriGeometryPoint",ue.Z.fields,ue.Z.popupInfo,"Barriers","Point Barriers")}_writePolygonBarriers(){return this._writeNetworkFeatures(this.polygonBarriers,this.defaultSymbols.polygonBarriers,"esriGeometryPolygon",ye.Z.fields,ye.Z.popupInfo,"PolygonBarriers","Polygon Barriers")}_writePolylineBarriers(){return this._writeNetworkFeatures(this.polylineBarriers,this.defaultSymbols.polylineBarriers,"esriGeometryPolyline",ce.Z.fields,ce.Z.popupInfo,"PolylineBarriers","Line Barriers")}_writeRouteInfo(){return this._writeNetworkFeatures((0,a.pC)(this.routeInfo)?new P.Z([this.routeInfo]):null,this.defaultSymbols.routeInfo,"esriGeometryPolyline",Te.Z.fields,Te.Z.popupInfo,"RouteInfo","Route Details")}_writeStops(){const e=this._writeNetworkFeatures(this.stops,null,"esriGeometryPoint",de.Z.fields,de.Z.popupInfo,"Stops","Stops");if((0,a.Wi)(e))return null;const{stops:r}=this.defaultSymbols,o=(0,a.pC)(r)&&(0,a.pC)(r.first)&&r.first.toJSON(),s=(0,a.pC)(r)&&(0,a.pC)(r.middle)&&r.middle.toJSON(),l=(0,a.pC)(r)&&(0,a.pC)(r.last)&&r.last.toJSON();return e.layerDefinition.drawingInfo.renderer={type:"uniqueValue",field1:"Sequence",defaultSymbol:s,uniqueValueInfos:[{value:"1",symbol:o,label:"First Stop"},{value:`${this.stops.length}`,symbol:l,label:"Last Stop"}]},e}};(0,t._)([(0,i.Cb)({readOnly:!0,json:{read:!1,origins:{"portal-item":{write:{allowNull:!0,ignoreOrigin:!0}},"web-map":{write:{overridePolicy(){return{allowNull:!0,ignoreOrigin:null==this.portalItem}}}}}}})],w.prototype,"_featureCollection",void 0),(0,t._)([(0,X.c)(["web-map","portal-item"],"_featureCollection")],w.prototype,"writeFeatureCollectionWebmap",null),(0,t._)([(0,i.Cb)({readOnly:!0,json:{read:!1,origins:{"web-map":{write:{target:"type",overridePolicy(){return{ignoreOrigin:null!=this.portalItem}}}}}}})],w.prototype,"_type",void 0),(0,t._)([(0,i.Cb)({nonNullable:!0,type:et})],w.prototype,"defaultSymbols",void 0),(0,t._)([(0,i.Cb)({readOnly:!0})],w.prototype,"directionLines",void 0),(0,t._)([(0,L.r)(["web-map","portal-item"],"directionLines",["layers","featureCollection.layers"])],w.prototype,"readDirectionLines",null),(0,t._)([(0,i.Cb)({readOnly:!0})],w.prototype,"directionPoints",void 0),(0,t._)([(0,L.r)(["web-map","portal-item"],"directionPoints",["layers","featureCollection.layers"])],w.prototype,"readDirectionPoints",null),(0,t._)([(0,i.Cb)({readOnly:!0,json:{read:!1,origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],w.prototype,"featureCollectionType",void 0),(0,t._)([(0,i.Cb)({readOnly:!0})],w.prototype,"fullExtent",null),(0,t._)([(0,i.Cb)({json:{origins:{"web-map":{name:"featureCollection.showLegend"}},write:!0}})],w.prototype,"legendEnabled",void 0),(0,t._)([(0,i.Cb)({type:["show","hide"]})],w.prototype,"listMode",void 0),(0,t._)([(0,i.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],w.prototype,"maxScale",void 0),(0,t._)([(0,L.r)(["web-map","portal-item"],"maxScale",["layers","featureCollection.layers"])],w.prototype,"readMaxScale",null),(0,t._)([(0,i.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],w.prototype,"minScale",void 0),(0,t._)([(0,L.r)(["web-map","portal-item"],"minScale",["layers","featureCollection.layers"])],w.prototype,"readMinScale",null),(0,t._)([(0,i.Cb)({type:["ArcGISFeatureLayer"],value:"ArcGISFeatureLayer"})],w.prototype,"operationalLayerType",void 0),(0,t._)([(0,i.Cb)({nonNullable:!0,type:P.Z.ofType(ue.Z)})],w.prototype,"pointBarriers",void 0),(0,t._)([(0,L.r)(["web-map","portal-item"],"pointBarriers",["layers","featureCollection.layers"])],w.prototype,"readPointBarriers",null),(0,t._)([(0,i.Cb)({nonNullable:!0,type:P.Z.ofType(ye.Z)})],w.prototype,"polygonBarriers",void 0),(0,t._)([(0,L.r)(["web-map","portal-item"],"polygonBarriers",["layers","featureCollection.layers"])],w.prototype,"readPolygonBarriers",null),(0,t._)([(0,i.Cb)({nonNullable:!0,type:P.Z.ofType(ce.Z)})],w.prototype,"polylineBarriers",void 0),(0,t._)([(0,L.r)(["web-map","portal-item"],"polylineBarriers",["layers","featureCollection.layers"])],w.prototype,"readPolylineBarriers",null),(0,t._)([(0,i.Cb)({readOnly:!0})],w.prototype,"routeInfo",void 0),(0,t._)([(0,L.r)(["web-map","portal-item"],"routeInfo",["layers","featureCollection.layers"])],w.prototype,"readRouteInfo",null),(0,t._)([(0,i.Cb)({type:q.Z})],w.prototype,"spatialReference",void 0),(0,t._)([(0,L.r)(["web-map","portal-item"],"spatialReference",["layers","featureCollection.layers"])],w.prototype,"readSpatialReference",null),(0,t._)([(0,i.Cb)({nonNullable:!0,type:P.Z.ofType(de.Z)})],w.prototype,"stops",void 0),(0,t._)([(0,L.r)(["web-map","portal-item"],"stops",["layers","featureCollection.layers"])],w.prototype,"readStops",null),(0,t._)([(0,i.Cb)()],w.prototype,"title",null),(0,t._)([(0,i.Cb)({readOnly:!0,json:{read:!1}})],w.prototype,"type",void 0),(0,t._)([(0,i.Cb)()],w.prototype,"url",null),w=(0,t._)([(0,j.j)(ht)],w);const Sr=w},37281:(Pe,te,n)=>{n.d(te,{$o:()=>Ve,Kz:()=>$e,_$:()=>Le,ck:()=>ze,qj:()=>Ke});var M=n(15861),t=n(55915),re=n(65234),se=n(46367);function F(D){return Q.apply(this,arguments)}function Q(){return(Q=(0,M.Z)(function*(D){const J=D.spatialReference;if(J.isWGS84)return D.clone();if(J.isWebMercator)return(0,se.Sx)(D);const I=re.Z.WGS84;return yield(0,t.iQ)(J,I),(0,t.iV)(D,I)})).apply(this,arguments)}function Ke(D,J){if(!Le(D,J)){const I=D.typeKeywords;I?I.push(J):D.typeKeywords=[J]}}function Le(D,J){return!!D.typeKeywords?.includes(J)}function ze(D,J){const I=D.typeKeywords;if(I){const P=I.indexOf(J);P>-1&&I.splice(P,1)}}function Ve(D){return be.apply(this,arguments)}function be(){return(be=(0,M.Z)(function*(D){const J=D.clone().normalize();let I;if(J.length>1)for(const P of J)I?P.width>I.width&&(I=P):I=P;else I=J[0];return F(I)})).apply(this,arguments)}const $e={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table"}}}]);