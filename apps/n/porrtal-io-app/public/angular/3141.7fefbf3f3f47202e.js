/*
Copyright 2022 Comcast Cable Communications Management, LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[3141],{47139:(Ft,Et,L)=>{L.d(Et,{Fp:()=>Nt,RL:()=>nt,UV:()=>V,bk:()=>x});var ut=L(36161),Mt=L(91179),pt=L(31375);function Nt(u){if(!u)return null;switch(u.type){case"CIMPointSymbol":{const g=u.symbolLayers;return g&&1===g.length?Nt(g[0]):null}case"CIMVectorMarker":{const g=u.markerGraphics;if(!g||1!==g.length)return null;const O=g[0];if(!O)return null;const N=O.geometry;if(!N)return null;const k=O.symbol;return!k||"CIMPolygonSymbol"!==k.type&&"CIMLineSymbol"!==k.type||k.symbolLayers?.some(P=>!!P.effects)?null:{geom:N,asFill:"CIMPolygonSymbol"===k.type}}case"sdf":return{geom:u.geom,asFill:u.asFill}}return null}function G(u){let g=1/0,O=-1/0,N=1/0,k=-1/0;for(const P of u)for(const M of P)M[0]<g&&(g=M[0]),M[0]>O&&(O=M[0]),M[1]<N&&(N=M[1]),M[1]>k&&(k=M[1]);return[g,N,O,k]}function x(u){return u?u.rings?G(u.rings):u.paths?G(u.paths):(0,Mt.YX)(u)?[u.xmin,u.ymin,u.xmax,u.ymax]:null:null}function V(u,g,O,N,k){const[P,M,E,Y]=u;if(E<P||Y<M)return[0,0,0];const $=E-P,w=Y-M,T=Math.floor(31.5),z=(128-2*(T+1))/Math.max($,w),B=Math.round($*z)+2*T,rt=Math.round(w*z)+2*T;let lt=1;g&&(lt=rt/z/(g.ymax-g.ymin));let F=0,D=0;return N&&(k?g&&O&&g.ymax-g.ymin>0&&(F=N.x/(O*((g.xmax-g.xmin)/(g.ymax-g.ymin))),D=N.y/O):(F=N.x,D=N.y)),F=.5*(g.xmax+g.xmin)+F*(g.xmax-g.xmin),D=.5*(g.ymax+g.ymin)+D*(g.ymax-g.ymin),F-=P,D-=M,F*=z,D*=z,F+=T,D+=T,[lt,F/B-.5,-(D/rt-.5)]}function nt(u){const g=function kt(u){return u?u.rings?u.rings:u.paths?u.paths:void 0!==u.xmin&&void 0!==u.ymin&&void 0!==u.xmax&&void 0!==u.ymax?[[[u.xmin,u.ymin],[u.xmin,u.ymax],[u.xmax,u.ymax],[u.xmax,u.ymin],[u.xmin,u.ymin]]]:null:null}(u.geom),O=function R(u){let g=1/0,O=-1/0,N=1/0,k=-1/0;for(const P of u)for(const M of P)M[0]<g&&(g=M[0]),M[0]>O&&(O=M[0]),M[1]<N&&(N=M[1]),M[1]>k&&(k=M[1]);return new pt.Z(g,N,O-g,k-N)}(g),P=Math.floor(31.5),M=(128-2*(P+1))/Math.max(O.width,O.height),E=Math.round(O.width*M)+2*P,Y=Math.round(O.height*M)+2*P,$=[];for(const H of g)if(H&&H.length>1){const X=[];for(const T of H){let[z,B]=T;z-=O.x,B-=O.y,z*=M,B*=M,z+=P-.5,B+=P-.5,X.push(u.asFill?[z,B]:[Math.round(z),Math.round(B)])}if(u.asFill){const T=X.length-1;X[0][0]===X[T][0]&&X[0][1]===X[T][1]||X.push(X[0])}$.push(X)}const w=function h(u,g,O,N){const k=g*O,P=new Array(k),M=N*N+1;for(let E=0;E<k;++E)P[E]=M;for(const E of u){const Y=E.length;for(let $=1;$<Y;++$){const w=E[$-1],H=E[$];let X,T,z,B;w[0]<H[0]?(X=w[0],T=H[0]):(X=H[0],T=w[0]),w[1]<H[1]?(z=w[1],B=H[1]):(z=H[1],B=w[1]);let rt=Math.floor(X)-N,lt=Math.floor(T)+N,F=Math.floor(z)-N,D=Math.floor(B)+N;rt<0&&(rt=0),lt>g&&(lt=g),F<0&&(F=0),D>O&&(D=O);const U=H[0]-w[0],xt=H[1]-w[1],At=U*U+xt*xt;for(let ht=rt;ht<lt;ht++)for(let yt=F;yt<D;yt++){let vt,St,Ct=(ht-w[0])*U+(yt-w[1])*xt;Ct<0?(vt=w[0],St=w[1]):Ct>At?(vt=H[0],St=H[1]):(Ct/=At,vt=w[0]+Ct*U,St=w[1]+Ct*xt);const Xt=(ht-vt)*(ht-vt)+(yt-St)*(yt-St),zt=(O-yt-1)*g+ht;Xt<P[zt]&&(P[zt]=Xt)}}}for(let E=0;E<k;++E)P[E]=Math.sqrt(P[E]);return P}($,E,Y,P);return u.asFill&&function Z(u,g,O,N,k){for(const P of u){const M=P.length;for(let E=1;E<M;++E){const Y=P[E-1],$=P[E];let w,H,X,T;Y[0]<$[0]?(w=Y[0],H=$[0]):(w=$[0],H=Y[0]),Y[1]<$[1]?(X=Y[1],T=$[1]):(X=$[1],T=Y[1]);let z=Math.floor(w),B=Math.floor(H)+1,rt=Math.floor(X),lt=Math.floor(T)+1;z<N&&(z=N),B>g-N&&(B=g-N),rt<N&&(rt=N),lt>O-N&&(lt=O-N);for(let F=rt;F<lt;++F){if(Y[1]>F==$[1]>F)continue;const D=(O-F-1)*g;for(let U=z;U<B;++U)U<($[0]-Y[0])*(F-Y[1])/($[1]-Y[1])+Y[0]&&(k[D+U]=-k[D+U]);for(let U=N;U<z;++U)k[D+U]=-k[D+U]}}}}($,E,Y,P,w),[tt(w,P),E,Y]}function tt(u,g){const O=2*g,N=u.length,k=new Uint8Array(4*N);for(let P=0;P<N;++P)(0,ut.I)(.5-u[P]/O,k,4*P);return k}},53141:(Ft,Et,L)=>{L.d(Et,{S:()=>te,c:()=>xt});var ut=L(15861),Mt=L(91558),pt=L(58817),Nt=L(63290),at=L(62208),kt=L(23841),R=L(77275),G=L(46679),x=L(44654),V=L(7547),nt=L(47139),h=L(80991),Z=L(73608),tt=L(39236),u=L(39351);const w=53290320,H=10,X=Nt.Z.getLogger("esri.symbols.cim.cimAnalyzer");function T(t){switch(t){case"Butt":return V.RL.BUTT;case"Square":return V.RL.SQUARE;default:return V.RL.ROUND}}function z(t){switch(t){case"Bevel":return V.AH.BEVEL;case"Miter":return V.AH.MITER;default:return V.AH.ROUND}}function B(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return X.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),"center"}}function rt(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function D(t,i,o,l){let e;t[i]?e=t[i]:(e={},t[i]=e),e[o]=l}function U(t){const i=t.markerPlacement;return i&&i.angleToLine?V.v2.MAP:V.v2.SCREEN}function xt(t,i,o,l,e){return At.apply(this,arguments)}function At(){return(At=(0,ut.Z)(function*(t,i,o,l,e){const a=l??[];if(!t)return a;let s,n;const r={};if("CIMSymbolReference"!==t.type)return X.error("Expect cim type to be 'CIMSymbolReference'"),a;if(s=t.symbol,n=t.primitiveOverrides,n){const f=[];for(const d of n){const m=d.valueExpressionInfo;if(m&&i){const S=(0,G.Yi)(m.expression,i.spatialReference,i.fields).then(C=>{C&&D(r,d.primitiveName,d.propertyName,C)});f.push(S)}else null!=d.value&&D(r,d.primitiveName,d.propertyName,d.value)}f.length>0&&(yield Promise.all(f))}const c=[];switch(Bt(s,o,c),c.length>0&&(yield Promise.all(c)),s.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":ht(s,n,r,i,a,o,e)}return a})).apply(this,arguments)}function ht(t,i,o,l,e,a,s){if(!t)return;const n=t.symbolLayers;if(!n)return;const r=t.effects;let c;const f=x.B$.getSize(t);"CIMPointSymbol"===t.type&&"Map"===t.angleAlignment&&(c=V.v2.MAP);let d=n.length;for(;d--;){const m=n[d];if(!m||!1===m.enable)continue;let p;r&&r.length&&(p=[...r]);const S=m.effects;S&&S.length&&(r?p.push(...S):p=[...S]);const C=[];let v;x.E0.findEffectOverrides(p,i,C),v=C.length>0?Qt(p,C,o,l):p;const b=[];switch(x.E0.findApplicableOverrides(m,i,b),m.type){case"CIMSolidFill":yt(m,v,o,b,l,e);break;case"CIMPictureFill":vt(m,v,o,b,l,a,e);break;case"CIMHatchFill":St(m,v,o,b,l,e);break;case"CIMGradientFill":Ct(m,v,o,b,l,e);break;case"CIMSolidStroke":Xt(m,v,o,b,l,e,"CIMPolygonSymbol"===t.type,f);break;case"CIMPictureStroke":zt(m,v,o,b,l,e,"CIMPolygonSymbol"===t.type,f);break;case"CIMGradientStroke":Wt(m,v,o,b,l,e,"CIMPolygonSymbol"===t.type,f);break;case"CIMCharacterMarker":if(Ht(m,v,o,b,l,e))break;break;case"CIMPictureMarker":if(Ht(m,v,o,b,l,e))break;"CIMLineSymbol"===t.type&&(c=U(m)),jt(m,v,o,b,l,a,e,c,f);break;case"CIMVectorMarker":if(Ht(m,v,o,b,l,e))break;"CIMLineSymbol"===t.type&&(c=U(m)),Gt(m,v,o,b,l,e,a,c,f,s);break;default:X.error("Cannot analyze CIM layer",m.type)}}}function yt(t,i,o,l,e,a){const s=t.primitiveName,n=(0,h.NO)(t.color),[r,c]=ft(l,s,i,null,null),f=(0,R.hP)(JSON.stringify(t)+c).toString();a.push({type:"fill",templateHash:f,materialHash:r?()=>f:f,cim:t,materialOverrides:null,colorLocked:t.colorLocked,color:y(s,o,"Color",e,n,ct),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:i,applyRandomOffset:!1,sampleAlphaOnly:!0})}function vt(t,i,o,l,e,a,s){const n=t.primitiveName,r=t.tintColor?(0,h.NO)(t.tintColor):{r:255,g:255,b:255,a:1},[c,f]=ft(l,n,i,null,null),d=(0,R.hP)(JSON.stringify(t)+f).toString(),m=(0,R.hP)(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString();let p=(0,h.NA)(t.scaleX);if("width"in t){const S=t.width;let C=1;const v=a.getResource(t.url);(0,at.pC)(v)&&(C=v.width/v.height),p/=C*(t.height/S)}s.push({type:"fill",templateHash:d,materialHash:c?()=>m:m,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:i,color:y(n,o,"TintColor",e,r,ct),height:y(n,o,"Height",e,t.height),scaleX:y(n,o,"ScaleX",e,p),angle:y(n,o,"Rotation",e,(0,h.NA)(t.rotation)),offsetX:y(n,o,"OffsetX",e,(0,h.NA)(t.offsetX)),offsetY:y(n,o,"OffsetY",e,(0,h.NA)(t.offsetY)),url:t.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function St(t,i,o,l,e,a){const s=["Rotation","OffsetX","OffsetY"],n=l.filter(S=>S.primitiveName!==t.primitiveName&&!s.includes(S.propertyName)),r=t.primitiveName,[c,f]=ft(l,r,i,null,null),d=(0,R.hP)(JSON.stringify(t)+f).toString(),m=(0,R.hP)(`${t.separation}${JSON.stringify(t.lineSymbol)}`).toString();let p={r:255,g:255,b:255,a:1};if(t.lineSymbol){const S=t.lineSymbol?.symbolLayers.find(C=>"CIMSolidStroke"===C.type);S&&(p=(0,h.NO)(S.color))}a.push({type:"fill",templateHash:d,materialHash:c?wt(m,o,n,e):m,cim:t,materialOverrides:n,colorLocked:t.colorLocked,effects:i,color:p,height:y(r,o,"Separation",e,t.separation),scaleX:1,angle:y(r,o,"Rotation",e,(0,h.NA)(t.rotation)),offsetX:y(r,o,"OffsetX",e,(0,h.NA)(t.offsetX)),offsetY:y(r,o,"OffsetY",e,(0,h.NA)(t.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0})}function Ct(t,i,o,l,e,a){const s=t.primitiveName,[n,r]=ft(l,s,i,null,null),c=(0,R.hP)(JSON.stringify(t)+r).toString();a.push({type:"fill",templateHash:c,materialHash:n?wt(c,o,l,e):c,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:i,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1})}function Xt(t,i,o,l,e,a,s,n){const r=t.primitiveName,c=(0,h.NO)(t.color),f=void 0!==t.width?t.width:4,d=T(t.capStyle),m=z(t.joinStyle),p=t.miterLimit,[S,C]=ft(l,r,i,null,null),v=(0,R.hP)(JSON.stringify(t)+C).toString();let b,A;if(i&&i instanceof Array&&i.length>0){const W=i[i.length-1];if("CIMGeometricEffectDashes"===W.type&&"NoConstraint"===W.lineDashEnding&&null===W.offsetAlongLine){const I=(i=[...i]).pop();b=I.dashTemplate,A=I.scaleDash}}a.push({type:"line",templateHash:v,materialHash:S?()=>v:v,cim:t,materialOverrides:null,isOutline:s,colorLocked:t.colorLocked,effects:i,color:y(r,o,"Color",e,c,ct),width:y(r,o,"Width",e,f),cap:y(r,o,"CapStyle",e,d),join:y(r,o,"JoinStyle",e,m),miterLimit:y(r,o,"MiterLimit",e,p),referenceWidth:n,zOrder:Jt(t.name),dashTemplate:b,scaleDash:A,sampleAlphaOnly:!0})}function zt(t,i,o,l,e,a,s,n){const r=(0,R.hP)(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString(),c=t.primitiveName,f=(0,h.NO)(t.tintColor),d=void 0!==t.width?t.width:4,m=T(t.capStyle),p=z(t.joinStyle),S=t.miterLimit,[C,v]=ft(l,c,i,null,null),b=(0,R.hP)(JSON.stringify(t)+v).toString();a.push({type:"line",templateHash:b,materialHash:C?()=>r:r,cim:t,materialOverrides:null,isOutline:s,colorLocked:t.colorLocked,effects:i,color:y(c,o,"TintColor",e,f,ct),width:y(c,o,"Width",e,d),cap:y(c,o,"CapStyle",e,m),join:y(c,o,"JoinStyle",e,p),miterLimit:y(c,o,"MiterLimit",e,S),referenceWidth:n,zOrder:Jt(t.name),dashTemplate:null,scaleDash:!1,url:t.url,sampleAlphaOnly:!1})}function Wt(t,i,o,l,e,a,s,n){const r=t.primitiveName,c=void 0!==t.width?t.width:4,f=T(t.capStyle),d=z(t.joinStyle),m=t.miterLimit,[p,S]=ft(l,r,i,null,null),C=(0,R.hP)(JSON.stringify(t)+S).toString();a.push({type:"line",templateHash:C,materialHash:p?wt(C,o,l,e):C,cim:t,materialOverrides:null,isOutline:s,colorLocked:t.colorLocked,effects:i,color:{r:128,g:128,b:128,a:1},width:y(r,o,"Width",e,c),cap:y(r,o,"CapStyle",e,f),join:y(r,o,"JoinStyle",e,d),miterLimit:y(r,o,"MiterLimit",e,m),referenceWidth:n,zOrder:Jt(t.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}function Ht(t,i,o,l,e,a){const s=t.markerPlacement;if(!s||"CIMMarkerPlacementInsidePolygon"!==s.type)return!1;const n=s,r=Math.abs(n.stepX),c=Math.abs(n.stepY);if(0===r||0===c)return!0;const f=["Rotation","OffsetX","OffsetY"],d=l.filter(I=>I.primitiveName!==t.primitiveName&&!f.includes(I.propertyName)),m="url"in t?t.url:null,[p,S]=ft(l,n.primitiveName,i,null,null),C=(0,R.hP)(JSON.stringify(t)+S).toString();let v,b,A=null;if("Random"===s.gridType){const I=(0,kt.Wz)(u.C1),j=Math.max(Math.floor(I/r),1),et=Math.max(Math.floor(I/c),1);v=c*et,A=ot=>ot?ot*et:0,b=j*r/v}else s.shiftOddRows?(v=2*c,A=I=>I?2*I:0,b=r/c*.5):(v=c,A=null,b=r/c);let W={r:255,g:255,b:255,a:1};return"tintColor"in t&&(W=(0,h.NO)(t.tintColor)),a.push({type:"fill",templateHash:C,materialHash:p?wt(C,o,d,e):C,cim:t,materialOverrides:d,colorLocked:t.colorLocked,effects:i,color:y(n.primitiveName,o,"TintColor",e,W,ct),height:y(n.primitiveName,o,"StepY",e,v,A),scaleX:b,angle:y(n.primitiveName,o,"GridAngle",e,n.gridAngle),offsetX:y(n.primitiveName,o,"OffsetX",e,(0,h.NA)(n.offsetX)),offsetY:y(n.primitiveName,o,"OffsetY",e,(0,h.NA)(n.offsetY)),url:m,applyRandomOffset:"Random"===s.gridType,sampleAlphaOnly:!m}),!0}function jt(t,i,o,l,e,a,s,n,r){const c=t.primitiveName,f=(0,h.NA)(t.size);let d=(0,h.NA)(t.scaleX);const m=(0,h.NA)(t.rotation),p=(0,h.NA)(t.offsetX),S=(0,h.NA)(t.offsetY),C=t.tintColor?(0,h.NO)(t.tintColor):{r:255,g:255,b:255,a:1},v=(0,R.hP)(`${t.url}${JSON.stringify(t.colorSubstitutions)}${JSON.stringify(t.animatedSymbolProperties)}`).toString(),b=Ut(t.markerPlacement,l,o,e),A=function qt(t,i,o,l){const e=[];if(x.E0.findApplicableOverrides(t,i,e),0===e.length)return t;for(const a of e)if(a.valueExpressionInfo){const s=o[a.primitiveName]&&o[a.primitiveName][a.propertyName];s instanceof G.mz&&(a.fn=(n,r,c)=>(0,tt.Z)(s,n,{$view:c},l.geometryType,r))}return(a,s,n)=>{for(const f of e)f.fn&&(f.value=f.fn(a,s,n));const r=(0,pt.d9)(t),c=t.primitiveName;for(const f of e)if(f.primitiveName===c){const d=Yt(f.propertyName);null!=f.value&&f.value!==r[d]&&(r[d]=f.value)}return r}}(t.animatedSymbolProperties,l,o,e),[W,I]=ft(l,c,i,b,A),j=(0,R.hP)(JSON.stringify(t)+I).toString(),et=t.anchorPoint??{x:0,y:0};if("width"in t){const K=t.width;let J=1;const q=a.getResource(t.url);(0,at.pC)(q)&&(J=q.width/q.height),d/=J*(f/K)}function ot(K,J){return(0,h.hf)(A,K,J)}s.push({type:"marker",templateHash:j,materialHash:t.animatedSymbolProperties&&!0===t.animatedSymbolProperties.randomizeStartTime?(K,J,q,st)=>{const Ot=function $(t){return Math.floor(function Y(t,i){let o;if("string"==typeof t)o=(0,R.hP)(t+`-seed(${i})`);else{let l=12;o=t^i;do{o=107*(o>>8^o)+l|0}while(0!=--l)}return(1+o/(1<<31))/2}(t,w)*H)}(st),bt=ot(K,J);return v+`-MATERIALGROUP(${Ot})-ASP(${JSON.stringify(bt)})`}:W?(K,J)=>{const q=ot(K,J);return v+`-ASP(${JSON.stringify(q)})`}:v,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:!1,alignment:n,size:y(c,o,"Size",e,f),scaleX:y(c,o,"ScaleX",e,d),rotation:y(c,o,"Rotation",e,m),offsetX:y(c,o,"OffsetX",e,p),offsetY:y(c,o,"OffsetY",e,S),color:y(c,o,"TintColor",e,C,ct),anchorPoint:{x:et.x,y:-et.y},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:t.rotateClockwise,referenceSize:r,sizeRatio:1,markerPlacement:b,url:t.url,animatedSymbolProperties:A})}function Gt(t,i,o,l,e,a,s,n,r,c){const f=t.markerGraphics;if(!f)return;let d=0;if(t.scaleSymbolsProportionally){const p=t.frame;p&&(d=p.ymax-p.ymin)}const m=Ut(t.markerPlacement,l,o,e);for(const p of f)if(p){const S=p.symbol;if(!S)continue;switch(S.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":Kt(t,i,m,null,p,l,o,e,a,s,n,r,d,c);break;case"CIMTextSymbol":Zt(t,i,m,p,o,l,e,a,n,r,d)}}}function Zt(t,i,o,l,e,a,s,n,r,c,f){x.E0.findApplicableOverrides(l,a,[]);const m=l.geometry;if(!("x"in m)||!("y"in m))return;const p=l.symbol,S=function F(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}(p),C=function lt(t){let i="",o="";if(t){const l=t.toLowerCase();l.includes("italic")?i="italic":l.includes("oblique")&&(i="oblique"),l.includes("bold")?o="bold":l.includes("light")&&(o="lighter")}return{style:i,weight:o}}(p.fontStyleName),v=function N(t){const i=t.toLowerCase().split(" ").join("-");switch(i){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return i}}(p.fontFamilyName);p.font={family:v,decoration:S,...C};const b=t.frame,A=m.x-.5*(b.xmin+b.xmax),W=m.y-.5*(b.ymin+b.ymax),I=t.size/f,j=t.primitiveName,et=(0,h.NA)(p.height)*I,ot=(0,h.NA)(p.angle),Q=(0,h.NA)(t.offsetX)+((0,h.NA)(p.offsetX)+A)*I,K=(0,h.NA)(t.offsetY)+((0,h.NA)(p.offsetY)+W)*I,J=(0,h.NO)(x.B$.getFillColor(p));let q=(0,h.NO)(x.B$.getStrokeColor(p)),st=x.B$.getStrokeWidth(p);st||(q=(0,h.NO)(x.B$.getFillColor(p.haloSymbol)),st=p.haloSize*I);const[Ot,bt]=ft(a,j,i,o,null),It=JSON.stringify(t.effects)+Number(t.colorLocked)+JSON.stringify(t.anchorPoint)+t.anchorPointUnits+JSON.stringify(t.markerPlacement),mt=(0,R.hP)(JSON.stringify(l)+It+bt).toString();let _=y(l.primitiveName,e,"TextString",s,l.textString,h.X3,p.textCase);if(null==_)return;const{fontStyleName:Lt}=p,gt=v+(Lt?"-"+Lt.toLowerCase():"-regular"),dt=gt;"string"==typeof _&&_.includes("[")&&p.fieldMap&&(_=(0,h.Qs)(p.fieldMap,_,p.textCase)),n.push({type:"text",templateHash:mt,materialHash:Ot||"function"==typeof _||_.match(/\[(.*?)\]/)?(it,Tt,$t)=>dt+"-"+(0,h.hf)(_,it,Tt,$t):dt+"-"+(0,R.hP)(_),cim:p,materialOverrides:null,colorLocked:t.colorLocked,effects:i,alignment:r,anchorPoint:{x:t.anchorPoint?t.anchorPoint.x:0,y:t.anchorPoint?t.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,fontName:gt,decoration:S,weight:y(j,e,"Weight",s,C.weight),style:y(j,e,"Size",s,C.style),size:y(j,e,"Size",s,et),angle:y(j,e,"Rotation",s,ot),offsetX:y(j,e,"OffsetX",s,Q),offsetY:y(j,e,"OffsetY",s,K),horizontalAlignment:B(p.horizontalAlignment),verticalAlignment:rt(p.verticalAlignment),text:_,color:J,outlineColor:q,outlineSize:st,referenceSize:c,sizeRatio:1,markerPlacement:o})}function Kt(t,i,o,l,e,a,s,n,r,c,f,d,m,p){const S=e.symbol,C=S.symbolLayers;if(!C)return;if(p)return void Dt(t,i,o,l,e,s,a,n,r,c,f,d,m);let v=C.length;if(ee(C))return void function Vt(t,i,o,l,e,a,s,n,r,c,f,d,m){const p=e.geometry,S=a[0],C=a[1],v=(0,nt.bk)(p);if(!v)return;const[b,A,W]=(0,nt.UV)(v,t.frame,t.size,t.anchorPoint,"Relative"!==t.anchorPointUnits),I={type:"sdf",geom:p,asFill:!0},j=t.primitiveName,et=(0,h.NA)(t.size),ot=(0,h.NA)(t.rotation),Q=(0,h.NA)(t.offsetX),K=(0,h.NA)(t.offsetY),J=C.path,q=C.primitiveName,st=S.primitiveName,Ot=(0,h.NO)(x.B$.getFillColor(C)),bt=(0,h.NO)(x.B$.getStrokeColor(S)),It=x.B$.getStrokeWidth(S);let mt=!1,_="";for(const it of s)it.primitiveName!==q&&it.primitiveName!==st&&it.primitiveName!==j||(void 0!==it.value?_+=`-${it.primitiveName}-${it.propertyName}-${JSON.stringify(it.value)}`:it.valueExpressionInfo&&(mt=!0));const Lt=JSON.stringify({...t,markerGraphics:null}),gt=(0,R.hP)(JSON.stringify(I)+J).toString(),dt={type:"marker",templateHash:(0,R.hP)(JSON.stringify(e)+JSON.stringify(C)+JSON.stringify(S)+Lt+_).toString(),materialHash:mt?()=>gt:gt,cim:I,materialOverrides:null,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:f,anchorPoint:{x:A,y:W},isAbsoluteAnchorPoint:!1,size:y(t.primitiveName,n,"Size",r,et),rotation:y(t.primitiveName,n,"Rotation",r,ot),offsetX:y(t.primitiveName,n,"OffsetX",r,Q),offsetY:y(t.primitiveName,n,"OffsetY",r,K),scaleX:1,frameHeight:m,rotateClockwise:t.rotateClockwise,referenceSize:d,sizeRatio:b,color:y(q,n,"Color",r,Ot,ct),outlineColor:y(st,n,"Color",r,bt,ct),outlineWidth:y(st,n,"Width",r,It),markerPlacement:o,path:J,animatedSymbolProperties:l};c.push(dt)}(t,i,o,l,e,C,a,s,n,r,f,d,m);const b=Z.j.applyEffects(S.effects,e.geometry,c.geometryEngine);if(b)for(;v--;){const A=C[v];if(A&&!1!==A.enable)switch(A.type){case"CIMSolidFill":case"CIMSolidStroke":{const W=Z.j.applyEffects(A.effects,b,c.geometryEngine),I=(0,nt.bk)(W);if(!I)continue;const[j,et,ot]=(0,nt.UV)(I,t.frame,t.size,t.anchorPoint,"Relative"!==t.anchorPointUnits),Q="CIMSolidFill"===A.type,K={type:"sdf",geom:W,asFill:Q},J=t.primitiveName,q=(0,h.NA)(t.size)??10,st=(0,h.NA)(t.rotation),Ot=(0,h.NA)(t.offsetX),bt=(0,h.NA)(t.offsetY),It=A.path,mt=A.primitiveName,_=(0,h.NO)(Q?x.B$.getFillColor(A):x.B$.getStrokeColor(A)),Lt=Q?{r:0,g:0,b:0,a:0}:(0,h.NO)(x.B$.getStrokeColor(A)),gt=x.B$.getStrokeWidth(A);if(!Q&&!gt)break;let dt=!1,it="";for(const Pt of a)Pt.primitiveName!==mt&&Pt.primitiveName!==J||(void 0!==Pt.value?it+=`-${Pt.primitiveName}-${Pt.propertyName}-${JSON.stringify(Pt.value)}`:Pt.valueExpressionInfo&&(dt=!0));(0,at.pC)(i)&&"function"==typeof i&&(dt=!0);const Tt=JSON.stringify({...t,markerGraphics:null}),$t=(0,R.hP)(JSON.stringify(K)+It).toString(),ie={type:"marker",templateHash:(0,R.hP)(JSON.stringify(e)+JSON.stringify(A)+Tt+it).toString(),materialHash:dt?()=>$t:$t,cim:K,materialOverrides:null,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:f,anchorPoint:{x:et,y:ot},isAbsoluteAnchorPoint:!1,size:y(t.primitiveName,s,"Size",n,q),rotation:y(t.primitiveName,s,"Rotation",n,st),offsetX:y(t.primitiveName,s,"OffsetX",n,Ot),offsetY:y(t.primitiveName,s,"OffsetY",n,bt),scaleX:1,frameHeight:m,rotateClockwise:t.rotateClockwise,referenceSize:d,sizeRatio:j,color:y(mt,s,"Color",n,_,ct),outlineColor:y(mt,s,"Color",n,Lt,ct),outlineWidth:y(mt,s,"Width",n,gt),markerPlacement:o,animatedSymbolProperties:l,path:It};r.push(ie);break}default:Dt(t,i,o,l,e,s,a,n,r,c,f,d,m)}}}function Dt(t,i,o,l,e,a,s,n,r,c,f,d,m){const p=function _t(t,i){return{type:t.type,enable:!0,name:t.name,colorLocked:t.colorLocked,primitiveName:t.primitiveName,anchorPoint:t.anchorPoint,anchorPointUnits:t.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:t.rotateClockwise,rotation:0,size:t.size,billboardMode3D:t.billboardMode3D,depth3D:t.depth3D,frame:t.frame,markerGraphics:[i],scaleSymbolsProportionally:t.scaleSymbolsProportionally,respectFrame:t.respectFrame,clippingPath:t.clippingPath}}(t,e);let S=[];const C=["Rotation","OffsetX","OffsetY"];S=s.filter(J=>J.primitiveName!==t.primitiveName||!C.includes(J.propertyName));let v="";for(const J of s)void 0!==J.value&&(v+=`-${J.primitiveName}-${J.propertyName}-${JSON.stringify(J.value)}`);const[b,A,W]=x.B$.getTextureAnchor(p,c),I=t.primitiveName,j=(0,h.NA)(t.rotation),et=(0,h.NA)(t.offsetX),ot=(0,h.NA)(t.offsetY),Q=(0,R.hP)(JSON.stringify(p)+v).toString(),K={type:"marker",templateHash:Q,materialHash:S.length>0||(0,at.pC)(i)&&"function"==typeof i?wt(Q,a,S,n):Q,cim:p,materialOverrides:S,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:f,anchorPoint:{x:b,y:A},isAbsoluteAnchorPoint:!1,size:t.size,rotation:y(I,a,"Rotation",n,j),offsetX:y(I,a,"OffsetX",n,et),offsetY:y(I,a,"OffsetY",n,ot),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:m,rotateClockwise:t.rotateClockwise,referenceSize:d,sizeRatio:W/(0,kt.F2)(t.size),markerPlacement:o,animatedSymbolProperties:l};r.push(K)}function Jt(t){if(t&&0===t.indexOf("Level_")){const i=parseInt(t.substr(6),10);if(!isNaN(i))return i}return 0}function ct(t){if(!t||0===t.length)return null;const i=new Mt.Z(t).toRgba();return{r:i[0],g:i[1],b:i[2],a:i[3]}}function y(t,i,o,l,e,a,s){const n=i[t];if(n){const r=n[o];if("string"==typeof r||"number"==typeof r||r instanceof Array)return a?a.call(null,r,s):r;if(null!=r&&r instanceof G.mz)return(c,f,d)=>{let m=(0,tt.Z)(r,c,{$view:d},l.geometryType,f);return null!==m&&a&&(m=a.call(null,m,s)),null!==m?m:e}}return e}function Yt(t){return t&&t.charAt(0).toLowerCase()+t.substr(1)}function Qt(t,i,o,l){for(const e of i)if(e.valueExpressionInfo){const a=o[e.primitiveName]&&o[e.primitiveName][e.propertyName];a instanceof G.mz&&(e.fn=(s,n,r)=>(0,tt.Z)(a,s,{$view:r},l.geometryType,n))}return(e,a,s)=>{for(const r of i)r.fn&&(r.value=r.fn(e,a,s));const n=[];for(let r of t){const c=r?.primitiveName;if(c){let f=!1;for(const d of i)if(d.primitiveName===c){const m=Yt(d.propertyName);null!=d.value&&d.value!==r[m]&&(f||(r=(0,pt.d9)(r),f=!0),r[m]=d.value)}}n.push(r)}return n}}function Ut(t,i,o,l){const e=[];if(x.E0.findApplicableOverrides(t,i,e),0===e.length)return t;for(const a of e)if(a.valueExpressionInfo){const s=o[a.primitiveName]&&o[a.primitiveName][a.propertyName];s instanceof G.mz&&(a.fn=(n,r,c)=>(0,tt.Z)(s,n,{$view:c},l.geometryType,r))}return(a,s,n)=>{for(const f of e)f.fn&&(f.value=f.fn(a,s,n));const r=(0,pt.d9)(t),c=t.primitiveName;for(const f of e)if(f.primitiveName===c){const d=Yt(f.propertyName);null!=f.value&&f.value!==r[d]&&(r[d]=f.value)}return r}}function wt(t,i,o,l){for(const e of o)if(e.valueExpressionInfo){const a=i[e.primitiveName]&&i[e.primitiveName][e.propertyName];a instanceof G.mz&&(e.fn=(s,n,r)=>(0,tt.Z)(a,s,{$view:r},l.geometryType,n))}return(e,a,s)=>{for(const n of o)n.fn&&(n.value=n.fn(e,a,s));return(0,R.hP)(t+x.E0.buildOverrideKey(o)).toString()}}function te(t,i){if(!i||0===i.length)return t;const o=JSON.parse(JSON.stringify(t));return x.E0.applyOverrides(o,i),o}function ft(t,i,o,l,e){let a=!1,s="";for(const n of t)n.primitiveName===i&&(void 0!==n.value?s+=`-${n.primitiveName}-${n.propertyName}-${JSON.stringify(n.value)}`:n.valueExpressionInfo&&(a=!0));return(0,at.pC)(o)&&"function"==typeof o&&(a=!0),(0,at.pC)(l)&&"function"==typeof l&&(a=!0),(0,at.pC)(e)&&"function"==typeof e&&(a=!0),[a,s]}function Bt(t,i,o){if(t&&i)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const l=t.symbolLayers;if(!l)return;for(const e of l)switch(oe(e,i,o),e.type){case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMCharacterMarker":case"CIMPictureMarker":"url"in e&&e.url&&o.push(i.fetchResource(e.url,null));break;case"CIMVectorMarker":{const a=e.markerGraphics;if(!a)continue;for(const s of a)if(s){const n=s.symbol;n&&Bt(n,i,o)}}}}}}const ee=t=>t&&2===t.length&&t[0].enable&&t[1].enable&&"CIMSolidStroke"===t[0].type&&"CIMSolidFill"===t[1].type&&!t[0].effects&&!t[1].effects;let Rt;function oe(t,i,o){if(t.effects&&!(0,at.pC)(i.geometryEngine)){if(Rt)return void o.push(Rt);(0,h.Cc)(t.effects)&&(Rt=(0,h.RI)(),o.push(Rt),Rt.then(l=>i.geometryEngine=l))}}},73608:(Ft,Et,L)=>{L.d(Et,{j:()=>kt});var ut=L(91179),Mt=L(72283),pt=L(29214),Nt=L(11004);class kt{static executeEffects(G,x,V){const nt=(0,Mt.GP)(x);let Z=new pt.M(nt);for(const tt of G){const u=(0,Nt.h)(tt);u&&(Z=u.execute(Z,tt,1.3333333333333333,V))}return Z}static next(G){const x=G.next();return(0,Mt.wp)(x),x}static applyEffects(G,x,V){if(!G)return x;let nt=new pt.M(x);for(const tt of G){const u=(0,Nt.h)(tt);u&&(nt=u.execute(nt,tt,1,V))}let h,Z=null;for(;h=nt.next();)Z?(0,ut.l9)(Z)?(0,ut.l9)(h)&&Z.paths.push(...h.paths):(0,ut.oU)(Z)&&(0,ut.oU)(h)&&Z.rings.push(...h.rings):Z=h;return Z}}}}]);