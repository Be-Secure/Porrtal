"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[9094],{34013:(B,R,e)=>{e.d(R,{I:()=>W,b:()=>T});var l=e(62208),v=e(99770),f=e(13934),u=e(78925),D=e(24255),P=e(10109),g=e(67022),U=e(33726),d=e(2166),x=e(95285),A=e(65787),M=e(17625),n=e(22355),c=e(35387),h=e(44835),p=e(16396);function T(y){const m=new n.kG,{vertex:C,fragment:I}=m;return(0,d.Sv)(C,y),m.include(D.w,y),m.attributes.add(p.T.POSITION,"vec3"),m.attributes.add(p.T.UV0,"vec2"),m.varyings.add("vpos","vec3"),y.hasMultipassTerrain&&m.varyings.add("depth","float"),C.uniforms.add(new x.A("textureCoordinateScaleFactor",O=>(0,l.pC)(O.texture)&&(0,l.pC)(O.texture.descriptor.textureCoordinateScaleFactor)?O.texture.descriptor.textureCoordinateScaleFactor:v.O)),C.code.add(M.H`
    void main(void) {
      vpos = position;
      ${y.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0 * textureCoordinateScaleFactor;
      gl_Position = transformPosition(proj, view, vpos);
    }
  `),m.include(u.f5,y),m.include(P.l,y),I.uniforms.add([new c.A("tex",O=>O.texture),new A.p("opacity",O=>O.opacity)]),m.varyings.add("vTexCoord","vec2"),y.output===f.H.Alpha?I.code.add(M.H`
    void main() {
      discardBySlice(vpos);
      ${y.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}

      float alpha = texture2D(tex, vTexCoord).a * opacity;
      if (alpha  < ${M.H.float(g.F)}) {
        discard;
      }

      gl_FragColor = vec4(alpha);
    }
    `):(I.include(U.Y),I.code.add(M.H`
    void main() {
      discardBySlice(vpos);
      ${y.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}
      gl_FragColor = texture2D(tex, vTexCoord) * opacity;

      if (gl_FragColor.a < ${M.H.float(g.F)}) {
        discard;
      }

      gl_FragColor = highlightSlice(gl_FragColor, vpos);
      ${y.transparencyPassType===h.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    }
    `)),m}const W=Object.freeze(Object.defineProperty({__proto__:null,build:T},Symbol.toStringTag,{value:"Module"}))},19702:(B,R,e)=>{e.d(R,{A:()=>A});var l=e(15861),v=e(17626),f=e(54024),u=e(10699),D=e(32917),P=e(77712),d=(e(85931),e(90912),e(76898)),x=e(36947);const A=M=>{let n=class extends M{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(c){super.postscript(c),(0,x.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var c=this;return(0,l.Z)(function*(){const h=new AbortController,p=h.signal;c.handles.add((0,f.kB)(()=>h.abort())),yield(0,D.N1)(()=>c.view.defaultsFromMap?.heightModelInfoReady,p),(0,u.k_)(p);const T=(0,x.Wt)(c.layer,c.view.heightModelInfo,c.supportsHeightUnitConversion);if(T)throw T})()}canResume(){const c=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!c||!c.minScale||!c.maxScale||c.minScale>=c.maxScale)}getSuspendInfo(){const c=super.getSuspendInfo(),h=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return h&&h.minScale&&h.maxScale&&h.minScale<h.maxScale&&(c.outsideScaleRange=!0),c}};return(0,v._)([(0,P.Cb)()],n.prototype,"view",void 0),(0,v._)([(0,P.Cb)()],n.prototype,"slicePlaneEnabled",void 0),n=(0,v._)([(0,d.j)("esri.views.3d.layers.LayerView3D")],n),n}},59094:(B,R,e)=>{e.r(R),e.d(R,{default:()=>a});var l=e(15861),v=e(17626),f=e(54024),u=e(62208),D=e(10699),P=e(32917),g=e(77712),x=(e(85931),e(90912),e(76898)),A=e(65401),M=e(14517),n=e(37118),c=e(55915),h=e(65629);let p=class extends M.Z{constructor(t){super(t)}get bounds(){const t=this.coords;return(0,u.Wi)(t)||(0,u.Wi)(t.extent)?null:(0,A.oJ)(t.extent)}get coords(){const t=(0,u.Wg)(this.element.georeference)?.coords;return(0,c.dz)(t,this.spatialReference).geometry}get normalizedCoords(){return n.Z.fromJSON((0,h.Ui)(this.coords))}get normalizedBounds(){const t=(0,u.pC)(this.normalizedCoords)?this.normalizedCoords.extent:null;return(0,u.pC)(t)?(0,A.oJ)(t):null}};(0,v._)([(0,g.Cb)()],p.prototype,"spatialReference",void 0),(0,v._)([(0,g.Cb)()],p.prototype,"element",void 0),(0,v._)([(0,g.Cb)()],p.prototype,"bounds",null),(0,v._)([(0,g.Cb)()],p.prototype,"coords",null),(0,v._)([(0,g.Cb)()],p.prototype,"normalizedCoords",null),(0,v._)([(0,g.Cb)()],p.prototype,"normalizedBounds",null),p=(0,v._)([(0,x.j)("esri.layers.support.media.MediaElementView")],p);var T=e(62600),W=e(19702),y=e(64835),m=e(42743),C=e(52107),I=e(54840),O=e(53855),H=e(81695),E=e(16396),K=e(79967),z=e(45611),j=e(67969);let S=class extends((0,W.A)(z.Z)){constructor(){var t;super(...arguments),t=this,this.type="media-3d",this.drapeSourceType=T.L.RasterImage,this.updatePolicy=m.jq.ASYNC,this._uidToElement=new Map,this._renderedElements=new Map,this._lastDrapingExtent=null,this._update=(0,D.Ds)(function(){var s=(0,l.Z)(function*(i,o,_){const L=yield t._collectMediaElements(i,o,_);t._synchronizeRenderElements(L)});return function(i,o,_){return s.apply(this,arguments)}}(),0)}initialize(){this._renderer=this.view.basemapTerrain.overlayManager.registerGeometryDrapeSource(this),this.handles.add([(0,f.kB)(()=>this.view.basemapTerrain.overlayManager.unregisterDrapeSource(this)),(0,P.on)(()=>this.layer.source,"refresh",()=>this._updateWithLastDrapingExtent())]),this.updatingHandles.add(()=>this.suspended,()=>this._updateWithLastDrapingExtent())}setDrapingExtent(t,s){this._lastDrapingExtent={overlays:t,spatialReference:s},this._updateWithLastDrapingExtent()}getHit(t){const s=this._uidToElement.get(t);return s?{type:"media",element:s,layer:this.layer}:null}_updateWithLastDrapingExtent(){if((0,u.Wi)(this._lastDrapingExtent)||this.suspended)return void(this._renderer&&this._synchronizeRenderElements(new Set));const{overlays:t,spatialReference:s}=this._lastDrapingExtent;this.updatingHandles.addPromise(this._update(t,s).catch(()=>{}))}_collectMediaElements(t,s,i){var o=this;return(0,l.Z)(function*(){const _=o.layer.source;return(0,u.Wi)(_)?new Set:new Set((yield Promise.all(t.map(L=>_.queryElements((0,A.HH)(L.extent,s),{signal:i})))).flat())})()}_synchronizeRenderElements(t){this._synchronizeRenderElementsRemove(t),this._synchronizeRenderElementsAdd(t)}_synchronizeRenderElementsRemove(t){const s=new Set,i=[];this._renderedElements.forEach((o,_)=>{t.has(_)||(s.add(_),(0,u.pC)(o.renderData)&&i.push(o.renderData.renderGeometry),this._removeElement(_,o))}),this._renderer.removeGeometries(i,I.T.REMOVE)}_synchronizeRenderElementsAdd(t){for(const s of t)this._renderedElements.has(s)||this._createRenderElement(s)}_removeElement(t,{renderData:s,handle:i}){this._destroyRenderData(s),this._renderedElements.delete(t),this._uidToElement.delete(t.uid),i.remove()}_createRenderElement(t){var s=this;return(0,l.Z)(function*(){const i=new p({spatialReference:s.view.spatialReference,element:t}),o={renderData:null,handle:(0,f.AL)([s.updatingHandles.add(()=>t.opacity,_=>{(0,u.pC)(o.renderData)&&o.renderData.material.setParameters({opacity:_})}),s.updatingHandles.add(()=>i.coords,_=>{(0,u.pC)(o.renderData)?s._updateGeometry(o,o.renderData,_):s._initializeRenderData(i,o)}),s.updatingHandles.add(()=>t.content,()=>s._initializeRenderData(i,o)),(0,f.ed)(i)])};s._renderedElements.set(t,o),s._uidToElement.set(t.uid,t),s.updatingHandles.addPromise(t.load().catch(()=>{})),s._initializeRenderData(i,o)})()}_initializeRenderData(t,s){const{coords:i,element:o}=t;if((0,u.Wi)(i)||(0,u.Wi)(o.content))return void(s.renderData=this._destroyRenderData(s.renderData));if((0,u.pC)(s.renderData))return;const _=this._createTexture(o.content);this.view._stage.add(_);const L=this.view._stage.loadImmediate(_);(0,D.y8)(L)&&this.updatingHandles.addPromise(L);const F=new K.j({initTextureTransparent:!0,textureId:_.id,opacity:o.opacity,transparent:!0}),N=this._positionVertexBufferFromCoordinates(i),b=[0,1,2,0,2,3],V=new C.Z([[E.T.POSITION,{data:N,size:3,exclusive:!0}],[E.T.UV0,{data:[0,0,1,0,1,1,0,1],size:2,exclusive:!0}]],[[E.T.POSITION,b],[E.T.UV0,b]]),G=new O.z(V,F,{layerUid:this.layer.uid,graphicUid:o.uid});this._renderer.addGeometries([G],I.T.ADD),s.renderData={renderGeometry:G,texture:_,material:F}}_updateGeometry(t,s,i){if((0,u.Wi)(i))return void(t.renderData=this._destroyRenderData(t.renderData));const o=this._positionVertexBufferFromCoordinates(i);s.renderGeometry.vertexAttributes.get(E.T.POSITION).data=o,this._renderer.modifyGeometries([s.renderGeometry],I.$.VERTEXATTRS)}_positionVertexBufferFromCoordinates(t){const[s,i,o,_]=t.rings[0];return new Float64Array([s[0],s[1],y.Rn,_[0],_[1],y.Rn,o[0],o[1],y.Rn,i[0],i[1],y.Rn])}_destroyRenderData(t){return(0,u.Wi)(t)||(this.view._stage.remove(t.texture),this._renderer.removeGeometries([t.renderGeometry],I.T.REMOVE),t.material.dispose()),null}_createTexture(t){const s=t instanceof HTMLImageElement?t.naturalWidth:t.width,i=t instanceof HTMLImageElement?t.naturalHeight:t.height;return new H.x(t,{wrap:{s:j.e8.CLAMP_TO_EDGE,t:j.e8.CLAMP_TO_EDGE},preMultiplyAlpha:!0,width:s,height:i,mipmap:!0,powerOfTwoResizeMode:m.CE.STRETCH,updateCallback:()=>this.view.basemapTerrain.overlayManager.setDrawTexturesDirty()})}get test(){const t=this;return{get numberOfElements(){return t._renderedElements.size}}}};(0,v._)([(0,g.Cb)({readOnly:!0})],S.prototype,"type",void 0),(0,v._)([(0,g.Cb)()],S.prototype,"layer",void 0),S=(0,v._)([(0,x.j)("esri.views.3d.layers.MediaLayerView3D")],S);const a=S},79967:(B,R,e)=>{e.d(R,{j:()=>K});var l=e(13934),v=e(42743),f=e(33470),u=e(40723),D=e(88569),P=e(5894),g=e(60909),U=e(57623),d=e(17626),A=(e(17625),e(651)),M=e(91056),n=e(87601),c=e(39114),h=e(12407),p=e(64127),T=e(44835),W=e(41528),y=e(34013),m=e(67969),C=e(2078);class O extends M.A{initializeProgram(a){return new h.$(a.rctx,O.shader.get().build(this.configuration),c.i)}_setPipelineState(a,t){const s=this.configuration,i=a===T.A.NONE,o=a===T.A.FrontFace;return(0,C.sm)({blending:s.output!==l.H.Color&&s.output!==l.H.Alpha||!s.transparent?null:i?H:(0,D.j7)(a),culling:(0,C.zp)(s.cullFace),depthTest:{func:(0,D.Bh)(a)},depthWrite:i?s.writeDepth&&C.LZ:(0,D.K5)(a),colorWrite:C.BK,stencilWrite:s.hasOccludees?p.s3:null,stencilTest:s.hasOccludees?t?p.eD:p.RY:null,polygonOffset:i||o?null:(0,D.je)(s.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(a,t){return t?this._occludeePipelineState:super.getPipelineState(a,t)}}O.shader=new A.J(y.I,()=>e.e(8586).then(e.bind(e,18586)));const H=(0,C.if)(m.zi.ONE,m.zi.ONE_MINUS_SRC_ALPHA);class E extends W.W{constructor(){super(...arguments),this.output=l.H.Color,this.cullFace=v.Vr.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=T.A.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}(0,d._)([(0,n.o)({count:l.H.COUNT})],E.prototype,"output",void 0),(0,d._)([(0,n.o)({count:v.Vr.COUNT})],E.prototype,"cullFace",void 0),(0,d._)([(0,n.o)()],E.prototype,"hasSlicePlane",void 0),(0,d._)([(0,n.o)()],E.prototype,"transparent",void 0),(0,d._)([(0,n.o)()],E.prototype,"enableOffset",void 0),(0,d._)([(0,n.o)()],E.prototype,"writeDepth",void 0),(0,d._)([(0,n.o)()],E.prototype,"hasOccludees",void 0),(0,d._)([(0,n.o)({count:T.A.COUNT})],E.prototype,"transparencyPassType",void 0),(0,d._)([(0,n.o)()],E.prototype,"hasMultipassTerrain",void 0),(0,d._)([(0,n.o)()],E.prototype,"cullAboveGround",void 0);class K extends u.F5{constructor(a){super(a,new j),this.supportsEdges=!0,this._configuration=new E}getConfiguration(a,t){return this._configuration.output=a,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<D.ve,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(a,t,s,i,o,_,L){(0,U.Bw)(a,t,i,o,_,void 0,L)}requiresSlot(a,t){return!(t!==l.H.Color&&t!==l.H.Alpha&&t!==l.H.Highlight||a!==P.r.DRAPED_MATERIAL&&(t===l.H.Highlight?a!==P.r.OPAQUE_MATERIAL:a!==(this.parameters.transparent?this.parameters.writeDepth?P.r.TRANSPARENT_MATERIAL:P.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:P.r.OPAQUE_MATERIAL)))}createGLMaterial(a){return new z(a)}createBufferWriter(){return new g.G_(g.W1)}}class z extends f.F{constructor(a){super({...a,...a.material.parameters})}_updateParameters(a){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(O,a)}_updateOccludeeState(a){a.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:a.hasOccludees}),this._updateParameters(a))}beginSlot(a){return this._output!==l.H.Color&&this._output!==l.H.Alpha||this._updateOccludeeState(a),this._updateParameters(a)}}class j extends u.Mt{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=v.Vr.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0}}},45611:(B,R,e)=>{e.d(R,{Z:()=>c});var l=e(17626),v=e(14517),f=e(61885),u=e(80542),D=e(61996),P=e(63290),g=e(62208),U=e(60330),d=e(77712),M=(e(85931),e(90912),e(76898));let n=class extends((0,u.p)((0,D.IG)((0,U.v)(f.Z.EventedMixin(v.Z))))){constructor(h){super(h),this.layer=null,this.parent=null}initialize(){this.when().catch(h=>{if("layerview:create-error"!==h.name){const p=this.layer&&this.layer.id||"no id",T=this.layer&&this.layer.title||"no title";P.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${T}', id: '${p}')`,h)}})}get fullOpacity(){return(0,g.Pt)(this.get("layer.opacity"),1)*(0,g.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this.updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(h){this._overrideIfSome("visible",h)}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const h=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(h.viewNotReady=!0),this.layer&&this.layer.loaded||(h.layerNotLoaded=!0),this.visible||(h.layerInvisible=!0),h}isUpdating(){return!1}};(0,l._)([(0,d.Cb)()],n.prototype,"fullOpacity",null),(0,l._)([(0,d.Cb)()],n.prototype,"layer",void 0),(0,l._)([(0,d.Cb)()],n.prototype,"parent",void 0),(0,l._)([(0,d.Cb)({readOnly:!0})],n.prototype,"suspended",null),(0,l._)([(0,d.Cb)({readOnly:!0})],n.prototype,"suspendInfo",null),(0,l._)([(0,d.Cb)({readOnly:!0})],n.prototype,"legendEnabled",null),(0,l._)([(0,d.Cb)({type:Boolean,readOnly:!0})],n.prototype,"updating",null),(0,l._)([(0,d.Cb)({readOnly:!0})],n.prototype,"updatingProgress",null),(0,l._)([(0,d.Cb)()],n.prototype,"visible",null),(0,l._)([(0,d.Cb)()],n.prototype,"view",void 0),n=(0,l._)([(0,M.j)("esri.views.layers.LayerView")],n);const c=n}}]);