"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[2124],{19702:(f,E,e)=>{e.d(E,{A:()=>I});var i=e(15861),a=e(17626),u=e(54024),y=e(10699),h=e(32917),s=e(77712),P=(e(85931),e(8314),e(90912),e(76898)),M=e(36947);const I=D=>{let n=class extends D{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(l){super.postscript(l),(0,M.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var l=this;return(0,i.Z)(function*(){const _=new AbortController,O=_.signal;l.handles.add((0,u.kB)(()=>_.abort())),yield(0,h.N1)(()=>l.view.defaultsFromMap?.heightModelInfoReady,O),(0,y.k_)(O);const g=(0,M.Wt)(l.layer,l.view.heightModelInfo,l.supportsHeightUnitConversion);if(g)throw g})()}canResume(){const l=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!l||!l.minScale||!l.maxScale||l.minScale>=l.maxScale)}getSuspendInfo(){const l=super.getSuspendInfo(),_=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return _&&_.minScale&&_.maxScale&&_.minScale<_.maxScale&&(l.outsideScaleRange=!0),l}};return(0,a._)([(0,s.Cb)()],n.prototype,"view",void 0),(0,a._)([(0,s.Cb)()],n.prototype,"slicePlaneEnabled",void 0),n=(0,a._)([(0,P.j)("esri.views.3d.layers.LayerView3D")],n),n}},62124:(f,E,e)=>{e.r(E),e.d(E,{default:()=>K});var i=e(15861),a=e(17626),u=e(46160),y=e(46882),h=e(62208),s=e(32917),r=e(77712),M=(e(85931),e(8314),e(90912),e(76898)),I=e(99683),D=e(58924),n=e(53753),l=e(719),_=e(17718),O=e(29739),g=e(69583),U=e(19702),L=e(32400),A=e(89765),j=e(36967),B=e(42743),T=e(45611);let v=class extends((0,U.A)(T.Z)){constructor(){super(...arguments),this.type="route-3d",this.loadedGraphics=new j.g,this._byObjectID=new Map,this.slicePlaneEnabled=!1,this.fullExtentInLocalViewSpatialReference=null}initialize(){this._set("processor",new L.D({owner:this,scaleVisibilityEnabled:!0,frustumVisibilityEnabled:!0})),this.addResolvingPromise(this.processor.setup()),this.updatingHandles.addOnCollectionChange(()=>this._routeItems,t=>this._routeItemsChanged(t),s.nn),this.addResolvingPromise((0,A.E)(this).then(t=>this.fullExtentInLocalViewSpatialReference=t)),this.handles.add((0,s.gx)(()=>this.view?.basemapTerrain?.ready,()=>()=>this.notifyChange("updating"),{once:!0}))}destroy(){this.handles.removeAll(),this.updatingHandles.removeAll(),this._set("processor",(0,h.SC)(this.processor))}get _routeItems(){return new y.Z({getCollections:()=>[this.layer.pointBarriers,this.layer.polygonBarriers,this.layer.polylineBarriers,this.layer.stops,this.layer.directionLines,this.layer.directionPoints,(0,h.pC)(this.layer.routeInfo)?new u.Z([this.layer.routeInfo]):null]})}_routeItemsChanged(t){if(t.removed.length){this.loadedGraphics.removeMany(t.removed.map(o=>{const p=this._byObjectID.get(o);return this._byObjectID.delete(o),p}));for(const o of t.removed)this.handles.remove(o)}if(t.added.length){this.loadedGraphics.addMany(t.added.map(o=>{const p=o.toGraphic();return this._byObjectID.set(o,p),p}));for(const o of t.added)this.handles.add([(0,s.YP)(()=>o.geometry,(p,C)=>{this._updateGraphic(o,"geometry",p,C)}),(0,s.YP)(()=>o.symbol,(p,C)=>{this._updateGraphic(o,"symbol",p,C)})],o)}}get legendEnabled(){return this.canResume()&&!this.processor?.frustumVisibilitySuspended}getSuspendInfo(){const t=super.getSuspendInfo();return t.outsideScaleRange=this.processor?.scaleVisibilitySuspended??!1,t.outsideOfView=this.processor?.frustumVisibilitySuspended??!1,t}fetchPopupFeatures(t,o){return(0,i.Z)(function*(){return(0,h.pC)(o)?o.clientGraphics:null})()}getHit(t){return this.processor.getHit(t)}whenGraphicBounds(t,o){return this.processor.whenGraphicBounds(t,o)}computeAttachmentOrigin(t,o){return this.processor?.computeAttachmentOrigin(t,o)}getSymbolLayerSize(t,o){return this.processor.getSymbolLayerSize(t,o)}queryGraphics(){var t=this;return(0,i.Z)(function*(){return new u.Z(t.loadedGraphics.toArray())})()}maskOccludee(t){return this.processor.maskOccludee(t)}highlight(t){if(function W(t){return t instanceof I.Z||t instanceof D.Z||t instanceof n.Z||t instanceof l.Z||t instanceof _.Z||t instanceof O.Z||t instanceof g.Z}(t)){const o=this._byObjectID.get(t);return this.processor.highlight(o)}return this.processor.highlight(t)}get updatePolicy(){return this.processor?.graphicsCore.effectiveUpdatePolicy||B.jq.SYNC}canResume(){return super.canResume()&&!this.processor?.scaleVisibilitySuspended}isUpdating(){return!(!this.processor?.updating&&this.view?.basemapTerrain?.ready)}get performanceInfo(){return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:-1,totalNumberOfFeatures:-1,nodes:0,core:null,updating:this.updating,elevationUpdating:this.processor?.elevationAlignment.updating??!1,visibilityFrustum:!this.processor?.frustumVisibilitySuspended}}_updateGraphic(t,o,p,C){const R=this._byObjectID.get(t);R[o]=p,m.graphic=R,m.property=o,m.oldValue=C,m.newValue=p,this.processor?.graphicsCore.graphicUpdateHandler(m)}};(0,a._)([(0,r.Cb)()],v.prototype,"_routeItems",null),(0,a._)([(0,r.Cb)()],v.prototype,"loadedGraphics",void 0),(0,a._)([(0,r.Cb)({readOnly:!0})],v.prototype,"legendEnabled",null),(0,a._)([(0,r.Cb)()],v.prototype,"layer",void 0),(0,a._)([(0,r.Cb)({readOnly:!0})],v.prototype,"processor",void 0),(0,a._)([(0,r.Cb)({type:Boolean})],v.prototype,"slicePlaneEnabled",void 0),v=(0,a._)([(0,M.j)("esri.views.3d.layers.RouteLayerView3D")],v);const m={graphic:null,property:null,oldValue:null,newValue:null},K=v},89765:(f,E,e)=>{e.d(E,{E:()=>y});var i=e(62208),a=e(46367),u=e(35082);function y(h){const s=h.view.spatialReference,r=h.layer.fullExtent,c=(0,i.pC)(r)&&r.spatialReference;if((0,i.Wi)(r)||!c)return Promise.resolve(null);if(c.equals(s))return Promise.resolve(r.clone());const d=(0,a.iV)(r,s);return(0,i.pC)(d)?Promise.resolve(d):h.view.state.isLocal?(0,u.projectGeometry)(r,s,h.layer.portalItem).then(P=>!h.destroyed&&P?P:void 0).catch(()=>null):Promise.resolve(null)}},36967:(f,E,e)=>{e.d(E,{g:()=>y});var i=e(61885),a=e(73234),u=e(28862);class y extends i.Z{constructor(){super(...arguments),this._set=new Set}clear(){if(this._set.size>0){const s=this.toArray();this._set.clear(),this.emit("after-changes",{type:a.y.REMOVE}),this.emit("change",{added:[],removed:s})}}get length(){return this._set.size}addMany(s){if(0!==s.length){for(const r of s)this._set.add(r);this.emit("after-changes",{type:a.y.ADD}),this.emit("change",{added:s,removed:[]})}}remove(s){this._set.delete(s)&&(this.emit("after-changes",{type:a.y.REMOVE}),this.emit("change",{added:[],removed:[s]}))}removeMany(s){const r=[];for(const c of s)this._set.delete(c)&&r.push(c);r.length>0&&(this.emit("after-changes",{type:a.y.REMOVE}),this.emit("change",{added:[],removed:r}))}toArray(){return[...this._set]}find(s){let r;return(0,u.f)(this._set,c=>!!s(c)&&(r=c,!0)),r}forEach(s){this._set.forEach(r=>s(r))}}},45611:(f,E,e)=>{e.d(E,{Z:()=>l});var i=e(17626),a=e(14517),u=e(61885),y=e(80542),h=e(61996),s=e(63290),r=e(62208),c=e(60330),d=e(77712),D=(e(85931),e(8314),e(90912),e(76898));let n=class extends((0,y.p)((0,h.IG)((0,c.v)(u.Z.EventedMixin(a.Z))))){constructor(_){super(_),this.layer=null,this.parent=null}initialize(){this.when().catch(_=>{if("layerview:create-error"!==_.name){const O=this.layer&&this.layer.id||"no id",g=this.layer&&this.layer.title||"no title";s.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${g}', id: '${O}')`,_)}})}get fullOpacity(){return(0,r.Pt)(this.get("layer.opacity"),1)*(0,r.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this.updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(_){void 0!==_?this._override("visible",_):this._clearOverride("visible")}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const _=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(_.viewNotReady=!0),this.layer&&this.layer.loaded||(_.layerNotLoaded=!0),this.visible||(_.layerInvisible=!0),_}isUpdating(){return!1}};(0,i._)([(0,d.Cb)()],n.prototype,"fullOpacity",null),(0,i._)([(0,d.Cb)()],n.prototype,"layer",void 0),(0,i._)([(0,d.Cb)()],n.prototype,"parent",void 0),(0,i._)([(0,d.Cb)({readOnly:!0})],n.prototype,"suspended",null),(0,i._)([(0,d.Cb)({readOnly:!0})],n.prototype,"suspendInfo",null),(0,i._)([(0,d.Cb)({readOnly:!0})],n.prototype,"legendEnabled",null),(0,i._)([(0,d.Cb)({type:Boolean,readOnly:!0})],n.prototype,"updating",null),(0,i._)([(0,d.Cb)({readOnly:!0})],n.prototype,"updatingProgress",null),(0,i._)([(0,d.Cb)()],n.prototype,"visible",null),(0,i._)([(0,d.Cb)()],n.prototype,"view",void 0),n=(0,i._)([(0,D.j)("esri.views.layers.LayerView")],n);const l=n}}]);