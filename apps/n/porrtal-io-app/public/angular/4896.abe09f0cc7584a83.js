"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[4896],{36592:(ee,w,u)=>{u.d(w,{Q:()=>Z});var O=u(85931),W=u(62208),U=u(77029),b=u(14259);class Z{constructor(e=9,n){this.compareMinX=A,this.compareMinY=f,this._toBBox=i=>i,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),n&&("function"==typeof n?this._toBBox=n:this._initFormat(n)),this.clear()}destroy(){this.clear(),Q.prune(),V.prune(),Y.prune(),z.prune()}all(e){this._all(this.data,e)}search(e,n){let i=this.data;const a=this._toBBox;if(G(e,i))for(Q.clear();i;){for(let d=0,h=i.children.length;d<h;d++){const _=i.children[d],v=i.leaf?a(_):_;G(e,v)&&(i.leaf?n(_):P(e,v)?this._all(_,n):Q.push(_))}i=Q.pop()}}collides(e){let n=this.data;const i=this._toBBox;if(!G(e,n))return!1;for(Q.clear();n;){for(let a=0,d=n.children.length;a<d;a++){const h=n.children[a],_=n.leaf?i(h):h;if(G(e,_)){if(n.leaf||P(e,_))return!0;Q.push(h)}}n=Q.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let i=0,a=e.length;i<a;i++)this.insert(e[i]);return this}let n=this._build(e.slice(0,e.length),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=new J([]),this}remove(e){if(!e)return this;let n,i=this.data,a=null,d=0,h=!1;const _=this._toBBox(e);for(Y.clear(),z.clear();i||Y.length>0;){if(i||(i=(0,W.j0)(Y.pop()),a=Y.data[Y.length-1],d=z.pop()??0,h=!0),i.leaf&&(n=(0,O.cq)(i.children,e,i.children.length,i.indexHint),-1!==n))return i.children.splice(n,1),Y.push(i),this._condense(Y),this;h||i.leaf||!P(i,_)?a?(d++,i=a.children[d],h=!1):i=null:(Y.push(i),z.push(d),d=0,a=i,i=i.children[0])}return this}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){let i=e;for(V.clear();i;){if(!0===i.leaf)for(const a of i.children)n(a);else V.pushArray(i.children);i=V.pop()??null}}_build(e,n,i,a){const d=i-n+1;let h=this._maxEntries;if(d<=h){const T=new J(e.slice(n,i+1));return E(T,this._toBBox),T}a||(a=Math.ceil(Math.log(d)/Math.log(h)),h=Math.ceil(d/h**(a-1)));const _=new k([]);_.height=a;const v=Math.ceil(d/h),N=v*Math.ceil(Math.sqrt(h));ne(e,n,i,N,this.compareMinX);for(let T=n;T<=i;T+=N){const R=Math.min(T+N-1,i);ne(e,T,R,v,this.compareMinY);for(let K=T;K<=R;K+=v){const re=Math.min(K+v-1,R);_.children.push(this._build(e,K,re,a-1))}}return E(_,this._toBBox),_}_chooseSubtree(e,n,i,a){for(;a.push(n),!0!==n.leaf&&a.length-1!==i;){let d,h=1/0,_=1/0;for(let v=0,N=n.children.length;v<N;v++){const T=n.children[v],R=y(T),K=g(e,T)-R;K<_?(_=K,h=R<h?R:h,d=T):K===_&&R<h&&(h=R,d=T)}n=d||n.children[0]}return n}_insert(e,n,i){const d=i?e:(0,this._toBBox)(e);Y.clear();const h=this._chooseSubtree(d,this.data,n,Y);for(h.children.push(e),L(h,d);n>=0&&Y.data[n].children.length>this._maxEntries;)this._split(Y,n),n--;this._adjustParentBBoxes(d,Y,n)}_split(e,n){const i=e.data[n],a=i.children.length,d=this._minEntries;this._chooseSplitAxis(i,d,a);const h=this._chooseSplitIndex(i,d,a);if(!h)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const _=i.children.splice(h,i.children.length-h),v=i.leaf?new J(_):new k(_);v.height=i.height,E(i,this._toBBox),E(v,this._toBBox),n?e.data[n-1].children.push(v):this._splitRoot(i,v)}_splitRoot(e,n){this.data=new k([e,n]),this.data.height=e.height+1,E(this.data,this._toBBox)}_chooseSplitIndex(e,n,i){let a,d,h;a=d=1/0;for(let _=n;_<=i-n;_++){const v=D(e,0,_,this._toBBox),N=D(e,_,i,this._toBBox),T=j(v,N),R=y(v)+y(N);T<a?(a=T,h=_,d=R<d?R:d):T===a&&R<d&&(d=R,h=_)}return h}_chooseSplitAxis(e,n,i){const a=e.leaf?this.compareMinX:A,d=e.leaf?this.compareMinY:f;this._allDistMargin(e,n,i,a)<this._allDistMargin(e,n,i,d)&&e.children.sort(a)}_allDistMargin(e,n,i,a){e.children.sort(a);const d=this._toBBox,h=D(e,0,n,d),_=D(e,i-n,i,d);let v=o(h)+o(_);for(let N=n;N<i-n;N++){const T=e.children[N];L(h,e.leaf?d(T):T),v+=o(h)}for(let N=i-n-1;N>=n;N--){const T=e.children[N];L(_,e.leaf?d(T):T),v+=o(_)}return v}_adjustParentBBoxes(e,n,i){for(let a=i;a>=0;a--)L(n.data[a],e)}_condense(e){for(let n=e.length-1;n>=0;n--){const i=e.data[n];if(0===i.children.length)if(n>0){const a=e.data[n-1],d=a.children;d.splice((0,O.cq)(d,i,d.length,a.indexHint),1)}else this.clear();else E(i,this._toBBox)}}_initFormat(e){const n=["return a"," - b",";"];this.compareMinX=new Function("a","b",n.join(e[0])),this.compareMinY=new Function("a","b",n.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function E(l,e){D(l,0,l.children.length,e,l)}function D(l,e,n,i,a){a||(a=new J([])),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(let d,h=e;h<n;h++)d=l.children[h],L(a,l.leaf?i(d):d);return a}function L(l,e){l.minX=Math.min(l.minX,e.minX),l.minY=Math.min(l.minY,e.minY),l.maxX=Math.max(l.maxX,e.maxX),l.maxY=Math.max(l.maxY,e.maxY)}function A(l,e){return l.minX-e.minX}function f(l,e){return l.minY-e.minY}function y(l){return(l.maxX-l.minX)*(l.maxY-l.minY)}function o(l){return l.maxX-l.minX+(l.maxY-l.minY)}function g(l,e){return(Math.max(e.maxX,l.maxX)-Math.min(e.minX,l.minX))*(Math.max(e.maxY,l.maxY)-Math.min(e.minY,l.minY))}function j(l,e){const n=Math.max(l.minX,e.minX),i=Math.max(l.minY,e.minY),a=Math.min(l.maxX,e.maxX),d=Math.min(l.maxY,e.maxY);return Math.max(0,a-n)*Math.max(0,d-i)}function P(l,e){return l.minX<=e.minX&&l.minY<=e.minY&&e.maxX<=l.maxX&&e.maxY<=l.maxY}function G(l,e){return e.minX<=l.maxX&&e.minY<=l.maxY&&e.maxX>=l.minX&&e.maxY>=l.minY}function ne(l,e,n,i,a){const d=[e,n];for(;d.length;){const h=(0,W.j0)(d.pop()),_=(0,W.j0)(d.pop());if(h-_<=i)continue;const v=_+Math.ceil((h-_)/i/2)*i;(0,b.q)(l,v,_,h,a),d.push(_,v,v,h)}}const Q=new U.Z,V=new U.Z,Y=new U.Z,z=new U.Z({deallocator:void 0});class ie{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class se extends ie{constructor(){super(...arguments),this.height=1,this.indexHint=new O.SO}}class J extends se{constructor(e){super(),this.children=e,this.leaf=!0}}class k extends se{constructor(e){super(),this.children=e,this.leaf=!1}}},61256:(ee,w,u)=>{u.d(w,{H:()=>L});var O=u(8314),W=u(36592),U=u(65401);const Z={minX:0,minY:0,maxX:0,maxY:0};class L{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new W.Q(9,(0,O.Z)("esri-csp-restrictions")?f=>({minX:f[0],minY:f[1],maxX:f[2],maxY:f[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const f=new Array(this._idByBounds.size);let y=0;this._idByBounds.forEach((o,g)=>{f[y++]=g}),this._indexInvalid=!1,this._index.clear(),this._index.load(f)}else this._boundsToLoad.length&&(this._index.load(this._boundsToLoad.filter(f=>this._idByBounds.has(f))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const f=(0,U.cS)();for(const y of this._boundsById.values())y&&(f[0]=Math.min(y[0],f[0]),f[1]=Math.min(y[1],f[1]),f[2]=Math.max(y[2],f[2]),f[3]=Math.max(y[3],f[3]));return f}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(f){const y=this._boundsById.get(f);this._boundsById.delete(f),y&&(this._idByBounds.delete(y),this._indexInvalid||this._index.remove(y))}forEachInBounds(f,y){this._loadIndex(),function D(A,f,y){(function E(A){Z.minX=A[0],Z.minY=A[1],Z.maxX=A[2],Z.maxY=A[3]})(f),A.search(Z,y)}(this._index,f,o=>y(this._idByBounds.get(o)))}get(f){return this._boundsById.get(f)}has(f){return this._boundsById.has(f)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(f,y){if(!this._indexInvalid){const o=this._boundsById.get(f);o&&(this._index.remove(o),this._idByBounds.delete(o))}this._boundsById.set(f,y),y&&(this._idByBounds.set(y,f),this._indexInvalid||(this._boundsToLoad.push(y),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},3579:(ee,w,u)=>{u.d(w,{Z:()=>f});var O=u(26584),W=u(61885),U=u(63290),b=u(62208),Z=u(5548),E=u(65401),D=u(82054),L=u(61256),A=u(92794);class f{constructor(o){this.geometryInfo=o,this._boundsStore=new L.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new W.Z,this.featureAdapter=A.n}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let o=0;return this._featuresById.forEach(g=>{(0,b.pC)(g.geometry)&&g.geometry.coords&&(o+=g.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:o/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}add(o){this._add(o),this._emitChanged()}addMany(o){for(const g of o)this._add(g);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(o){const g=this._featuresById.get(o);return g?(this._remove(g),this._emitChanged(),g):null}removeManyById(o){this._boundsStore.invalidateIndex();for(const g of o){const j=this._featuresById.get(g);j&&this._remove(j)}this._emitChanged()}forEachBounds(o,g,j){for(const P of o){const G=this._boundsStore.get(P.objectId);G&&g((0,Z.JR)(j,G))}}getFeature(o){return this._featuresById.get(o)}has(o){return this._featuresById.has(o)}toArray(){return Array.from(this._featuresById.values())}forEach(o){this._featuresById.forEach(g=>o(g))}forEachInBounds(o,g){this._boundsStore.forEachInBounds(o,j=>{g(this._featuresById.get(j))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let o=!1;this._featuresById.forEach((g,j)=>{this._markedIds.has(j)||(o=!0,this._remove(g))}),this._markedIds.clear(),o&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(o){if(!o)return;const g=o.objectId;if(null==g)return void U.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new O.Z("featurestore:invalid-feature","feature id is missing",{feature:o}));const j=this._featuresById.get(g);let P;if(this._markedIds.add(g),j?(o.displayId=j.displayId,P=this._boundsStore.get(g),this._boundsStore.delete(g)):(0,b.pC)(this.onFeatureAdd)&&this.onFeatureAdd(o),(0,b.Wi)(o.geometry)||!o.geometry.coords||!o.geometry.coords.length)return this._boundsStore.set(g,null),void this._featuresById.set(g,o);P=(0,D.$)((0,b.pC)(P)?P:(0,E.Ue)(),o.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),(0,b.pC)(P)&&this._boundsStore.set(g,P),this._featuresById.set(g,o)}_remove(o){return(0,b.pC)(this.onFeatureRemove)&&this.onFeatureRemove(o),this._markedIds.delete(o.objectId),this._boundsStore.delete(o.objectId),this._featuresById.delete(o.objectId),o}}},92794:(ee,w,u)=>{u.d(w,{n:()=>Z});var O=u(62208),W=u(77044),U=u(66385),b=u(88071);const Z={getObjectId:E=>E.objectId,getAttributes:E=>E.attributes,getAttribute:(E,D)=>E.attributes[D],cloneWithGeometry:(E,D)=>new U.u_(D,E.attributes,null,E.objectId),getGeometry:E=>E.geometry,getCentroid:(E,D)=>((0,O.Wi)(E.centroid)&&(E.centroid=(0,W.Y)(new b.Z,E.geometry,D.hasZ,D.hasM)),E.centroid)}},54896:(ee,w,u)=>{u.r(w),u.d(w,{default:()=>me});var O=u(15861),U=(u(29132),u(84792)),b=u(26584),Z=u(63290),E=u(10699),D=u(21726),L=u(55915),A=u(15994),f=u(37053),y=u(46367),o=u(66385),g=u(88071),j=u(3579),P=u(82959),G=u(58175);const ne=/^\s*"([\S\s]*)"\s*$/,Q=/""/g,Y=[","," ",";","|","\t"];function*z(p,r,t){let s=0;for(;s<=p.length;){const m=p.indexOf(r,s),c=p.substring(s,m>-1?m:void 0);s+=c.length+r.length,t&&!c.trim()||(yield c)}}function ie(p){const r=p.includes("\r\n")?"\r\n":"\n";return z(p,r,!0)}function se(p,r){return z(p,r,!1)}function*k(p,r,t,s=(()=>Object.create(null))){let m="",c="",M=0,B=s(),C=0;e:for(const I of p){const F=se(I,t);for(const S of F)if(m+=c+S,c="",M+=l(S),M%2==0){if(M>0){const H=ne.exec(m);if(!H){B=s(),C=0,m="",M=0;continue e}B[r[C]]=H[1].replace(Q,'"'),C++}else B[r[C]]=m,C++;m="",M=0}else c=t;0===M?(yield B,B=s(),C=0):c="\n"}}function l(p){let r=0,t=0;for(t=p.indexOf('"',t);t>=0;)r++,t=p.indexOf('"',t+1);return r}var e=u(56554),n=u(75327);function d(p){if(!p.length)return"string";const r=/[^+-.,0-9]/;return p.map(t=>{let s=!1;if(""!==t){if(r.test(t))s=!0;else{let m=_(t);if(!isNaN(m))return/[.,]/.test(t)||!Number.isInteger(m)||m>214783647||m<-214783648?"double":"integer";if(t.includes("E")){if(m=Number(t),!isNaN(m))return"double";if(t.includes(",")){if(t=t.replace(",","."),m=Number(t),!isNaN(m))return"double";s=!0}else s=!0}else s=!0}return s?/^[-]?\d*[.,]?\d*$/.test(t)?"string":h(new Date(t),t)?"date":"string":"string"}}).reduce((t,s)=>void 0===t||t===s?s:"string"===t||"string"===s?"string":"double"===t||"double"===s?"double":void 0)}function h(p,r){if(!p||"[object Date]"!==Object.prototype.toString.call(p)||isNaN(p.getTime()))return!1;let t=!0;if(!N&&/\d+\W*$/.test(r)){const s=r.match(/[a-zA-Z]{2,}/);if(s){let m=!1,c=0;for(;!m&&c<=s.length;)m=!v.test(s[c]),c++;t=!m}}return t}const _=function(){const p=(0,n.lt)(),r=new RegExp("^"+p.regexp+"$"),t=new RegExp("["+p.group+"\\s\\xa0]","g"),s=p.factor;return m=>{const c=r.exec(m);if(p.factor=s,!c)return NaN;let M=c[1];if(!c[1]){if(!c[2])return NaN;M=c[2],p.factor*=-1}return M=M.replace(t,"").replace(p.decimal,"."),+M*p.factor}}(),v=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,N=Number.isNaN(new Date("technology 10").getTime()),T=["lat","latitude","latitude83","latdecdeg","lat_dd","y","ycenter","point-y"],R=["lon","lng","long","longitude","longitude83","longdecdeg","long_dd","x","xcenter","point-x"];var K=u(60466),re=u(36630),le=u(65234);const de=(0,e.bU)("esriGeometryPoint"),ue=["csv"],he=[0,0];class ce{constructor(r,t){this.x=r,this.y=t}}class me{constructor(){var r=this;this._queryEngine=null,this._snapshotFeatures=function(){var t=(0,O.Z)(function*(s){const m=yield r._fetch(s);return r._createFeatures(m)});return function(s){return t.apply(this,arguments)}}()}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}load(r,t={}){var s=this;return(0,O.Z)(function*(){s.loadOptions=r;const[m]=yield Promise.all([s._fetch(t.signal),s._checkProjection(r?.parsingOptions?.spatialReference)]),c=function fe(p,r){const t=r.parsingOptions||{},s={delimiter:t.delimiter,layerDefinition:null,locationInfo:{latitudeFieldName:t.latitudeField,longitudeFieldName:t.longitudeField}},m=ie(p);let c=m.next().value;if(!c)throw new b.Z("csv-layer:empty-csv","CSV is empty",{csv:p});if(c=c.trim(),!t.delimiter){const I=function J(p){const r=p.trim();let t=0,s="";for(const m of Y){const c=r.split(m).length;c>t&&(t=c,s=m)}return""===s?null:s}(c);if(!I)throw new b.Z("csv-layer:invalid-delimiter","Unable to detect the delimiter from CSV");s.delimiter=I}const M=c.split(s.delimiter).filter(I=>!!I),B=s.layerDefinition={name:(0,D.vt)(r.url,ue)||"csv",drawingInfo:de,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:t.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:t.spatialReference||{wkid:102100}}};if(!t.latitudeField||!t.longitudeField){const I=function i(p){const r=p.map(t=>t.toLowerCase());return{longitudeFieldName:p[r.indexOf(R.find(t=>r.includes(t)))],latitudeFieldName:p[r.indexOf(T.find(t=>r.includes(t)))]}}(M);if(!t.longitudeField&&!I.longitudeFieldName||!t.latitudeField&&!I.latitudeFieldName)throw new b.Z("csv-layer:location-fields-not-found","Unable to identify latitude and longitude fields from the CSV file");s.locationInfo={longitudeFieldName:t.longitudeField||I.longitudeFieldName,latitudeFieldName:t.latitudeField||I.latitudeFieldName}}const C=function a(p,r,t,s){const m=[],c=k(p,t,r),M=[];for(const B of c){if(10===M.length)break;M.push(B)}for(const B of t)if(B===s.longitudeFieldName||B===s.latitudeFieldName)m.push({name:B,type:"esriFieldTypeDouble",alias:B});else{const C=d(M.map(F=>F[B])),I={name:B,type:null,alias:B};switch(C){case"integer":I.type="esriFieldTypeInteger";break;case"double":I.type="esriFieldTypeDouble";break;case"date":I.type="esriFieldTypeDate",I.length=36;break;default:I.type="esriFieldTypeString",I.length=255}m.push(I)}return m}(m,s.delimiter,M,s.locationInfo);if(t.fields&&t.fields.length){const I=new Map;for(const F of t.fields)I.set(F.name.toLowerCase(),F);for(const F of C){const S=I.get(F.name.toLowerCase());if(S){const H=F.name;Object.assign(F,S),F.name=H}}}if(B.fields=C,!B.fields.some(I=>"esriFieldTypeOID"===I.type&&(B.objectIdField=I.name,!0))){const I={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1};B.objectIdField=I.name,B.fields.unshift(I)}if(B.timeInfo){const I=new K.Z(B.fields),F=B.timeInfo;if(F.startTimeField){const S=I.get(F.startTimeField);S?(F.startTimeField=S.name,S.type="esriFieldTypeDate"):F.startTimeField=null}if(F.endTimeField){const S=I.get(F.endTimeField);S?(F.endTimeField=S.name,S.type="esriFieldTypeDate"):F.endTimeField=null}if(F.trackIdField){const S=I.get(F.trackIdField);F.trackIdField=S?S.name:null}F.startTimeField||F.endTimeField||(B.timeInfo=null)}return s}(m,r);s.locationInfo=c.locationInfo,s.delimiter=c.delimiter,s._queryEngine=s._createQueryEngine(c);const M=yield s._createFeatures(m);if(s._queryEngine.featureStore.addMany(M),c.layerDefinition.extent=s._queryEngine.fullExtent,c.layerDefinition.timeInfo){const{start:B,end:C}=s._queryEngine.timeExtent;c.layerDefinition.timeInfo.timeExtent=[B,C]}return c})()}applyEdits(){return(0,O.Z)(function*(){throw new b.Z("csv-layer:editing-not-supported","applyEdits() is not supported on CSVLayer")})()}queryFeatures(r={},t={}){var s=this;return(0,O.Z)(function*(){return yield s._waitSnapshotComplete(),s._queryEngine.executeQuery(r,t.signal)})()}queryFeatureCount(r={},t={}){var s=this;return(0,O.Z)(function*(){return yield s._waitSnapshotComplete(),s._queryEngine.executeQueryForCount(r,t.signal)})()}queryObjectIds(r={},t={}){var s=this;return(0,O.Z)(function*(){return yield s._waitSnapshotComplete(),s._queryEngine.executeQueryForIds(r,t.signal)})()}queryExtent(r={},t={}){var s=this;return(0,O.Z)(function*(){return yield s._waitSnapshotComplete(),s._queryEngine.executeQueryForExtent(r,t.signal)})()}querySnapping(r,t={}){var s=this;return(0,O.Z)(function*(){return yield s._waitSnapshotComplete(),s._queryEngine.executeQueryForSnapping(r,t.signal)})()}refresh(r){var t=this;return(0,O.Z)(function*(){return t.loadOptions.customParameters=r,t._snapshotTask?.abort(),t._snapshotTask=(0,E.vr)(t._snapshotFeatures),t._snapshotTask.promise.then(s=>{t._queryEngine.featureStore.clear(),s&&t._queryEngine.featureStore.addMany(s)},s=>{t._queryEngine.featureStore.clear(),(0,E.D_)(s)||Z.Z.getLogger("esri.layers.CSVLayer").error(new b.Z("csv-layer:refresh","An error occurred during refresh",{error:s}))}),yield t._waitSnapshotComplete(),{extent:t._queryEngine.fullExtent,timeExtent:t._queryEngine.timeExtent}})()}_waitSnapshotComplete(){var r=this;return(0,O.Z)(function*(){if(r._snapshotTask&&!r._snapshotTask.finished){try{yield r._snapshotTask.promise}catch{}return r._waitSnapshotComplete()}})()}_fetch(r){var t=this;return(0,O.Z)(function*(){const{url:s,customParameters:m}=t.loadOptions;if(!s)throw new b.Z("csv-layer:invalid-source","url not defined");const c=(0,D.mN)(s);return(yield(0,U.default)(c.path,{query:{...c.query,...m},responseType:"text",signal:r})).data})()}_createQueryEngine(r){const{objectIdField:t,fields:s,extent:m,timeInfo:c}=r.layerDefinition,M=new j.Z({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1});return new G.q({fields:s,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:c,objectIdField:t,spatialReference:m.spatialReference||{wkid:4326},cacheSpatialQueries:!0,featureStore:M})}_createFeatures(r){var t=this;return(0,O.Z)(function*(){const{latitudeFieldName:s,longitudeFieldName:m}=t.locationInfo,{objectIdField:c,fieldsIndex:M,spatialReference:B}=t._queryEngine;let C=[];const I=[],F=M.fields.filter(x=>x.name!==c).map(x=>x.name);let S=0;const H=ie(r);H.next();const oe={};for(const x of M.fields)if("esriFieldTypeOID"!==x.type&&"esriFieldTypeGlobalID"!==x.type){const $=(0,re.os)(x);void 0!==$&&(oe[x.name]=$)}const _e=k(H,F,t.delimiter,(0,e.Dm)(oe,c));for(const x of _e){const $=t._parseCoordinateValue(x[s]),q=t._parseCoordinateValue(x[m]);if(null!=q&&null!=$&&!isNaN($)&&!isNaN(q)){x[s]=$,x[m]=q;for(const X in x)if(X!==s&&X!==m)if(M.isDateField(X)){const te=new Date(x[X]);x[X]=h(te,x[X])?te.getTime():null}else if(M.isNumericField(X)){const te=_(x[X]);x[X]=isNaN(te)?null:te}x[c]=S,S++,C.push(new ce(q,$)),I.push(x)}}if(!(0,f.fS)({wkid:4326},B))if((0,f.sS)(B))for(const x of C)[x.x,x.y]=(0,y.hG)(x.x,x.y,he);else C=(0,L.oj)(A.N,C,le.Z.WGS84,B,null,null);const ae=[];for(let x=0;x<C.length;x++){const{x:$,y:q}=C[x],X=I[x];X[c]=x+1,ae.push(new o.u_(new g.Z([],[$,q]),X,null,X[c]))}return ae})()}_parseCoordinateValue(r){if(null==r||""===r)return null;let t=_(r);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(r)),t}_checkProjection(r){return(0,O.Z)(function*(){try{yield(0,P._W)(f.Zn,r)}catch{throw new b.Z("csv-layer:projection-not-supported","Projection not supported")}})()}}},56554:(ee,w,u)=>{u.d(w,{Dm:()=>L,Hq:()=>A,MS:()=>f,bU:()=>Z});var O=u(8314),W=u(58817),U=u(87757),b=u(24837);function Z(y){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===y||"esriGeometryMultipoint"===y?b.I4:"esriGeometryPolyline"===y?b.ET:b.lF}}}const E=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let D=1;function L(y,o){if((0,O.Z)("esri-csp-restrictions"))return()=>({[o]:null,...y});try{let g=`this.${o} = null;`;for(const P in y)g+=`this${E.test(P)?`.${P}`:`["${P}"]`} = ${JSON.stringify(y[P])};`;const j=new Function(`\n      return class AttributesClass$${D++} {\n        constructor() {\n          ${g};\n        }\n      }\n    `)();return()=>new j}catch{return()=>({[o]:null,...y})}}function A(y={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,W.d9)(y)}}]}function f(y,o){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:y},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:o,supportsDelete:o,supportsEditing:o,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:o,supportsExceedsLimitStatistics:!0},query:U.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:o,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}}}]);