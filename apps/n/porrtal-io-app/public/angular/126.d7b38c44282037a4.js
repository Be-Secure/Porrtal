"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[126],{50126:(W,V,a)=>{a.d(V,{Z:()=>he});var C=a(15861),o=a(17626),b=a(26584),l=a(62208),p=a(32917),n=a(77712),E=(a(85931),a(8314),a(90912),a(76898)),P=a(84786),x=a(23010),M=a(79216),D=a(19702),B=a(54984),m=a(14517),T=a(10699),I=a(38114),q=a(20477),$=a(88879),z=a(42930),G=a(65234),J=a(36255);class X{constructor(r){this._schedule=r,this._handle=new k(r)}destroy(){this._handle.destroy()}invoke(r,e){return r.buffer&&0!==r.buffer.byteLength?(r.options.sourceSpatialReference&&r.options.sourceSpatialReference instanceof G.Z&&(r.options={...r.options,sourceSpatialReference:r.options.sourceSpatialReference.toJSON()}),this._handle.invoke(r,e).then(i=>this._schedule(()=>{if(i.spatialReference=G.Z.fromJSON(i.spatialReference),i.fields)for(let u=0;u<i.fields.length;u++)i.fields[u]=J.Z.fromJSON(i.fields[u]);const s=i.spatialReference;for(const u of i.features)u.uid=$.Z.generateUID(),(0,l.pC)(u.geometry)&&(u.geometry.spatialReference=s);return i}))):Promise.resolve(null)}}class k extends z.q{constructor(r){super("PBFDecoderWorker","_parseFeatureQuery",{_parseFeatureQuery:e=>[e.buffer]},r)}}let Z=class extends m.Z{constructor(t){super(t)}get queryFeaturesDehydrated(){const t=this.layer.capabilities,r=t&&t.query;if(r&&r.supportsFormatPBF){(0,l.Wi)(this._decoder)&&(this._decoder=new X(this.schedule));const e={sourceSpatialReference:this.layer.spatialReference?.toJSON()??null,applyTransform:!0,maxStringAttributeLength:1024};return(i,s)=>(0,q.runQuery)(this.layer.parsedUrl,i,"pbf",this._createRequestOptions(s)).then(u=>((0,T.k_)(s),(0,l.pC)(this._decoder)?this._decoder.invoke({buffer:u.data,options:e},s.signal):Promise.reject((0,T.zE)())))}return(e,i)=>(0,q.executeQuery)(this.layer.parsedUrl,e,this.layer.spatialReference,this._createRequestOptions(i)).then(s=>(0,I.PA)(s.data))}queryFeatureCount(t,r){return this.layer.queryFeatureCount(t,r)}destroy(){this._decoder=(0,l.SC)(this._decoder)}_createRequestOptions(t){return{...t,query:{...this.layer.customParameters,token:this.layer.apiKey,...t?.query}}}};(0,o._)([(0,n.Cb)({constructOnly:!0})],Z.prototype,"layer",void 0),(0,o._)([(0,n.Cb)({constructOnly:!0})],Z.prototype,"schedule",void 0),(0,o._)([(0,n.Cb)({readOnly:!0})],Z.prototype,"queryFeaturesDehydrated",null),Z=(0,o._)([(0,E.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D")],Z);let S=class extends m.Z{constructor(t){super(t)}queryFeaturesDehydrated(t,r){return this.layer.queryFeatures(t,r)}queryFeatureCount(t,r){return this.layer.queryFeatureCount(t,r)}};(0,o._)([(0,n.Cb)({constructOnly:!0})],S.prototype,"layer",void 0),(0,o._)([(0,n.Cb)({readOnly:!0})],S.prototype,"queryFeaturesDehydrated",null),S=(0,o._)([(0,E.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceMeshQuery3D")],S);let _=class extends m.Z{constructor(t){super(t)}queryFeaturesDehydrated(t,r){return this.layer.queryFeatures(t,r)}};(0,o._)([(0,n.Cb)({constructOnly:!0})],_.prototype,"layer",void 0),_=(0,o._)([(0,E.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D")],_);let j=class extends m.Z{constructor(t){super(t)}queryFeaturesDehydrated(t,r){return this.source.queryFeaturesJSON(t,r).then(I.PA,e=>{if(e&&"query-features-json:unsupported"===e.name)return this.layer.queryFeatures(t,r);throw e})}queryFeatureCount(t,r){return this.layer.queryFeatureCount(t,r)}};(0,o._)([(0,n.Cb)({constructOnly:!0})],j.prototype,"layer",void 0),(0,o._)([(0,n.Cb)({constructOnly:!0})],j.prototype,"source",void 0),j=(0,o._)([(0,E.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileClientQuery3D")],j);class te{constructor(r){this._memoryCache=null,this._capabilities=null;const e=r.layerView.layer;this.layerView=r.layerView,this.objectIdField=e.objectIdField,this.globalIdField="globalIdField"in e?e.globalIdField:null,this.returnZ=r.returnZ,this.returnM=r.returnM;const i=this.layerView.view.resourceController;this.query=function ee(t,r){return"feature"===t.type&&"feature-layer"===t.source.type?(0,l.pC)(t.infoFor3D)?new S({layer:t}):new Z({layer:t,schedule:r}):"feature"===t.type&&"memory"===t.source.type||"csv"===t.type||"geojson"===t.type||"wfs"===t.type?new j({layer:t,source:t.source}):"ogc-feature"===t.type?new _({layer:t}):null}(e,s=>i.schedule(s)),i&&this.memoryCacheEnabled&&(this._memoryCache=i.memoryController.newCache(e.uid))}get memoryCacheEnabled(){switch(this.layerView.layer.source.type){case"feature-layer":case"ogc-feature":return!0;case"csv":case"geojson":case"memory":case"wfs":return!1}}destroy(){this._memoryCache=(0,l.SC)(this._memoryCache),this.query.destroy()}createQuery(){const r=this.layerView.layer.createQuery();return r.outFields=this.layerView.availableFields,r.returnZ=this.returnZ,r.returnM=this.returnM,r.outSpatialReference=this.tilingScheme.spatialReference,r}get memoryCache(){return this._memoryCache}get viewingMode(){return this.layerView.view.state.viewingMode}get tilingScheme(){return this.layerView.view.featureTiles.tilingScheme}get scheduler(){const r=this.layerView.view.resourceController;return r?r.scheduler:null}get geometryType(){return this.layerView.layer.geometryType}get fullExtent(){return this.layerView.layer.fullExtent}get tileMaxRecordCount(){return this.layerView.layer.capabilities.query.tileMaxRecordCount}get maxRecordCount(){return this.layerView.layer.capabilities.query.maxRecordCount}get capabilities(){return(0,l.pC)(this._capabilities)||(this._capabilities=(0,B.A)(this.layerView.layer)),this._capabilities}logFetchError(r,e){r.error("#fetchTile()",this.layerView.layer,e&&e.message?e.message:e)}}var re=a(36967),se=a(41632),N=a(42743),K=a(55538),ie=a(63290),ae=a(13812),oe=a(2319),ne=a(98624),y=a(36630),H=a(59990),le=a(84952),ue=a(46679),U=a(10023);const Q=ie.Z.getLogger("esri.views.layers.FeatureLayerView"),de=t=>{let r=class extends t{constructor(...e){super(...e),this._updatingRequiredFieldsPromise=null,this.filter=null,this.timeExtent=null,this.layer=null,this.requiredFields=[],this.view=null}initialize(){this.handles.add([(0,p.YP)(()=>{const e=this.layer;return[e?.elevationInfo?.featureExpressionInfo,e?.displayField,e?.timeInfo,e&&"renderer"in e&&e.renderer,e&&"labelingInfo"in e&&e.labelingInfo,e&&"floorInfo"in e&&e.floorInfo,this.filter,this.featureEffect,this.timeExtent]},()=>this._handleRequiredFieldsChange(),p.tX),(0,p.on)(()=>this.view?.floors,"change",()=>this._handleRequiredFieldsChange()),(0,p.on)(()=>{const e=this.layer;return e&&"sublayers"in e&&e.sublayers},"change",()=>this._handleRequiredFieldsChange())])}get availableFields(){const{layer:e,layer:{fieldsIndex:i},requiredFields:s}=this;return(0,y.Q0)(i,"outFields"in e&&e.outFields?[...(0,y.Lk)(i,e.outFields),...s]:s)}set effect(e){(0,K.Mr)(Q,"effect",{replacement:"featureEffect",version:"4.22"}),this.featureEffect=e}get effect(){return(0,K.Mr)(Q,"effect",{replacement:"featureEffect",version:"4.22"}),this.featureEffect}get featureEffect(){return this.layer&&"featureEffect"in this.layer?this.layer.featureEffect:null}set featureEffect(e){void 0!==e?this._override("featureEffect",e):this._clearOverride("featureEffect")}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(e){Q.error("#maximumNumberOfFeatures=","Setting maximum number of features is not supported")}get maximumNumberOfFeaturesExceeded(){return!1}highlight(e){throw new Error("missing implementation")}createQuery(){const e={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},i=(0,l.pC)(this.filter)?this.filter.createQuery(e):new le.Z(e);if("feature"===this.layer.type){const s=(0,H.c)(this);(0,l.pC)(s)&&(i.where=i.where?`(${i.where}) AND (${s})`:s)}return(0,l.pC)(this.timeExtent)&&(i.timeExtent=(0,l.pC)(i.timeExtent)?i.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),i}queryFeatures(e,i){throw new Error("missing implementation")}queryObjectIds(e,i){throw new Error("missing implementation")}queryFeatureCount(e,i){throw new Error("missing implementation")}queryExtent(e,i){throw new Error("missing implementation")}fetchPopupFeatures(e,i){var s=this;return(0,C.Z)(function*(){const u=s.validateFetchPopupFeatures(i);if(u)throw u;return s.fetchClientPopupFeatures(i)})()}_loadArcadeModules(e){if(e.get("expressionInfos.length")||Array.isArray(e.content)&&e.content.some(i=>"expression"===i.type))return(0,ue.LC)()}_handleRequiredFieldsChange(){const e=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",e),e.then(()=>{this._updatingRequiredFieldsPromise===e&&this._set("_updatingRequiredFieldsPromise",null)})}_updateRequiredFields(){var e=this;return(0,C.Z)(function*(){if(!e.layer||!e.view)return;const i="3d"===e.view.type,{layer:s,layer:{fieldsIndex:u,objectIdField:F}}=e,v="renderer"in s&&s.renderer,d="orderBy"in s&&s.orderBy,h=s.featureReduction,c=new Set,L=yield(0,T.as)([v?v.collectRequiredFields(c,u):null,(0,y.Mu)(c,s),i?(0,y.vl)(c,s):null,(0,l.pC)(e.filter)?(0,y.Ll)(c,s,e.filter):null,(0,l.pC)(e.featureEffect)?(0,y.Ll)(c,s,e.featureEffect.filter):null,h?(0,y.ZV)(c,s,h):null,d?(0,y.Qj)(c,s,d):null]);if(s.timeInfo&&e.timeExtent&&(0,y.gd)(c,s.fieldsIndex,[s.timeInfo.startField,s.timeInfo.endField]),"feature"===s.type&&s.floorInfo&&(0,y.gd)(c,s.fieldsIndex,[s.floorInfo.floorField]),"subtype-group"===s.type){(0,y.AB)(c,u,s.subtypeField);const O=s.sublayers.map(Y=>Promise.all([Y.renderer?.collectRequiredFields(c,u),(0,y.Mu)(c,Y)]));yield(0,T.as)(O)}for(const O of L)O.error&&Q.error(O.error);(0,y.AB)(c,u,F),i&&"displayField"in s&&s.displayField&&(0,y.AB)(c,u,s.displayField);const w=Array.from(c).sort();e._set("requiredFields",w)})()}validateFetchPopupFeatures(e){if((0,l.Wi)(e))return null;for(const i of e.clientGraphics){const s=i.layer;if("popupEnabled"in s&&!s.popupEnabled)return new b.Z("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:s});if(i.isAggregate){if(!(s.featureReduction&&"popupTemplate"in s.featureReduction&&s.featureReduction.popupEnabled&&s.featureReduction.popupTemplate))return new b.Z("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:s})}else if("popupTemplate"in s&&!(0,U.V)(s,e))return new b.Z("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:s})}}fetchClientPopupFeatures(e){var i=this;return(0,C.Z)(function*(){const s=(0,l.pC)(e)?e.clientGraphics:null;if(!s||0===s.length)return[];const u=new Array(s.length),F=new Map,v=yield i.createPopupQuery(e);for(let d=0;d<s.length;d++){const h=s[d];if(h.isAggregate){u[d]=h;continue}const{layer:c}=h;if(!("popupEnabled"in c))continue;const L=(0,y.Lk)(i.layer.fieldsIndex,v.outFields),w=(0,U.V)(c,e);if((0,l.Wi)(w))continue;const O=yield i._loadArcadeModules(w);O&&O.arcadeUtils.hasGeometryOperations(w)||!(0,y.R9)(L,h)?F.set(h.getObjectId(),d):u[d]=h}if("stream"===i.layer.type||0===F.size)return u.filter(Boolean);v.objectIds=Array.from(F.keys());try{const d=yield i.layer.queryFeatures(v);for(const h of d.features)u[F.get(h.getObjectId())]=h}catch{}return u.filter(Boolean)})()}createPopupQuery(e){var i=this;return(0,C.Z)(function*(){const s=i.layer.createQuery(),u=new Set;let F=!1;const v=(0,l.pC)(e)&&e.clientGraphics?e.clientGraphics.map(d=>d.layer):[i.layer];for(const d of v){if(!("popupEnabled"in d))continue;const h=(0,U.V)(d,e);if((0,l.Wi)(h))continue;const c=yield i._loadArcadeModules(h),L=c&&c.arcadeUtils.hasGeometryOperations(h);F=!("point"!==i.layer.geometryType&&!L);const w=yield(0,U.e)(i.layer,h);for(const O of w)u.add(O)}if(s.returnGeometry=F,s.returnZ=F,s.returnM=F,s.outFields=Array.from(u),s.outSpatialReference=i.view.spatialReference,"feature"===i.layer.type){const d=(0,H.c)(i);(0,l.pC)(d)&&(s.where=s.where?`(${s.where}) AND (${d})`:d)}return s})()}canResume(){return!(!super.canResume()||(0,l.pC)(this.timeExtent)&&this.timeExtent.isEmpty)}};return(0,o._)([(0,n.Cb)()],r.prototype,"_updatingRequiredFieldsPromise",void 0),(0,o._)([(0,n.Cb)({readOnly:!0})],r.prototype,"availableFields",null),(0,o._)([(0,n.Cb)()],r.prototype,"effect",null),(0,o._)([(0,n.Cb)({type:oe.Z})],r.prototype,"featureEffect",null),(0,o._)([(0,n.Cb)({type:ne.Z})],r.prototype,"filter",void 0),(0,o._)([(0,n.Cb)(ae.qG)],r.prototype,"timeExtent",void 0),(0,o._)([(0,n.Cb)()],r.prototype,"layer",void 0),(0,o._)([(0,n.Cb)({type:Number})],r.prototype,"maximumNumberOfFeatures",null),(0,o._)([(0,n.Cb)({readOnly:!0,type:Boolean})],r.prototype,"maximumNumberOfFeaturesExceeded",null),(0,o._)([(0,n.Cb)({readOnly:!0})],r.prototype,"requiredFields",void 0),(0,o._)([(0,n.Cb)()],r.prototype,"suspended",void 0),(0,o._)([(0,n.Cb)()],r.prototype,"view",void 0),r=(0,o._)([(0,E.j)("esri.views.layers.FeatureLayerView")],r),r};var ce=a(45611),pe=a(94421);let g=class extends((0,pe.Z)((0,M.R)(de((0,D.A)(ce.Z))))){constructor(t){super(t),this._controllerTotal=0,this._processorTotal=0,this.suspendResumeExtentMode="data"}initialize(){this.updatingHandles.add(()=>this.view.floors,()=>(0,l.pC)(this.processor.filterVisibility)&&this.processor.filterVisibility.filterChanged()),this.handles.add((0,p.YP)(()=>this._updatingRequiredFieldsPromise,t=>this.updatingHandles.addPromise(t),p.tX))}destroy(){this.updatingHandles.removeAll(),this.handles.removeAll(),this.fetcherContext=(0,l.SC)(this.fetcherContext)}get maximumNumberOfFeatures(){return this.controller?.maximumNumberOfFeatures??this._get("maximumNumberOfFeatures")}set maximumNumberOfFeatures(t){this._set("maximumNumberOfFeatures",t),this.controller&&(this.controller.maximumNumberOfFeatures=t)}get maximumNumberOfFeaturesExceeded(){return!!this.controller&&!(this.suspended||!this.controller.maximumNumberOfFeaturesExceeded)}get updatingProgressValue(){let t=0;if(this.controller?.updating){const e=this.controller.updatingRemaining,i=Math.max(this.controller.updatingTotal,this._controllerTotal);i>0&&(t=(i-e)/i,this._controllerTotal=i)}let r=0;if(this.processor?.updating){const e=this.processor.updatingRemaining,i=Math.max(e,this._processorTotal);i>0&&(r=(i-e)/i,this._processorTotal=i)}return.5*(t+r)}get updatePolicy(){if(!this.controller)return N.jq.ASYNC;switch(this.controller.mode){case"snapshot":{const t=ye[this.layer.geometryType];return null==t||this.controller.serviceDataCount>t?N.jq.ASYNC:N.jq.SYNC}case"tiles":return N.jq.ASYNC}}get hasZ(){const t=this.layer,r=t.capabilities&&t.capabilities.data;return!(!r||!r.supportsZ)&&("returnZ"in t&&null!=t.returnZ?t.returnZ:r.supportsZ)}get hasM(){const t=this.layer,r=t.capabilities&&t.capabilities.data;return!(!r||!r.supportsM)&&"returnM"in t&&null!=t.returnM&&t.returnM}setVisibility(t,r){this.processor?.setObjectIdVisibility(t,r)}createQuery(){return super.createQuery()}queryFeatures(t,r){const e=()=>super.queryFeatures(t,r);return"mesh"===this.layer.geometryType?this._queryFeaturesMesh(this._ensureQuery(t),e):e()}beforeSetController(t){t.maximumNumberOfFeatures=this.maximumNumberOfFeatures}createController(){this.fetcherContext=new te({layerView:this,returnZ:this.hasZ,returnM:this.hasM});const t=new x.g({layerView:this,context:this.fetcherContext,graphics:new re.g,extent:this.clippingExtent});return this.updatingHandles.add(()=>t.serviceDataExtent,r=>{this.processor&&(this.processor.dataExtent=r)},p.nn),this.handles.add((0,p.YP)(()=>this.suspended,r=>{r?t.suspend():t.resume()},p.tX)),this.updatingHandles.add(()=>this.processor?.displayFeatureLimit,r=>t.displayFeatureLimit=r,p.nn),this.handles.add((0,p.gx)(()=>!this.updating,()=>{this._controllerTotal=0,this._processorTotal=0})),t}doRefresh(t){var r=this;return(0,C.Z)(function*(){t&&!r.suspended&&r.controller&&r.controller.refetch(),(0,l.pC)(r.processor.filterVisibility)&&(r.processor.filterVisibility.dirty=!0)})()}getUsedMemory(){return(this.processor?.usedMemory??0)+(this.controller?.memoryForUnusedFeatures??0)}getUnloadedMemory(){return(this.processor?.unprocessedMemoryEstimate??0)+this.controller?.expectedFeatureDiff*this.processor?.usedMemoryPerFeature}ignoresMemoryFactor(){return this.controller?.hasMaximumNumberOfFeaturesOverride}_queryFeaturesMesh(t,r){var e=this;return(0,C.Z)(function*(){yield e._validateQueryFeaturesMesh(t);const i=yield r();if(t&&t.outStatistics||(0,l.Wi)(e.graphics3DProcessor))return i;const s=e.layer.objectIdField,u=e.graphics3DProcessor.graphics3DGraphicsByObjectID,F=[];for(const v of i.features)if(v.geometry){const d=u.get(v.attributes[s]);d&&(v.geometry=(0,P.kB)(d.graphic.geometry),F.push(v))}else F.push(v);return i.features=F,i})()}_validateQueryFeaturesMesh(t){var r=this;return(0,C.Z)(function*(){if(!t)return;const e=s=>{throw new b.Z("feature-layer-view:unsupported-query",`Queries on Mesh feature collection layers do not support '${s}'`)},i=["quantizationParameters","geometryPrecision","maxAllowableOffset"];for(const s of i)null!=t[s]&&e(s);"returnM"in t&&t.returnM&&e("returnM"),"returnCentroid"in t&&t.returnCentroid&&e("returnCentroid"),(0,l.pC)(t.outSpatialReference)&&!t.outSpatialReference.equals(r.view.spatialReference)&&e("outSpatialReference")})()}get performanceInfo(){const t=this.controller?.displayFeatureLimit,r=(0,l.pC)(t)&&t.averageSymbolComplexity,e=(0,l.pC)(r)?`f:${r.primitivesPerFeature},v:${r.primitivesPerCoordinate}`:"n/a",i={...this._getResourceInfo(),storedFeatures:0,totalVertices:0,partial:this.maximumNumberOfFeaturesExceeded,mode:this.controller?.mode??"n/a",symbolComplexity:e,nodes:this.controller?.tileDescriptors.length??0};if(this.controller&&i.displayedNumberOfFeatures){const s=this.controller.debug;i.storedFeatures=s.storedFeatures,i.totalVertices=s.totalVertices}return i}get test(){return{updatePolicy:this.updatePolicy,controller:this.controller,loadedGraphics:this.controller?.graphics}}};(0,o._)([(0,n.Cb)()],g.prototype,"layer",void 0),(0,o._)([(0,n.Cb)()],g.prototype,"controller",void 0),(0,o._)([(0,n.Cb)()],g.prototype,"_controllerTotal",void 0),(0,o._)([(0,n.Cb)()],g.prototype,"_processorTotal",void 0),(0,o._)([(0,n.Cb)()],g.prototype,"maximumNumberOfFeatures",null),(0,o._)([(0,n.Cb)()],g.prototype,"maximumNumberOfFeaturesExceeded",null),(0,o._)([(0,n.Cb)(se.q)],g.prototype,"updatingProgress",void 0),(0,o._)([(0,n.Cb)({readOnly:!0})],g.prototype,"updatingProgressValue",null),(0,o._)([(0,n.Cb)({readOnly:!0})],g.prototype,"updatePolicy",null),(0,o._)([(0,n.Cb)({readOnly:!0})],g.prototype,"hasZ",null),(0,o._)([(0,n.Cb)({readOnly:!0})],g.prototype,"hasM",null),(0,o._)([(0,n.Cb)()],g.prototype,"suspendResumeExtentMode",void 0),g=(0,o._)([(0,E.j)("esri.views.3d.layers.FeatureLayerViewBase3D")],g);const ye={point:5e3,polygon:500,polyline:1e3},he=g},94421:(W,V,a)=>{a.d(V,{Z:()=>E});var C=a(17626),o=a(63290),b=a(10699),l=a(32917),p=a(77712),A=(a(85931),a(8314),a(90912),a(76898));const E=P=>{let x=class extends P{initialize(){this.handles.add((0,l.on)(()=>this.layer,"refresh",M=>{this.doRefresh(M.dataChanged).catch(D=>{(0,b.D_)(D)||o.Z.getLogger(this.declaredClass).error(D)})}),"RefreshableLayerView")}};return(0,C._)([(0,p.Cb)()],x.prototype,"layer",void 0),x=(0,C._)([(0,A.j)("esri.layers.mixins.RefreshableLayerView")],x),x}},10023:(W,V,a)=>{a.d(V,{V:()=>n,e:()=>l});var C=a(15861),o=a(62208),b=a(36630);function l(f){return p.apply(this,arguments)}function p(){return(p=(0,C.Z)(function*(f,R=f.popupTemplate){if((0,o.Wi)(R))return[];const A=yield R.getRequiredFields(f.fieldsIndex),{lastEditInfoEnabled:E}=R,{objectIdField:P,typeIdField:x,globalIdField:M,relationships:D}=f;if(A.includes("*"))return["*"];const B=E?yield(0,b.CH)(f):[],m=(0,b.Q0)(f.fieldsIndex,[...A,...B]);return x&&m.push(x),m&&P&&f.fieldsIndex.has(P)&&!m.includes(P)&&m.push(P),m&&M&&f.fieldsIndex.has(M)&&!m.includes(M)&&m.push(M),D&&D.forEach(T=>{const{keyField:I}=T;m&&I&&f.fieldsIndex.has(I)&&!m.includes(I)&&m.push(I)}),m})).apply(this,arguments)}function n(f,R){return f.popupTemplate?f.popupTemplate:(0,o.pC)(R)&&R.defaultPopupTemplateEnabled&&(0,o.pC)(f.defaultPopupTemplate)?f.defaultPopupTemplate:null}}}]);