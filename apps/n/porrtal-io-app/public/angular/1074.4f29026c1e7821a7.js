"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[1074],{71074:($,G,l)=>{l.r(G),l.d(G,{populateOperationalLayers:()=>M});var o=l(15861),C=l(46160),x=(l(8314),l(10699)),L=l(30164),W=l(55463);function F(e){return p(e,"notes")}function b(e){return p(e,"markup")}function O(e){return p(e,"route")}function p(e,r){return!(!e.layerType||"ArcGISFeatureLayer"!==e.layerType)&&e.featureCollectionType===r}var V=l(7534),B=l(39683);function M(e,r,a){return S.apply(this,arguments)}function S(){return(S=(0,o.Z)(function*(e,r,a){if(!r)return;const y=[];for(const t of r){const n=N(t,a);y.push("GroupLayer"===t.layerType?k(n,t,a):n)}const i=yield(0,x.as)(y);for(const t of i)!t.value||a.filter&&!a.filter(t.value)||e.add(t.value)})).apply(this,arguments)}const U={ArcGISDimensionLayer:"DimensionLayer",ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",PointCloudLayer:"PointCloudLayer",ArcGISSceneServiceLayer:"SceneLayer",IntegratedMeshLayer:"IntegratedMeshLayer",OGCFeatureLayer:"OGCFeatureLayer",BuildingSceneLayer:"BuildingSceneLayer",ArcGISTiledElevationServiceLayer:"ElevationLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",GroupLayer:"GroupLayer",GeoJSON:"GeoJSONLayer",WebTiledLayer:"WebTileLayer",CSV:"CSVLayer",VectorTileLayer:"VectorTileLayer",WFS:"WFSLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer",KML:"KMLLayer",RasterDataLayer:"UnsupportedLayer",Voxel:"VoxelLayer",LineOfSightLayer:"LineOfSightLayer"},D={ArcGISTiledElevationServiceLayer:"ElevationLayer",DefaultTileLayer:"ElevationLayer",RasterDataElevationLayer:"UnsupportedLayer"},w={ArcGISTiledMapServiceLayer:"TileLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",OpenStreetMap:"OpenStreetMapLayer",WebTiledLayer:"WebTileLayer",VectorTileLayer:"VectorTileLayer",ArcGISImageServiceLayer:"UnsupportedLayer",WMS:"UnsupportedLayer",ArcGISMapServiceLayer:"UnsupportedLayer",DefaultTileLayer:"TileLayer"},R={ArcGISAnnotationLayer:"UnsupportedLayer",ArcGISDimensionLayer:"UnsupportedLayer",ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISStreamLayer:"StreamLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",BingMapsAerial:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",CSV:"CSVLayer",DefaultTileLayer:"TileLayer",GeoRSS:"GeoRSSLayer",GeoJSON:"GeoJSONLayer",GroupLayer:"GroupLayer",KML:"KMLLayer",OGCFeatureLayer:"OGCFeatureLayer",OrientedImageryLayer:"OrientedImageryLayer",SubtypeGroupLayer:"SubtypeGroupLayer",VectorTileLayer:"VectorTileLayer",WFS:"WFSLayer",WMS:"WMSLayer",WebTiledLayer:"WebTileLayer"},Z={ArcGISFeatureLayer:"FeatureLayer"},E={ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",WebTiledLayer:"WebTileLayer",BingMapsAerial:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer"};function N(e,r){return d.apply(this,arguments)}function d(){return(d=(0,o.Z)(function*(e,r){return J(yield K(e,r),e,r)})).apply(this,arguments)}function J(e,r,a){return I.apply(this,arguments)}function I(){return(I=(0,o.Z)(function*(e,r,a){const y=new e;return y.read(r,a.context),"group"===y.type&&v(r)&&(yield H(y,r,a.context)),yield(0,B.y)(y,a.context),y})).apply(this,arguments)}function K(e,r){return T.apply(this,arguments)}function T(){return(T=(0,o.Z)(function*(e,r){const a=r.context,y=P(a);let i=e.layerType||e.type;!i&&r&&r.defaultLayerType&&(i=r.defaultLayerType);const t=y[i];let n=t?L.T[t]:L.T.UnknownLayer;if(A(e)){const m=a?.portal;if(e.itemId){const u=new W.default({id:e.itemId,portal:m});yield u.load();const c=(yield(0,V.selectLayerClassPath)(u)).className||"UnknownLayer";n=L.T[c]}}else"ArcGISFeatureLayer"===i?F(e)||b(e)?n=L.T.MapNotesLayer:O(e)?n=L.T.RouteLayer:v(e)&&(n=L.T.GroupLayer):e.wmtsInfo&&e.wmtsInfo.url&&e.wmtsInfo.layerIdentifier?n=L.T.WMTSLayer:"WFS"===i&&"2.0.0"!==e.wfsInfo.version&&(n=L.T.UnsupportedLayer);return n()})).apply(this,arguments)}function v(e){return"ArcGISFeatureLayer"===e.layerType&&!A(e)&&(e.featureCollection?.layers?.length??0)>1}function A(e){return"Feature Collection"===e.type}function P(e){let r;if("web-scene"===e.origin)switch(e.layerContainerType){case"basemap":r=w;break;case"ground":r=D;break;default:r=U}else switch(e.layerContainerType){case"basemap":r=E;break;case"tables":r=Z;break;default:r=R}return r}function k(e,r,a){return f.apply(this,arguments)}function f(){return(f=(0,o.Z)(function*(e,r,a){const y=new C.Z,i=M(y,Array.isArray(r.layers)?r.layers:[],a),t=yield e;if(yield i,"group"===t.type)return t.layers.addMany(y),t})).apply(this,arguments)}function H(e,r,a){return g.apply(this,arguments)}function g(){return(g=(0,o.Z)(function*(e,r,a){const y=L.T.FeatureLayer,i=yield y(),t=r.featureCollection,n=t.showLegend,m=t.layers.map((u,c)=>{const s=new i;s.read(u,a);const h={...a,ignoreDefaults:!0};return s.read({id:`${e.id}-sublayer-${c}`,visibility:r.visibleLayers?.includes(c)??!0},h),null!=n&&s.read({showLegend:n},h),s});e.layers.addMany(m)})).apply(this,arguments)}}}]);