<ng-container [ngSwitch]="pane?.arrange ?? 'tabs-top'">
  <!-- tabs-top -->
  <mat-tab-group
    preserveContent
    *ngSwitchCase="'tabs-top'"
    (selectedIndexChange)="doChangeTabIndex($event)"
  >
    <mat-tab *ngFor="let viewState of pane?.viewStates">
      <ng-template mat-tab-label>
        <mat-icon
          (contextmenu)="doContextMenu($event, viewState)"
          class="tab-icon"
          >{{ viewState.displayIcon }}</mat-icon
        >
        <span (contextmenu)="doContextMenu($event, viewState)">{{
          viewState.displayText
        }}</span>
        <mat-icon
          (click)="doCloseTab($event, viewState)"
          inline="true"
          class="close-icon"
          >close</mat-icon
        >
      </ng-template>
      <porrtal-workspace-view-host
        [viewState]="viewState"
      ></porrtal-workspace-view-host>
    </mat-tab>
  </mat-tab-group>

  <!-- tabs-left -->
  <div
    class="vertical-tabs-container"
    fxFlex
    fxLayout="row"
    fxLayoutAlign="start stretch"
  >
    <div
      class="vertical-tabs-tabs-container"
      fxLayout="row"
      fxLayoutAlign="start stretch"
      fxLayoutGap="1em"
      *ngSwitchCase="'tabs-left'"
    >
      <div fxFlex class="vertical-tabs-nav-list">
        <mat-nav-list>
          <mat-list-item
            *ngFor="let viewState of pane?.viewStates; let ii = index"
            [ngClass]="{ selected: viewState.key === pane?.currentKey }"
            (click)="doChangeTabIndex(ii)"
          >
            <a tabindex="0" class="vertical-tabs-anchor">
              <div
                fxLayout="row"
                fxLayoutAlign="start center"
                fxLayoutGap="0.5em"
              >
                <mat-icon fxFlex="none">{{ viewState.displayIcon }}</mat-icon>
              </div>
            </a>
          </mat-list-item>
        </mat-nav-list>
      </div>
    </div>
    <div class="vertical-tabs-content">
      <div fxFlex style="background-color: yellow; width: 100%; height: 100%">
        {{ pane?.currentKey }}
      </div>
    </div>
  </div>

  <!-- cards -->
  <div *ngSwitchCase="'cards'">cards</div>
</ng-container>

<!-- an hidden div is created to set the position of appearance of the menu-->
<div
  style="visibility: hidden; position: fixed"
  [style.left]="menuTopLeftPosition.x"
  [style.top]="menuTopLeftPosition.y"
  [matMenuTriggerFor]="rightMenu"
></div>

<!-- standard material menu -->
<mat-menu #rightMenu="matMenu">
  <ng-template matMenuContent let-viewState="viewState">
    <button mat-menu-item (click)="doCloseTab($event, viewState)">
      <span>
        <mat-icon inline="true" class="menu-close-icon">close</mat-icon>
        <span>Close Tab</span>
      </span>
    </button>
    <mat-divider></mat-divider>
    <button
      mat-menu-item
      [matMenuTriggerFor]="arrangeOptions"
      [matMenuTriggerData]="{viewState}"
    >
      <span>
        <mat-icon inline="true" class="menu-close-icon"
          >pivot_table_chart</mat-icon
        >
        <span>Arrange...</span>
      </span>
    </button>
    <button
      mat-menu-item
      [matMenuTriggerFor]="moveOptions"
      [matMenuTriggerData]="{viewState}"
    >
      <span>
        <mat-icon inline="true" class="menu-close-icon">open_with</mat-icon>
        <span>Move To...</span>
      </span>
    </button>
  </ng-template>
</mat-menu>

<mat-menu #arrangeOptions="matMenu">
  <ng-template matMenuContent let-viewState="viewState">
    <button
      mat-menu-item
      (click)="doSetArrangementType($event, viewState, paneArrangement)"
      *ngFor="let paneArrangement of paneArrangements"
    >
      <span>
        <mat-icon inline="true" class="menu-close-icon">{{
          pane?.arrange === paneArrangement ? 'done' : ''
        }}</mat-icon>
        <span>{{ paneArrangement }}</span>
      </span>
    </button>
  </ng-template>
</mat-menu>

<mat-menu #moveOptions="matMenu">
  <ng-template matMenuContent let-viewState="viewState">
    <button
      (click)="doMoveTab($event, viewState, paneType)"
      mat-menu-item
      *ngFor="let paneType of paneTypes"
    >
      <span>
        <mat-icon
          inline="true"
          class="menu-move-to-icon material-icons-outlined"
          >{{ moveIcons[paneType] }}</mat-icon
        >
        <span>{{ paneType }}</span>
      </span>
    </button>
  </ng-template>
</mat-menu>
